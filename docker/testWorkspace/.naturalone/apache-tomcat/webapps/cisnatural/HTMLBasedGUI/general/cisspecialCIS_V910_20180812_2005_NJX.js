function addVersionInfoDATEINPUT2CONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("DATEINPUT2CONTROLS")}var lang_map=new Object();lang_map.en="en";lang_map.de="de";lang_map.ja="ja";lang_map.he="he";lang_map.da="da";lang_map["3"]="fr";lang_map["4"]="es";lang_map["5"]="it";lang_map["8"]="da";lang_map["11"]="pt";lang_map["33"]="he";lang_map["28"]="ja";function iccDI2(q,n,A,o,s,k,l,p,e,w,t,a,z,m,r,v,x,d,g,y,h,u,f,c,b){q.onblur=A;q.onfocus=A;q.onchange=A;q.onkeydown=A;addFocusable(q,true);startFocusCell(q);registerPropertyListener(n,o,q.id);registerStatusPropertyListener(n,e,q.id,q);registerPropertyListener(n,r,q.id);registerPropertyListener(n,v,q.id);registerPropertyListener(n,w,q.id);registerPropertyListener(n,"dateDisplay",q.id);q.CASA_valueprop=o;if(e!=null){q.CASA_statusprop=e}if(r!=null){q.CASA_fromprop=r}if(v!=null){q.CASA_toprop=v}if(s!=null){q.CASA_flush=s}if(k!=null){q.CASA_flushmethod=k}if(l!=null){q.CASA_datatype=l}else{q.CASA_datatype="date"}if(p!=null){q.CASA_displayonly=p}if(d!=null){q.CASA_popuponalt40=d}if(g!=null){q.CASA_popuponF4F7=g}if(y==null){q.CASA_numberofmonths=1}else{q.CASA_numberofmonths=parseInt(y)}if(w!=null){q.CASA_titleprop=w}if(t!=null){q.CASA_helpid=t}if(a!=null){q.CASA_cti=a}if(z!=null){q.CASA_tabindex=z}if(x!=null){q.CASA_popupicon=x}else{q.CASA_popupicon="../HTMLBasedGUI/images/fieldcombo.gif"}if(m!=null){q.CASA_invisiblemode=m}if(h!=null){q.CASA_holidaysstyleclass=h}else{q.CASA_holidaysstyleclass=""}if(u!=null){q.CASA_holidaysurl=u}else{q.CASA_holidaysurl=""}if(f!=null){q.CASA_holidaysurlprop=f}else{q.CASA_holidaysurlprop=""}if(c!=null){q.CASA_holidaysdescriptionastooltip=c}else{q.CASA_holidaysdescriptionastooltip=false}q.CASA_lastValue=undefined;q.CASA_lastStatus=undefined;q.CASA_lastControlValue=undefined;q.CASA_lastDir=null;q.CASA_td=q.parentNode;q.CASA_lastTitle=undefined;q.CASA_bm=b;q.CASA_bmskip=false;q.CASA_holidaysdata="";q.CASA_first=true}function getPickerDate(a){var b=(a.getMonth()+1);if(a.getMonth()<9){b="0"+b}if(a.getDate()<10){b+="0"}b+=""+a.getDate();b=""+(a.getFullYear())+b;return(b)}function getHoliDate(b,a){if(a=="yymmdd"){return(b)}}function setDateFormatDI2(b){var a="yy-mm-dd";if(m_dateDisplay=="DD/MM/YYYY"){a="dd/mm/yy"}else{if(m_dateDisplay=="MM/DD/YYYY"){a="mm/dd/yy"}else{if(m_dateDisplay=="DD.MM.YYYY"){a="dd.mm.yy"}else{if(m_dateDisplay=="YYYY/MM/DD"){a="yy/mm/dd"}}}}parent.$("#"+b.id).datepicker("option","dateFormat",a)}function romuDI2(g,m){if(g.CASA_first==true){parent.$("#"+g.id).datepicker({dateFormat:"yy-mm-dd",showButtonPanel:false,changeMonth:true,changeYear:true,yearRange:"1582:2699",numberOfMonths:g.CASA_numberofmonths,onClose:function(){if(g.CASA_bm=="true"){g.CASA_bmskip=true}this.focus()},beforeShow:function(o){if(g.CASA_bmskip){g.CASA_bmskip=false;return false}if(parent.$(o).attr("readonly")){return false}var n=getPropertyValue("fdiw");if(n!=null&&n=="SU"){parent.$("#"+g.id).datepicker("option","firstDay",0)}else{parent.$("#"+g.id).datepicker("option","firstDay",1)}},beforeShowDay:function(o){if(g.CASA_holidaysurlprop!=""){var r=getPropertyValue(g.CASA_holidaysurlprop);if(r!=null&&r!=""){if(g.CASA_holidaysurl!=r&&r!=""){g.CASA_holidaysurl=r;g.CASA_holidaysdata="";parent.$.getJSON(g.CASA_holidaysurl,function(u,t,v){if(u!=null&&u!=""){g.CASA_holidaysdata=u}})}}}else{if(g.CASA_holidaysurl!=""){g.CASA_holidaysdata="";parent.$.getJSON(g.CASA_holidaysurl,function(u,t,v){if(u!=null&&u!=""){g.CASA_holidaysdata=u}});g.CASA_holidaysurl=""}}if(g.CASA_holidaysdata.length>0){var n=getPickerDate(o);var s="yymmdd";var q="";for(var p=0;p<g.CASA_holidaysdata.length;p++){q=getHoliDate(g.CASA_holidaysdata[p].date,s);if(q.substring(0,4)=="9999"){q=o.getFullYear()+q.substring(4,8)}if(q==n){if(g.CASA_holidaysdescriptionastooltip=="true"){return[true,g.CASA_holidaysstyleclass,g.CASA_holidaysdata[p].description]}else{return[true,g.CASA_holidaysstyleclass,""]}}}}return[true,"",""]}});if(g.CASA_displayonly!="true"&&g.CASA_bm!="true"){parent.$("#"+g.id).datepicker("option","buttonImage",g.CASA_popupicon);parent.$("#"+g.id).datepicker("option","buttonImageOnly",true);parent.$("#"+g.id).datepicker("option","showOn","button")}parent.$("#"+g.id).datepicker().unbind("focus").dblclick(function(){parent.$("#"+g.id).datepicker("show")});g.CASA_first=false}if(m_language!="en"){var a="../HTMLBasedGUI/jquery/jquery-ui-i18n.min.js";parent.$.getScript(a,function(){setDI2Language(g);contromuDI2(g,m)})}if(g.CASA_fromprop!=null){var h=getPropertyValue(g.CASA_fromprop);if(h!=g.CASA_fromval_old&&h.length==8){var b=parseInt(h.substring(0,4));var k=parseInt(h.substring(4,6))-1;var c=parseInt(h.substring(6,8));parent.$("#"+g.id).datepicker("option","minDate",new Date(b,k,c));g.CASA_fromval_old=h}}if(g.CASA_toprop!=null){var f=getPropertyValue(g.CASA_toprop);if(f!=g.CASA_toval_old){var e=parseInt(f.substring(0,4));var l=parseInt(f.substring(4,6))-1;var d=parseInt(f.substring(6,8));parent.$("#"+g.id).datepicker("option","maxDate",new Date(e,l,d));g.CASA_toval_old=f}}contromuDI2(g,m)}function setDI2Language(a){parent.$("#"+a.id).datepicker("option",parent.$.datepicker.regional[lang_map[m_language]])}function setClassDI2(c,a){var b=parent.$("#"+c.id).hasClass("hasDatepicker");if(c.CASA_bm=="true"){return}if(c.className!=a){c.className=a;if(b){parent.$("#"+c.id).addClass("hasDatepicker")}}}function contromuDI2(e,d){setDateFormatDI2(e);var a=getValueDI(e);e.CASA_lastValue=a;var b=null;if(e.CASA_statusprop!=null){b=getPropertyValue(e.CASA_statusprop)}if(a==null){b=null}e.CASA_lastStatus=b;if(b=="ERROR"||b=="FOCUS"||b=="FOCUS_NO_SELECT"){addFocusRequestor(e)}if(e.CASA_titleprop!=null){var c=getPropertyValue(e.CASA_titleprop);if(c!=e.CASA_lastTitle){e.title=c;e.CASA_lastTitle=c}}if(e.CASA_lastDir!=m_direction){if(m_direction=="rtl"){e.style.backgroundPosition="left"}else{e.style.backgroundPositionX="right"}e.CASA_lastDir=m_direction}a=convertValueIntoDisplayStringDI(e,a);if(a==null&&b==null){e.value="";e.tabIndex=-1;e.readOnly=true;setClassDI2(e,"FIELDInputNull");return}else{e.value=a;e.readOnly=false;if(e.CASA_bm!="true"){applyCasaTabIndex(e,"DATEINPUT2")}}e.CASA_lastControlValue=e.value;if(e.CASA_displayonly=="true"&&(b==null||b=="")){e.tabIndex=-1;e.readOnly=true;b="DISPLAY";setClassDI2(e,"FIELDInputDisplay")}else{if(b==null){setClassDI2(e,"FIELDInputEdit")}else{if(b=="EDIT"||b=="FOCUS"||b=="FOCUS_NO_SELECT"){setClassDI2(e,"FIELDInputEdit")}else{if(b=="DISPLAY"){e.tabIndex=-1;e.readOnly=true;setClassDI2(e,"FIELDInputDisplay")}else{if(b=="ERROR_DISPLAY"){e.tabIndex=-1;e.readOnly=true;setClassDI2(e,"FIELDInputError")}else{if(b=="ERROR"||b=="ERROR_NO_FOCUS"){setClassDI2(e,"FIELDInputError")}else{if(b=="INVISIBLE"){if(e.CASA_td!=null){if(e.CASA_invisiblemode==undefined||e.CASA_invisiblemode=="invisible"){e.CASA_td.style.display="none"}if(e.CASA_invisiblemode=="cleared"){e.CASA_td.style.visibility="collapse"}}else{setClassDI2(e,"FIELDInputInvisible")}}else{setClassDI2(e,"FIELDInputEdit")}}}}}if((e.CASA_td!=null)&&(b!="INVISIBLE")){e.CASA_td.style.display="";e.CASA_td.style.visibility=""}}}}function reactDI2(a){return reactDI2Internal(a)}function reactDI2Internal(a){if(CL()==null){return}if(a.type=="keydown"){return reactOnKeyDownDI2(a)}else{if(a.type=="change"){return transferChangeDI2(a.target,"change")}else{if(a.type=="blur"){return transferChangeDI2(a.target,"blur")}else{if(a.type=="focus"){return reactOnFocusDI2(a.target)}}}}}function reactOnKeyDownDI2(a){var e=a.target;if(e.CASA_bm=="true"){if((a.keyCode!=9)&&(a.keyCode!=13)&&(a.keyCode!=27)){a.preventDefault();a.stopPropagation();e.CASA_bmskip=false;parent.$("#"+e.id).datepicker("show")}return}if(checkIOForNoSubmits()==false){return false}try{e.focus()}catch(c){}var b=a.keyCode;if(a.CASA_keyCode!=undefined){b=a.CASA_keyCode}if(b==112){if(e.CASA_helpid!=undefined){var d=e.CASA_helpid;if(e.CASA_helpid=="$valueprop$"){d=e.CASA_valueprop}setPropertyValue("param2",d);invokeMethodInModel("reactOnHelpRequestForHelpId")}return false}if(a.ctrlKey==true){return true}if(e.tabIndex==-1&&e.CASA_popupinputonly=="false"){return false}if(b==115||b==118){if(e.CASA_popuponF4F7==undefined||e.CASA_popuponF4F7=="true"){CL().cancelEvent(a);parent.$("#"+e.id).datepicker("show");return}}if(b==40){if(e.CASA_popuponalt40=="true"){if(a.altKey==true){CL().cancelEvent(a);parent.$("#"+e.id).datepicker("show");return}}else{CL().cancelEvent(a);parent.$("#"+e.id).datepicker("show")}}return true}function reactOnFocusDI2(a){CL().C_regFocusInfo(a);return true}function transferChangeDI2(b,a){if(a=="blur"){CL().C_unregFocusInfo(b)}b.CASA_bmskip=false;if(checkIOForNoSubmits()==false){return false}if(b.tabIndex==-1){return false}transferPropertyValueDI2(b,a);return true}function transferPropertyValueDI2(e,b){if(e.value==null||e.value==e.CASA_lastControlValue){if(e.CASA_hasValidationError==true&&e.CASA_skipNextOnBlurValidation!=true){var d=buildValidationErrorMessageDI(e);if(getPropertyValue("cISAddons.cisA1")!="false"){CL().romuSB(this,d,"E",e);e.CASA_supresserror=false;avoidClickAway()}else{if(displayNotificationDI(d)){unregisterValidationError(e);resetValidationErrorDI2(e)}}try{e.focus()}catch(c){}}e.CASA_skipNextOnBlurValidation=false;return true}e.CASA_valErrors=null;e.style.color="";e.style.borderColor="";e.style.borderWidth="";var a=transferAndConvertPropertyValueDI(e);if(e.CASA_hasValidationError==true){e.CASA_hasValidationError=false;unregisterValidationError(e)}if(a.hasValidationErrors==true){e.style.color="#FF0000";e.style.borderColor="#FF0000";e.style.borderWidth="2px";e.CASA_hasValidationError=true;registerValidationErrorForDateInput(e);if(e.CASA_skipNextOnBlurValidation!=true){var d=a.errorMessage;if(d==null||d==""){d=buildValidationErrorMessageDI(e)}if(getPropertyValue("cISAddons.cisA1")!="false"){CL().romuSB(this,d,"E",e);e.CASA_supresserror=false;avoidClickAway()}else{if(displayNotificationDI(d)){unregisterValidationError(e);resetValidationErrorDI2(e)}else{e.CASA_valErrors=[];e.CASA_valErrors.push(d);e.blur();e.focus();e.select();e.CASA_skipNextOnBlurValidation=true}}}else{e.CASA_skipNextOnBlurValidation=false}}else{flushIfDesiredDI(e)}}function resetValidationErrorDI2(a){a.style.color="";a.style.borderColor="";a.style.borderWidth="";a.CASA_hasValidationError=false;a.CASA_valErrors=[];romuDI2(a,true)}function addVersionInfoAUTOCOMPLETECONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("AUTOCOMPLETECONTROLS")}function Autocomplete(h,a,f,e,d,b,c,g){this.source=h;this.sourceprop=a;this.sourcelocation=f;this.sourcelocationprop=e;this.minlength=d;this.delay=b;this.matchmode=c;this.rows=g}function iccAUTOCOMPLETE(e,a,h,b,c,d,f,g,k){e.CASA_autocomplete=new Autocomplete(a,h,b,c,d,f,g,k);return e.CASA_autocomplete}Autocomplete.prototype.updateautocomplete=function(cc){var initok=false;var newsource=this.source;var matchmode=this.matchmode;if(this.sourceprop!=null){newsource=getPropertyValue(this.sourceprop)}var newsourceloc=this.sourcelocation;if(this.sourcelocationprop!=null){newsourceloc=getPropertyValue(this.sourcelocationprop)}if(newsource==null||newsource.length==0||newsource.toLowerCase()=="string"){var res=decodeString(newsourceloc,";");if(matchmode!=null&&matchmode.toLowerCase()=="all"){parent.$("#"+cc.id,parent.document).autocomplete({source:res})}else{parent.$("#"+cc.id,parent.document).autocomplete({source:function(request,response){var matcher=new RegExp("^"+parent.$.ui.autocomplete.escapeRegex(request.term),"i");response(parent.$.grep(res,function(item){return matcher.test(item)}))}})}initok=true}else{if(newsource.toLowerCase()=="file"){var filteradd=false;var filterlabel=true;parent.$("#"+cc.id,parent.document).autocomplete({source:function(request,response){parent.$.getJSON(newsourceloc,request,function(data,status,xhr){var exp=parent.$.ui.autocomplete.escapeRegex(request.term);if(matchmode==null||matchmode.toLowerCase()=="start"){exp="^"+exp}var matcher=new RegExp(exp,"i");response(parent.$.grep(data,function(xitem){filterlabel=(xitem.label!=undefined);filteradd=!filterlabel&&(cc.CASA_autocompletedisplayref!==undefined)&&(cc.CASA_autocompletedisplayname!==undefined);if(filteradd){return matcher.test(xitem.value)||matcher.test(eval("xitem."+cc.CASA_autocompletedisplayname))}else{if(filterlabel){return matcher.test(xitem.label)}else{return matcher.test(xitem.value||xitem)}}}))})}}).data("ui-autocomplete")._renderItem=function(ul,item){if(filteradd){return parent.$("<li>").data("ui-autocomplete-item",item).append("<a>"+item.label+"&nbsp;"+eval("item."+cc.CASA_autocompletedisplayname)).appendTo(ul)}else{return parent.$("<li>").text(item.label).appendTo(ul)}};initok=true}else{if(newsource.toLowerCase()=="url"){var noadd=true;var urlStr=newsourceloc;parent.$("#"+cc.id,parent.document).autocomplete({source:function(request,response){parent.$.ajax({url:urlStr,dataType:"jsonp",data:{q:request.term},success:function(data){response(parent.$.grep(data,function(xitem){noadd=(xitem.label!=undefined);return true}))}})}}).data("ui-autocomplete")._renderItem=function(ul,item){if(!noadd&&(cc.CASA_autocompletedisplayref!==undefined)&&(cc.CASA_autocompletedisplayname!==undefined)){return parent.$("<li>").data("ui-autocomplete-item",item).append("<a>"+item.label+"&nbsp;"+eval("item."+cc.CASA_autocompletedisplayname)).appendTo(ul)}else{return parent.$("<li>").text(item.label).appendTo(ul)}};initok=true}}}if(initok){parent.$("#"+cc.id,parent.document).autocomplete("option","minLength",this.minlength);parent.$("#"+cc.id,parent.document).autocomplete("option","delay",this.delay);parent.$("#"+cc.id,parent.document).on("autocompleteselect",acSelect);parent.$("#"+cc.id,parent.document).autocomplete("option","autoFocus",true);parent.$("#"+cc.id,parent.document).autocomplete("option","rows",this.rows)}};function reactOnShowAll(c,a){var b=parent.$("#"+c.id,parent.document).autocomplete("widget").is(":visible");if(b){return}c.focus();parent.$("#"+c.id,parent.document).autocomplete("search","")}function acSelect(event,ui){if((this.CASA_autocompletedisplayref!==undefined)&&(this.CASA_autocompletedisplayname!==undefined)){var displayname="ui.item."+this.CASA_autocompletedisplayname;setPropertyValue(this.CASA_autocompletedisplayref,eval(displayname));updateModelListeners()}this.value=ui.item.value;transferChangeFIELD(this,true,"blur")}(function(a,b){if(parent.$==b||parent.$==null){return}parent.$.widget("ui.autocomplete",parent.$.ui.autocomplete,{_resizeMenu:function(){var e,d,c,f;e=this.menu.element;if(this.options.rows!=null&&!isNaN(this.options.rows)){this.menu.element.css({overflowX:"",overflowY:"",width:"",maxHeight:""});d=e.children("li").css("whiteSpace","nowrap");if(d.length>this.options.rows){c=e.prop("clientWidth");e.css({overflowX:"hidden",overflowY:"auto",maxHeight:d.eq(0).outerHeight()*this.options.rows+1});f=c-e.prop("clientWidth");e.width(e.width()+f)}}e.outerWidth(Math.max(e.outerWidth()+1,this.element.outerWidth()))}})})(parent.jQuery);function addVersionInfoRCHARTCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("RCHARTCONTROLS")}var m_pluginRegistered=false;function iccRCHART(o,m,v,d,n,c,x,w,f,a,q,y,A,e,r,u,t,h,s,l,g,b,z,k,p){if(m!=null){registerListener(m)}o.CASA_valueprop=n;if(d!=null){o.CASA_labelsprop=d}if(c!=null){o.CASA_charttype=c}if(x!=null){o.CASA_charttypeprop=x}if(w!=null){o.CASA_selectedlabelprop=w}o.CASA_changeindexprop=f;o.CASA_lastchangeindex=-1;o.CASA_lastcharttype=null;if(a!=null){o.CASA_stackedxaxis=a}if(q!=null){o.CASA_stackedyaxis=q}if(e!=null){o.CASA_xaxisbarthickness=e}if(r!=null){o.CASA_xaxisbarpercentage=r}if(u!=null){o.CASA_xaxiscategorypercentage=u}if(t!=null){o.CASA_yaxisbarthickness=t}if(h!=null){o.CASA_showlines=h}if(s!=null){o.CASA_showvalueinchart=s}if(p!=null){o.CASA_showtooltip=p}if(y!=null){o.CASA_xaxisscalelabel=new Object();o.CASA_xaxisscalelabel.value=y;addMLValue(o.CASA_xaxisscalelabel)}if(A!=null){o.CASA_yaxisscalelabel=new Object();o.CASA_yaxisscalelabel.value=A;addMLValue(o.CASA_yaxisscalelabel)}if(v!=null){o.CASA_labels=new Object();o.CASA_labels.value=v;addMLValue(o.CASA_labels)}o.onclick=function(B){var C=o.CASA_chart.getElementAtEvent(B);try{if(o.CASA_selectedlabelprop!=null){setPropertyValue(o.CASA_selectedlabelprop,o.CASA_chart.data.labels[C[0]._index])}if(o.CASA_colinfos[C[0]._datasetIndex].onclickmethod!=undefined){invokeMethodInModel(o.CASA_valueprop+"."+o.CASA_colinfos[C[0]._datasetIndex].onclickmethod)}}catch(D){}};parent.iccGlobalChartConfig();parent.iccRchartOptions();if(o.CASA_showvalueinchart!=undefined&&o.CASA_showvalueinchart.toLowerCase()=="true"){if(k!=null){o.CASA_showvaluepos=k}else{o.CASA_showvaluepos="inside"}if(l!=null){o.CASA_showvaluefontfamily=l}else{o.CASA_showvaluefontfamily=parent.Chart.defaults.global.defaultFontFamily}if(b!=null){o.CASA_showvaluefontstyle=b}else{o.CASA_showvaluefontstyle="normal"}if(g!=null){o.CASA_showvaluefontsize=g}else{o.CASA_showvaluefontsize="16"}if(z!=null){o.CASA_showvaluefontcolor=z}else{o.CASA_showvaluefontcolor="#666"}if(m_pluginRegistered==false){registerShowValuePlugin();m_pluginRegistered=true}}}function iccRPIECHART(B,D,m,o,O,H,G,P,L,t,l,n,q,v,M,c,y,I,w,F,Q,u,A,J,R,r,z,f,h,C,p,s,e,K,d,x,a,g,k,N,E,b){if(D!=null){registerListener(D)}if(O!=null){B.CASA_data=O}if(H!=null){B.CASA_dataprop=H}if(G!=null){B.CASA_datavisibleprop=G}if(o!=null){B.CASA_labelsprop=o;registerPropertyListener(D,B.CASA_labelsprop,B.id)}if(P!=null){B.CASA_selectedlabelprop=P}if(L!=null){B.CASA_changeindexprop=L}if(l!=null){B.CASA_backgroundcolor=l}if(n!=null){B.CASA_backgroundcolorprop=n;registerPropertyListener(D,B.CASA_backgroundcolorprop,B.id)}if(t!=null){B.CASA_onclickmethod=t}if(q!=null){B.CASA_borderwidth=q}if(v!=null){B.CASA_borderwidthprop=v;registerPropertyListener(D,B.CASA_borderwidthprop,B.id)}if(M!=null){B.CASA_bordercolor=M}if(c!=null){B.CASA_bordercolorprop=c;registerPropertyListener(D,B.CASA_bordercolorprop,B.id)}if(y!=null){B.CASA_hoverbackgroundcolor=y}if(I!=null){B.CASA_hoverbackgroundcolorprop=I;registerPropertyListener(D,B.CASA_hoverbackgroundcolorprop,B.id)}if(w!=null){B.CASA_hoverborderwidth=w}if(F!=null){B.CASA_hoverborderwidthprop=F;registerPropertyListener(D,B.CASA_hoverborderwidthprop,B.id)}if(Q!=null){B.CASA_hoverbordercolor=Q}if(u!=null){B.CASA_hoverbordercolorprop=u;registerPropertyListener(D,B.CASA_hoverbordercolorprop,B.id)}if(A!=null){B.CASA_charttype=A}if(J!=null){B.CASA_charttypeprop=J;registerPropertyListener(D,B.CASA_charttypeprop,B.id)}if(R!=null){B.CASA_cutoutpercentage=R}if(r!=null){B.CASA_cutoutpercentageprop=r;registerPropertyListener(D,B.CASA_cutoutpercentageprop,B.id)}if(z!=null){B.CASA_rotation=z}if(f!=null){B.CASA_rotationprop=f;registerPropertyListener(D,B.CASA_rotationprop,B.id)}if(h!=null){B.CASA_circumference=h}if(C!=null){B.CASA_circumferenceprop=C;registerPropertyListener(D,B.CASA_circumferenceprop,B.id)}if(p!=null){B.CASA_animaterotate=p}if(s!=null){B.CASA_animaterotateprop=s}if(e!=null){B.CASA_animatescale=e}if(K!=null){B.CASA_animatescaleprop=K}if(d!=null){B.CASA_legendclickmethod=d}if(x!=null){B.CASA_showvalueinchart=x}if(b!=null){B.CASA_showtooltip=b}if(E!=null){B.CASA_showpercentage=E}B.CASA_lastchangeindex=-1;B.CASA_chart=null;B.CASA_lastcharttype=null;if(m!=null){B.CASA_labels=new Object();B.CASA_labels.value=m;addMLValue(B.CASA_label)}if(P!=null||t!=null){B.onclick=function(S){var T=B.CASA_chart.getElementAtEvent(S);try{if(B.CASA_selectedlabelprop!=undefined){setPropertyValue(B.CASA_selectedlabelprop,T[0]._model.label)}if(B.CASA_onclickmethod!=undefined){invokeMethodInModel(B.CASA_onclickmethod)}}catch(U){}}}parent.iccGlobalChartConfig();parent.iccRpieOptions();if((B.CASA_showvalueinchart!=undefined&&B.CASA_showvalueinchart.toLowerCase()=="true")||(B.CASA_showpercentage!=undefined&&B.CASA_showpercentage.toLowerCase()=="true")){if(a!=null){B.CASA_showvaluefontfamily=a}else{B.CASA_showvaluefontfamily=parent.Chart.defaults.global.defaultFontFamily}if(k!=null){B.CASA_showvaluefontstyle=k}else{B.CASA_showvaluefontstyle="normal"}if(g!=null){B.CASA_showvaluefontsize=g}else{B.CASA_showvaluefontsize="16"}if(N!=null){B.CASA_showvaluefontcolor=N}else{B.CASA_showvaluefontcolor="#666"}if(m_pluginRegistered==false){registerShowValuePlugin();m_pluginRegistered=true}}}function romuRPIECHART(a){parent.window.requestAnimationFrame(function(b){doRomuRPIE(a)})}function doRomuRPIE(g){var f="pie";if(g.CASA_charttype!=undefined){f=g.CASA_charttype}if(g.CASA_charttypeprop!=undefined){f=getPropertyValue(g.CASA_charttypeprop)}if(f!="pie"&&f!="doughnut"){f="pie"}if(g.CASA_chart!=null&&g.CASA_lastcharttype!=f){g.CASA_lastchangeindex=-1}if(g.CASA_changeindexprop!=undefined){var d=getPropertyValue(g.CASA_changeindexprop);if(g.CASA_chart!=null&&d==g.CASA_lastchangeindex){return}g.CASA_lastchangeindex=d}var e="";if(g.CASA_labels!=undefined){e=g.CASA_labels.value.split(";")}if(g.CASA_labelsprop!=undefined){e=getPropertyValue(g.CASA_labelsprop).split(";")}var b=new Object();if(g.CASA_data!=undefined){b.data=g.CASA_data.split(";")}if(g.CASA_dataprop!=undefined){b.data=getPropertyValue(g.CASA_dataprop).split(";")}if(g.CASA_backgroundcolor!=undefined){b.backgroundColor=g.CASA_backgroundcolor.split(";")}if(g.CASA_backgroundcolorprop!=undefined){b.backgroundColor=getPropertyValue(g.CASA_backgroundcolorprop).split(";")}if(g.CASA_borderwidth!=undefined){b.borderWidth=g.CASA_borderwidth.split(";")}if(g.CASA_borderwidthprop!=undefined){b.borderWidth=getPropertyValue(g.CASA_borderwidthprop).split(";")}if(g.CASA_bordercolor!=undefined){b.borderColor=g.CASA_bordercolor.split(";")}if(g.CASA_bordercolorprop!=undefined){b.borderColor=getPropertyValue(g.CASA_bordercolorprop).split(";")}if(g.CASA_hoverbackgroundcolor!=undefined){b.hoverBackgroundColor=g.CASA_hoverbackgroundcolor.split(";")}if(g.CASA_hoverbackgroundcolorprop!=undefined){b.hoverBackgroundColor=getPropertyValue(g.CASA_hoverbackgroundcolorprop).split(";")}if(g.CASA_hoverborderwidth!=undefined){b.hoverBorderWidth=g.CASA_hoverborderwidth.split(";")}if(g.CASA_hoverborderwidthprop!=undefined){b.hoverBorderWidth=getPropertyValue(g.CASA_hoverborderwidthprop).split(";")}if(g.CASA_hoverbordercolor!=undefined){b.hoverBorderColor=g.CASA_hoverbordercolor.split(";")}if(g.CASA_hoverbordercolorprop!=undefined){b.hoverBorderColor=getPropertyValue(g.CASA_hoverbordercolorprop).split(";")}var a=new Object();a.labels=e;a.datasets=[b];var c=parent.m_rpieoptions;if(g.CASA_cutoutpercentage!=undefined){c.cutoutPercentage=parseInt(g.CASA_cutoutpercentage)}if(g.CASA_cutoutpercentageprop!=undefined){c.cutoutPercentage=parseInt(getPropertyValue(g.CASA_cutoutpercentageprop))}if(g.CASA_rotation!=undefined){c.rotation=parseFloat(g.CASA_rotation)}if(g.CASA_rotationprop!=undefined){c.rotation=parseFloat(getPropertyValue(g.CASA_rotationprop))}if(g.CASA_circumference!=undefined){c.circumference=parseFloat(g.CASA_circumference)}if(g.CASA_circumferenceprop!=undefined){c.circumference=parseFloat(getPropertyValue(g.CASA_circumferenceprop))}if(g.CASA_animaterotate=="false"){c.animation.animateRotate=false}if(g.CASA_animaterotateprop!=undefined){c.animation.animateRotate=getPropertyValue(g.CASA_animaterotateprop)}if(g.CASA_animatescale=="true"){c.animation.animateScale=true}if(g.CASA_animatescaleprop!=undefined){c.animation.animateScale=getPropertyValue(g.CASA_animatescaleprop)}if(g.CASA_showtooltip!=undefined&&g.CASA_showtooltip.toLowerCase()=="false"){c.tooltips.enabled=false}if(g.CASA_chart!=null){g.CASA_chart.destroy()}g.CASA_lastcharttype=f;setRPIELegendClick(c);g.CASA_chart=new parent.Chart(g.getContext("2d"),{type:f,data:a,options:c});updPIEVisibility(g)}function romuRCHART(a){parent.window.requestAnimationFrame(function(b){doRomuRCHART(a)})}function doRomuRCHART(d){var m="bar";if(d.CASA_charttype!=undefined){m=d.CASA_charttype}if(d.CASA_charttypeprop!=undefined){m=getPropertyValue(d.CASA_charttypeprop)}if(m!="bar"&&m!="line"&&m!="pie"&&m!="horizontalBar"){m="bar"}if(d.CASA_chart!=null&&d.CASA_lastcharttype!=m){d.CASA_lastchangeindex=-1}if(d.CASA_changeindexprop!=null){var h=getPropertyValue(d.CASA_changeindexprop);if(d.CASA_chart!=null&&h==d.CASA_lastchangeindex){return}d.CASA_lastchangeindex=h}var p;if(d.CASA_labels!=undefined){p=d.CASA_labels.value}if(d.CASA_labelsprop!=undefined){var n=0;var a;p="";while(true){a=getPropertyValue(d.CASA_valueprop+".items["+n+"]."+d.CASA_labelsprop);if(a==null||a==""){break}if(n>0){p=p+";"}p=p+a;n++}}p=p.split(";");var e=[];var b=null;for(i=0;i<d.CASA_colinfos.length;i++){var k=[];var g;b=d.CASA_colinfos[i];for(j=0;j<p.length;j++){g=getPropertyValue(d.CASA_valueprop+".items["+j+"]."+b.property);if(g==null){break}k.push(g)}var f=new Object();f.fill=false;if(b.label!=undefined){f.label=b.label.value}if(b.labelprop!=undefined){f.label=getPropertyValue(b.labelprop)}f.data=k;if(b.backgroundcolor!=undefined){f.backgroundColor=b.backgroundcolor}if(b.backgroundcolorprop!=undefined){f.backgroundColor=getPropertyValue(b.backgroundcolorprop)}if(b.bordercolor!=undefined){f.borderColor=b.bordercolor}if(b.bordercolorprop!=undefined){f.borderColor=getPropertyValue(b.bordercolorprop)}if(b.borderwidth!=undefined){f.borderWidth=parseInt(b.borderwidth)}if(b.borderwidthprop!=undefined){f.borderWidth=parseInt(getPropertyValue(b.borderwidthprop))}if(m=="bar"||m=="horizontalBar"){if(b.hoverbackgroundcolor!=undefined){f.hoverBackgroundColor=b.hoverbackgroundcolor}if(b.hoverbackgroundcolorprop!=undefined){f.hoverBackgroundColor=getPropertyValue(b.hoverbackgroundcolorprop)}if(b.hoverbordercolor!=undefined){f.hoverBorderColor=b.hoverbordercolor}if(b.hoverbordercolorprop!=undefined){f.hoverBorderColor=getPropertyValue(b.hoverbordercolorprop)}if(b.hoverborderwidth!=undefined){f.hoverBorderWidth=parseInt(b.hoverborderwidth)}if(b.hoverborderwidthprop!=undefined){f.hoverBorderWidth=parseInt(getPropertyValue(b.hoverborderwidthprop))}}else{if(m=="line"){if(b.pointbordercolor!=undefined){f.pointBorderColor=b.pointbordercolor}if(b.pointbordercolorprop!=undefined){f.pointBorderColor=getPropertyValue(b.pointbordercolorprop)}if(b.pointbackgroundcolor!=undefined){f.pointBackgroundColor=b.pointbackgroundcolor}if(b.pointbackgroundcolorprop!=undefined){f.pointBackgroundColor=getPropertyValue(b.pointbackgroundcolorprop)}if(b.pointborderwidth!=undefined){f.pointBorderWidth=parseInt(b.pointborderwidth)}if(b.pointborderwidthprop!=undefined){f.pointBorderWidth=parseInt(getPropertyValue(b.pointborderwidthprop))}if(b.borderdash!=undefined){f.borderDash=b.borderdash.split(";")}if(b.borderdashprop!=undefined){f.borderDash=getPropertyValue(b.borderdashprop).split(";")}if(b.pointradius!=undefined){f.pointRadius=parseInt(b.pointradius)}if(b.pointradiusprop!=undefined){f.pointRadius=parseInt(getPropertyValue(b.pointradiusprop))}if(b.pointhoverradius!=undefined){f.pointHoverRadius=parseInt(b.pointhoverradius)}if(b.pointhoverradiusprop!=undefined){f.pointHoverRadius=parseInt(getPropertyValue(b.pointhoverradiusprop))}if(b.pointhitradius!=undefined){f.pointHitRadius=parseInt(b.pointhitradius)}if(b.pointhitradiusprop!=undefined){f.pointHitRadius=parseInt(getPropertyValue(b.pointhitradiusprop))}if(b.pointhoverbackgroundcolor!=undefined){f.pointHoverBackgroundColor=b.pointhoverbackgroundcolor}if(b.pointhoverbackgroundcolorprop!=undefined){f.pointHoverBackgroundColor=getPropertyValue(b.pointhoverbackgroundcolorprop)}if(b.pointhoverbordercolor!=undefined){f.pointHoverBorderColor=b.pointhoverbordercolor}if(b.pointhoverbordercolorprop!=undefined){f.pointHoverBorderColor=getPropertyValue(b.pointhoverbordercolorprop)}if(b.pointhoverborderwidth!=undefined){f.pointHoverBorderWidth=parseInt(b.pointhoverborderwidth)}if(b.pointhoverborderwidthprop!=undefined){f.pointHoverBorderWidth=parseInt(getPropertyValue(b.pointhoverborderwidthprop))}if(b.pointstyle!=null!=undefined){f.pointStyle=b.pointstyle}if(b.pointstyleprop!=null!=undefined){f.pointStyle=getPropertyValue(b.pointstyleprop)}if(b.steppedline!=undefined&&b.steppedline=="true"){f.steppedLine=true}if(b.steppedlineprop!=undefined){f.steppedLine=getPropertyValue(b.steppedlineprop)}}}e.push(f)}var l={labels:p,datasets:e};if(d.CASA_chart!=null){d.CASA_chart.destroy()}d.CASA_lastcharttype=m;var c=parent.m_rchartoptions;if(d.CASA_xaxisscalelabel!=undefined){c.scales.xAxes[0].scaleLabel.labelString=d.CASA_xaxisscalelabel.value}if(d.CASA_yaxisscalelabel!=undefined){c.scales.yAxes[0].scaleLabel.labelString=d.CASA_yaxisscalelabel.value}if(d.CASA_stackedxaxis!=undefined){c.scales.xAxes[0].stacked=(d.CASA_stackedxaxis.toLowerCase()=="true")}if(d.CASA_stackedyaxis!=undefined){c.scales.yAxes[0].stacked=(d.CASA_stackedyaxis.toLowerCase()=="true")}if(d.CASA_xaxisbarthickness!=undefined){c.scales.xAxes[0].barThickness=parseInt(d.CASA_xaxisbarthickness)}if(d.CASA_xaxisbarpercentage!=undefined){c.scales.xAxes[0].barPercentage=parseFloat(d.CASA_xaxisbarpercentage)}if(d.CASA_xaxiscategorypercentage!=undefined){c.scales.xAxes[0].categoryPercentage=parseFloat(d.CASA_xaxiscategorypercentage)}if(d.CASA_yaxisbarthickness!=undefined){c.scales.yAxes[0].barThickness=parseInt(d.CASA_yaxisbarthickness)}if(d.CASA_showlines!=undefined){c.showLines=(d.CASA_showlines.toLowerCase()=="true")}if(d.CASA_showtooltip!=undefined&&d.CASA_showtooltip.toLowerCase()=="false"){c.tooltips.enabled=false}setRCHARTLegendClick(c);var o=d.getContext("2d");d.CASA_chart=new parent.Chart(o,{type:m,data:l,options:c});updRCHARTVisibility(d)}function updPIEVisibility(b){if(b.CASA_datavisibleprop!=undefined){var a=getPropertyValue(b.CASA_datavisibleprop).split(";");for(j=0;j<a.length;j++){b.CASA_chart.getDatasetMeta(0).data[j].hidden=(a[j].toLowerCase()=="false")}b.CASA_chart.update()}}function updRCHARTVisibility(b){for(i=0;i<b.CASA_colinfos.length;i++){if(b.CASA_colinfos[i].visibleprop!=undefined){var a=getPropertyValue(b.CASA_colinfos[i].visibleprop);b.CASA_chart.getDatasetMeta(i).hidden=(a.toLowerCase()=="false")}}b.CASA_chart.update()}function setRCHARTLegendClick(a){a.legend.onClick=function(g,b){var c=b.datasetIndex;var d=this.chart;var f=d.getDatasetMeta(c);f.hidden=f.hidden===null?!d.data.datasets[c].hidden:null;var h=this.ctx.canvas;if(h.CASA_colinfos[c].visibleprop!=undefined){setPropertyValue(h.CASA_colinfos[c].visibleprop,(f.hidden!=true))}d.update();if(h.CASA_colinfos[c].legendclickmethod!=undefined){invokeMethodInModel(h.CASA_colinfos[c].legendclickmethod)}}}function setRPIELegendClick(a){a.legend.onClick=function(h,k){var g=k.index;var l=this.chart;var f,b,n;var d=this.ctx.canvas;for(f=0,b=(l.data.datasets||[]).length;f<b;++f){n=l.getDatasetMeta(f);if(n.data[g]){n.data[g].hidden=!n.data[g].hidden;if(d.CASA_datavisibleprop!=undefined){var c=getPropertyValue(d.CASA_datavisibleprop).split(";");if(n.data[g].hidden){c[g]="FALSE"}else{c[g]="TRUE"}var m="";for(j=0;j<c.length;j++){if(j>0){m+=";"}m+=c[j]}setPropertyValue(d.CASA_datavisibleprop,m)}}}l.update();if(d.CASA_legendclickmethod!=undefined){invokeMethodInModel(d.CASA_legendclickmethod)}}}function registerShowValuePlugin(){parent.Chart.plugins.register({afterDatasetsDraw:function(b,e){var a=b.chart.ctx;var d=a.canvas;if((d.CASA_showvalueinchart==undefined||d.CASA_showvalueinchart.toLowerCase()=="false")&&(d.CASA_showpercentage==undefined||d.CASA_showpercentage.toLowerCase()=="false")){return}var c=parseInt(d.CASA_showvaluefontsize);a.fillStyle=d.CASA_showvaluefontcolor;a.font=parent.Chart.helpers.fontString(c,d.CASA_showvaluefontstyle,d.CASA_showvaluefontfamily);a.textAlign="center";a.textBaseline="middle";if(b.config.type=="pie"||b.config.type=="doughnut"){b.data.datasets.forEach(function(h){for(var k=0;k<h.data.length;k++){if(h._meta[Object.keys(h._meta)[0]].data[k].hidden==true){continue}var m=h._meta[Object.keys(h._meta)[0]].data[k]._model,q=h._meta[Object.keys(h._meta)[0]].total,g=m.innerRadius+(m.outerRadius-m.innerRadius)/2,l=m.startAngle,n=m.endAngle,f=l+(n-l)/2;var r=g*Math.cos(f);var p=g*Math.sin(f);var o=String(Math.round(h.data[k]/q*100))+"%";if(d.CASA_showvalueinchart!=undefined&&d.CASA_showvalueinchart.toLowerCase()=="true"){a.fillText(h.data[k],m.x+r,m.y+p)}if(d.CASA_showpercentage!=undefined&&d.CASA_showpercentage.toLowerCase()=="true"){a.fillText(o,m.x+r,m.y+p+15)}}})}else{b.data.datasets.forEach(function(h,f){var g=b.getDatasetMeta(f);if(!g.hidden){g.data.forEach(function(n,m){var o=h.data[m].toString();var l=n.tooltipPosition();if(b.config.type=="line"){a.fillStyle="#666";a.fillText(o,l.x,l.y-(c/2)-5)}if(b.config.type=="bar"){var k=n.height();if(k>0){if(d.CASA_showvaluepos=="inside"){if(k>=c+10){a.fillText(o,l.x,l.y+(c/2)+5)}}else{a.fillText(o,l.x,l.y-(c/2)-5)}}else{if(d.CASA_showvaluepos=="inside"){if(k<=(0-c-10)){a.fillText(o,l.x,l.y-(c/2)-5)}}else{a.fillText(o,l.x,l.y+(c/2)+5)}}}if(b.config.type=="horizontalBar"){if(o[0]=="-"){a.fillText(o,l.x+20,l.y)}else{a.fillText(o,l.x-20,l.y)}}})}})}}})}function addVersionInfoOPENSTREETMAPCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("OPENSTREETMAPCONTROLS")}var m_OSMMap=new Object();function iccOSMAP(q,p,b,h,u,o,l,k,r,c,t,f,n,g,s,a,e,m,d,v){if(p!=null){registerListener(p)}if(b!=null){q.CASA_longitudeprop=b;registerPropertyListener(p,q.CASA_longitudeprop,q.id)}if(h!=null){q.CASA_latitudeprop=h;registerPropertyListener(p,q.CASA_latitudeprop,q.id)}if(u!=null){q.CASA_addressprop=u;registerPropertyListener(p,q.CASA_addressprop,q.id)}if(l!=null){q.CASA_selectprop=l}if(k!=null){q.CASA_zoomprop=k;registerPropertyListener(p,q.CASA_zoomprop,q.id)}if(r!=null){q.CASA_maxzoomprop=r;registerPropertyListener(p,q.CASA_maxzoomprop,q.id)}if(c!=null){q.CASA_minzoomprop=c;registerPropertyListener(p,q.CASA_minzoomprop,q.id)}if(m=="true"){q.CASA_withoverviewmap=true}if(d=="true"){q.CASA_withlocationmarker=true}if(v=="true"){q.CASA_withgeocoder=true}if(a!=null){q.CASA_zoom=a}else{q.CASA_zoom=0}if(n!=null){q.CASA_maxzoom=n}if(g!=null){q.CASA_minzoom=g}if(s!=null){q.CASA_rotation=s}if(t!=null){q.CASA_pixelratio=t}if(f!=null){q.CASA_logo=f}if(e!=null){q.CASA_opacity=e}q.CASA_onclickmethod=o;q.CASA_longitudeold="";q.CASA_latitudeold="";q.CASA_osmlon="";q.CASA_osmlat=""}function romuOSMAP(a){if((a.CASA_withgeocoder!=undefined)&&(a.CASA_addressprop!=null)){if(getPropertyValue(a.CASA_addressprop)!=""){getCoord(a,"http://nominatim.openstreetmap.org/search?q="+encodeURLParameter(getPropertyValue(a.CASA_addressprop))+"&format=json&polygon=0&addressdetails=1")}}else{parent.window.requestAnimationFrame(function(b){doRomuOSMAP(a)})}}function doRomuOSMAP(f){if(parent.m_roi_firstusage==true){return}var e="";var b="";var d=null;var c=null;var a=false;if(f.CASA_longitudeprop!=null){e=getPropertyValue(f.CASA_longitudeprop)}if(f.CASA_latitudeprop!=null){b=getPropertyValue(f.CASA_latitudeprop)}if(f.CASA_zoomprop!=null){if((getPropertyValue(f.CASA_zoomprop))!=""){f.CASA_zoom=getPropertyValue(f.CASA_zoomprop)}}if(f.CASA_maxzoomprop!=null){if((getPropertyValue(f.CASA_maxzoomprop))!=""){f.CASA_maxzoom=getPropertyValue(f.CASA_maxzoomprop)}}if(f.CASA_minzoomprop!=null){if((getPropertyValue(f.CASA_minzoomprop))!=""){f.CASA_minzoom=getPropertyValue(f.CASA_minzoomprop)}}if(f.CASA_osmlon!=null&&f.CASA_osmlon!=""){e=f.CASA_osmlon}if(f.CASA_osmlat!=null&&f.CASA_osmlat!=""){b=f.CASA_osmlat}d=getOSMAP(f.id);if((e!=null&&e!=""&&b!=null&&b!="")&&(e!=f.CASA_longitudeold||b!=f.CASA_latitudeold)){f.CASA_longitudeold=e;f.CASA_latitudeold=b;if(d==null){c=new parent.ol.View({center:parent.ol.proj.fromLonLat([parseFloat(e),parseFloat(b)]),zoom:parseInt(f.CASA_zoom)});if(f.CASA_maxzoom!=null){c.setMaxZoom(parseInt(f.CASA_maxzoom))}if(f.CASA_minzoom!=null){c.setMinZoom(parseInt(f.CASA_minzoom))}if(f.CASA_rotation!=null){c.setRotation(parseFloat(f.CASA_rotation))}if(f.CASA_logo!=null){d=new parent.ol.Map({logo:f.CASA_logo})}else{d=new parent.ol.Map({})}d.addLayer(new parent.ol.layer.Tile({source:new parent.ol.source.OSM()}));d.set("target",f.id);d.set("view",c);if(f.CASA_pixelratio!=null){d.set("pixelRatio",parseFloat(f.CASA_pixelratio))}if(f.CASA_opacity!=null){d.getLayers().forEach(function(h,g){h.set("opacity",parseFloat(f.CASA_opacity))})}if(f.CASA_onclickmethod!=null){d.on("singleclick",function(g){var h=parent.ol.proj.transform(g.coordinate,"EPSG:3857","EPSG:4326");setPropertyValue(f.CASA_selectprop+".longitude",h[0]);setPropertyValue(f.CASA_selectprop+".latitude",h[1]);if(f.CASA_withgeocoder!=undefined){getAddress(f,"http://nominatim.openstreetmap.org/reverse?format=json&lat="+h[1]+"&lon="+h[0]+"&zoom=18&addressdetails=1")}else{doInvokeMethodInModel(f)}})}if(f.CASA_withoverviewmap!=undefined){d.addControl(new parent.ol.control.OverviewMap())}m_OSMMap[f.id]=d;if(f.CASA_withlocationmarker!=undefined){initLocation(f)}}else{if(f.CASA_osmlon!=null&&f.CASA_osmlon!=""){e=f.CASA_osmlon}if(f.CASA_osmlat!=null&&f.CASA_osmlat!=""){b=f.CASA_osmlat}if(f.CASA_withlocationmarker!=undefined){updateLocation(f)}d.getView().setCenter(parent.ol.proj.fromLonLat([parseFloat(e),parseFloat(b)]));d.getView().setZoom(parseInt(f.CASA_zoom));if(f.CASA_maxzoom!=null){d.getView().setMaxZoom(parseInt(f.CASA_maxzoom))}if(f.CASA_minzoom!=null){d.getView().setMinZoom(parseInt(f.CASA_minzoom))}}a=true}if(d!=null&&(this.romuMARKER!=undefined)){a=this.romuMARKER(f)||a}if(a){d.updateSize()}if(d!=null&&(this.romuLAYER!=undefined)){this.romuLAYER(f);d.render()}}function initLocation(g,f){g.CASA_locationfeature=new parent.ol.Feature({});g.CASA_locationfeature.setGeometry(new parent.ol.geom.Point([parseFloat(g.CASA_longitudeold),parseFloat(g.CASA_latitudeold)]));var c=new parent.ol.source.Vector({});var a=new parent.ol.layer.Vector({source:c});g.CASA_locationfeature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),getOSMAP(g.id).getLayers().item(0).getSource().getProjection());var e=new parent.ol.style.Fill({color:[190,0,0,1]});var d=new parent.ol.style.Stroke({color:[190,0,0,1],width:3});var b=new parent.ol.style.Style({image:new parent.ol.style.Circle({fill:e,stroke:d,radius:10})});a.setStyle(b);getOSMAP(g.id).addLayer(a);c.addFeature(g.CASA_locationfeature)}function updateLocation(a){a.CASA_locationfeature.getGeometry().setCoordinates([parseFloat(a.CASA_longitudeold),parseFloat(a.CASA_latitudeold)]);a.CASA_locationfeature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),getOSMAP(a.id).getLayers().item(0).getSource().getProjection())}function getOSMAP(a){return(m_OSMMap[a])}function getAddress(c,b){var a=new XMLHttpRequest();a.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var d=JSON.parse(this.responseText);var e;if(d.address.village!=undefined){e=d.address.village}if(d.address.town!=undefined){e=d.address.town}if(d.address.city!=undefined){e=d.address.city}c.CASA_osmaddress=d.address.country+","+d.address.postcode+","+e+","+d.address.road+","+d.address.house_number;doInvokeMethodInModel(c)}else{if(this.status>=400){alert("HTTP response status: "+this.status+"\n\n"+this.responseText)}}};a.open("GET",b,true);a.send()}function getCoord(c,a){var b=new XMLHttpRequest();b.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var d=JSON.parse(this.responseText);if(d.length>0){c.CASA_osmlon=d[0].lon;c.CASA_osmlat=d[0].lat;var e;if(d[0].address.village!=undefined){e=d[0].address.village}if(d[0].address.town!=undefined){e=d[0].address.town}if(d[0].address.city!=undefined){e=d[0].address.city}c.CASA_osmaddress=d[0].address.country+","+d[0].address.postcode+","+e+","+d[0].address.road+","+d[0].address.house_number;doRomuOSMAP(c)}}else{if(this.status>=400){alert("HTTP response status: "+this.status+"\n\n"+this.responseText)}}};b.open("GET",a,true);b.send()}function doInvokeMethodInModel(a){setPropertyValue(a.CASA_selectprop+".address",a.CASA_osmaddress);invokeMethodInModel(a.CASA_onclickmethod)}function addVersionInfoMARKERCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("MARKERCONTROLS")}var m_markers=[];var m_overlays=null;function iccMARKER(f,c,h,p,o,n,d,l,q,r,g,b,e,k,m,a){f.CASA_valueprop=h;f.CASA_maxcount=l;f.CASA_osmid=c.id;if(n!=null){f.CASA_onclickmethod=n}if(d!=null){f.CASA_ondblclickmethod=d}if(o!=null){f.CASA_textprop=o}if(q!=null){f.CASA_straighttext=q}if(r!=null){f.CASA_positioning=r}if(g!=null){f.CASA_offset=g}if(b!=null){f.CASA_insertfirst=b}if(e!=null){f.CASA_autopan=e}if(k!=null){f.CASA_autopananimation=k}if(m!=null){f.CASA_autopanmargin=m}if(a!=null){f.CASA_renderaspopover=a}m_markers.push(f);for(i=0;i<f.CASA_maxcount;i++){registerPropertyListener(p,f.CASA_valueprop+".items["+i+"].visible",f.id);if(f.CASA_textprop!=undefined){registerPropertyListener(p,f.CASA_valueprop+".items["+i+"]."+f.CASA_textprop,f.id)}}}function reactMARKER(c,a){var b=a.currentTarget.id.split("_");if(c.CASA_onclickmethod!=null){invokeMethodInModel(c.CASA_valueprop+".items["+b[2]+"]."+c.CASA_onclickmethod)}}function romuMARKER2(a){updateOverlays(this.getOSMAP(a),a)}function romuMARKER(a){if(m_overlays!=null){return updateOverlays(this.getOSMAP(a.id),a.id)}else{return createOverlays(this.getOSMAP(a.id),a.id)}}function updateOverlays(d,a){if(d==null){return}for(i=0;i<m_overlays.length;i++){if(m_overlays[i].cc.CASA_osmid!=a){continue}var c=d.getOverlayById(m_overlays[i].id);var b=getPropertyValue(m_overlays[i].item+".visible");if(b!="true"&&b!=true){c.getElement().style.display="none"}else{c.getElement().style.display=""}if(m_overlays[i].cc.CASA_textprop!=undefined){var e=getPropertyValue(m_overlays[i].item+"."+m_overlays[i].cc.CASA_textprop);if(m_overlays[i].cc.CASA_renderaspopover!=undefined&&m_overlays[i].cc.CASA_renderaspopover=="true"){c.getElement().setAttribute("data-content",e)}else{if(m_overlays[i].cc.CASA_straighttext!=undefined&&m_overlays[i].cc.CASA_straighttext!="true"){c.getElement().innerHTML=e}else{c.getElement().innerHTML="<p>"+e+"</p>"}}}c.setPosition(parent.ol.proj.fromLonLat([parseFloat(getPropertyValue(m_overlays[i].item+".longitude")),parseFloat(getPropertyValue(m_overlays[i].item+".latitude"))]));c.changed()}if(m_overlays.length>0){d.renderSync()}return false}function createOverlays(a,d){if(m_overlays==null){m_overlays=[]}var b=false;for(i=0;i<m_markers.length;i++){if(m_markers[i].CASA_osmid!=d){continue}for(j=0;j<m_markers[i].CASA_maxcount;j++){var g=new Object();g.cc=m_markers[i];try{g.item=m_markers[i].CASA_valueprop+".items["+j+"]"}catch(e){break}var c=getPropertyValue(g.item+".visible");g.id=""+m_markers[i].id+"_"+j;var k=parent.document.getElementById(g.id);if(m_markers[i].CASA_textprop!=undefined){var h=getPropertyValue(g.item+"."+m_markers[i].CASA_textprop);if(m_markers[i].CASA_renderaspopover!=undefined&&m_markers[i].CASA_renderaspopover=="true"){k.setAttribute("data-content",h)}else{if(m_markers[i].CASA_straighttext!=undefined&&m_markers[i].CASA_straighttext!="true"){k.innerHTML=h}else{k.innerHTML="<p>"+h+"</p>"}}}var f=new parent.ol.Overlay({position:parent.ol.proj.fromLonLat([parseFloat(getPropertyValue(g.item+".longitude")),parseFloat(getPropertyValue(g.item+".latitude"))]),element:k,id:g.id,stopEvent:true});if(m_markers[i].CASA_positioning!=undefined){f.set("positioning",m_markers[i].CASA_positioning,true)}if(m_markers[i].CASA_offset!=undefined){f.set("offset",parseInt(m_markers[i].CASA_offset),true)}if(m_markers[i].CASA_insertfirst=="false"){f.set("insertFirst",false,true)}if(m_markers[i].CASA_autopan=="true"){f.set("autoPan",true,true)}if(m_markers[i].CASA_insertfirst=="false"){f.set("insertFirst",false,true)}if(m_markers[i].CASA_autopananimation!=undefined){f.set("autoPanAnimation",new Object({duration:parseInt(m_markers[i].CASA_autopananimation)}),true)}if(m_markers[i].CASA_autopanmargin!=undefined){f.set("autoPanMargin",parseInt(m_markers[i].CASA_autopanmargin),true)}if(c!="true"&&c!=true){f.getElement().style.display="none"}a.addOverlay(f);m_overlays.push(g);b=true}if(m_markers[i].CASA_renderaspopover!=undefined&&m_markers[i].CASA_renderaspopover=="true"){parent.$('[data-toggle="popover"]').popover()}}return b}function addVersionInfoMAPLAYERCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("MAPLAYERCONTROLS")}var m_OSMLayers=new Object();var m_OSMVectorLayers=new Object();var m_OSMVectorSources=new Object();function iccMAPLAYER(g,e,f,c,b,a,d){if(getOSMLayer(g)==undefined){m_OSMLayers[g]=new Object()}m_OSMLayers[g].layerid=g;m_OSMLayers[g].osmid=e;m_OSMLayers[g].romumethod=f;m_OSMLayers[g].visibleprop=c;m_OSMLayers[g].zindex=b;m_OSMLayers[g].name=a;m_OSMLayers[g].withanimation=d}function romuLAYER(c){for(var e in m_OSMLayers){var a="true";if(m_OSMLayers[e].visibleprop!=undefined){a=getPropertyValue(m_OSMLayers[e].visibleprop)}if(m_OSMLayers[e].osmid.id==c.id){if(m_OSMVectorLayers[e]==undefined&&m_OSMVectorSources[e]==undefined){m_OSMVectorSources[e]=new parent.ol.source.Vector({projection:"EPSG:4326"});if(m_OSMLayers[e].withanimation=="true"){m_OSMVectorSources[e].on("addfeature",function(g){animateMapFeature(g.feature,c.id)})}m_OSMVectorLayers[e]=new parent.ol.layer.Vector({source:m_OSMVectorSources[e]});this.getOSMAP(c.id).addLayer(m_OSMVectorLayers[e])}if(m_OSMVectorLayers[e]!=undefined&&m_OSMVectorSources[e]!=undefined){if(m_OSMLayers[e].zindex!=undefined){m_OSMVectorLayers[e].setZIndex(m_OSMLayers[e].zindex)}if(a=="true"){m_OSMVectorLayers[e].setVisible(true)}else{m_OSMVectorLayers[e].setVisible(false)}}for(var d in m_OSMLayers[e].osmPoints){romuPointMarker(this.getOSMAP(c.id),m_OSMLayers[e].osmPoints[d],m_OSMVectorSources[e])}for(var b in m_OSMLayers[e].osmLines){romuLineMarker(this.getOSMAP(c.id),m_OSMLayers[e].osmLines[b],m_OSMVectorSources[e])}for(var f in m_OSMLayers[e].osmPolygons){romuPolygonMarker(this.getOSMAP(c.id),m_OSMLayers[e].osmPolygons[f],m_OSMVectorSources[e])}}}return true}function iccPOINT(a,c,e,k,d,b,g,h,f){if(getOSMLayer(c)==undefined){m_OSMLayers[c]=new Object();m_OSMLayers[c].layerid=c}if(m_OSMLayers[c].osmPoints==undefined){m_OSMLayers[c].osmPoints=new Object()}m_OSMLayers[c].osmPoints[a]=new Object();m_OSMLayers[c].osmPoints[a].id=a;m_OSMLayers[c].osmPoints[a].layerid=c;m_OSMLayers[c].osmPoints[a].longitudeprop=e;m_OSMLayers[c].osmPoints[a].latitudeprop=k;m_OSMLayers[c].osmPoints[a].fillcolor=d;m_OSMLayers[c].osmPoints[a].strokecolor=b;m_OSMLayers[c].osmPoints[a].strokelinedash=g;if(h!=null){m_OSMLayers[c].osmPoints[a].strokewidth=parseFloat(h)}if(f!=null){m_OSMLayers[c].osmPoints[a].radius=parseFloat(f)}}function iccLINE(a,d,g,k,h,e,b,f,c,l){if(getOSMLayer(d)==undefined){m_OSMLayers[d]=new Object();m_OSMLayers[d].layerid=d}if(m_OSMLayers[d].osmLines==undefined){m_OSMLayers[d].osmLines=new Object()}m_OSMLayers[d].osmLines[a]=new Object();m_OSMLayers[d].osmLines[a].id=a;m_OSMLayers[d].osmLines[a].layerid=d;m_OSMLayers[d].osmLines[a].startlongitudeprop=g;m_OSMLayers[d].osmLines[a].startlatitudeprop=k;m_OSMLayers[d].osmLines[a].endlongitudeprop=h;m_OSMLayers[d].osmLines[a].endlatitudeprop=e;m_OSMLayers[d].osmLines[a].strokecolor=b;m_OSMLayers[d].osmLines[a].strokelinedash=f;m_OSMLayers[d].osmLines[a].strokelinecap=c;if(l!=null){m_OSMLayers[d].osmLines[a].strokewidth=parseFloat(l)}}function iccPOLYGON(g,f,e,d,a,b,c){if(getOSMLayer(f)==undefined){m_OSMLayers[f]=new Object();m_OSMLayers[f].layerid=f}if(m_OSMLayers[f].osmPolygons==undefined){m_OSMLayers[f].osmPolygons=new Object()}m_OSMLayers[f].osmPolygons[g]=new Object();m_OSMLayers[f].osmPolygons[g].id=g;m_OSMLayers[f].osmPolygons[g].layerid=f;m_OSMLayers[f].osmPolygons[g].polycoordinatesprop=e;m_OSMLayers[f].osmPolygons[g].fillcolor=d;m_OSMLayers[f].osmPolygons[g].strokecolor=a;m_OSMLayers[f].osmPolygons[g].strokelinedash=b;if(c!=null){m_OSMLayers[f].osmPolygons[g].strokewidth=parseFloat(c)}}function romuPointMarker(e,g,f){if(f.getFeatureById(g.id)!=null){updatePointLocation(e,g);romuAnimate(g);return}else{g.CASA_feature=new parent.ol.Feature({});g.CASA_feature.setId(g.id);g.CASA_feature.setGeometry(new parent.ol.geom.Point([parseFloat(getPropertyValue(g.longitudeprop)),parseFloat(getPropertyValue(g.latitudeprop))]));g.CASA_feature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),e.getLayers().item(0).getSource().getProjection());var d=undefined;if(g.fillcolor!=null){d=new parent.ol.style.Fill({});d.setColor(g.fillcolor)}var c=new parent.ol.style.Stroke({});if(g.strokecolor!=null){c.setColor(g.strokecolor)}if(g.strokewidth!=null){c.setWidth(g.strokewidth)}if(g.strokelinedash!=null){c.setLineDash(g.strokelinedash.split(";"))}var b=new parent.ol.style.Circle({fill:d,stroke:c});if(g.radius!=null){b.setRadius(g.radius)}var a=new parent.ol.style.Style({image:b});g.CASA_feature.setStyle(function(h,k){if(h.CASA_animation!=undefined&&h.CASA_animation.finished==false){return null}else{return a}});romuAnimate(g);setTimeout(function(){f.addFeature(g.CASA_feature)},100)}}function romuLineMarker(c,e,d){if(d.getFeatureById(e.id)!=null){updateLineLocation(c,e);romuAnimate(e);return}else{e.CASA_feature=new parent.ol.Feature({});e.CASA_feature.setId(e.id);e.CASA_feature.setGeometry(new parent.ol.geom.LineString([[parseFloat(getPropertyValue(e.startlongitudeprop)),parseFloat(getPropertyValue(e.startlatitudeprop))],[parseFloat(getPropertyValue(e.endlongitudeprop)),parseFloat(getPropertyValue(e.endlatitudeprop))]]));e.CASA_feature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),c.getLayers().item(0).getSource().getProjection());var b=new parent.ol.style.Stroke({});if(e.strokecolor!=null){b.setColor(e.strokecolor)}if(e.strokewidth!=null){b.setWidth(e.strokewidth)}if(e.strokelinecap!=null){b.setLineCap(e.strokelinecap)}if(e.strokelinedash!=null){b.setLineDash(e.strokelinedash.split(";"))}var a=new parent.ol.style.Style({stroke:b});e.CASA_feature.setStyle(function(f,g){if(f.CASA_animation!=undefined&&f.CASA_animation.finished==false){return null}else{return a}});romuAnimate(e);setTimeout(function(){d.addFeature(e.CASA_feature)},100)}}function romuPolygonMarker(d,e,b){if(b.getFeatureById(e.id)!=null){updatePolygonLocation(d,e);romuAnimate(e);return}else{e.CASA_feature=new parent.ol.Feature({});e.CASA_feature.setId(e.id);var k=[];for(j=0;;j++){var c=getPropertyValue(e.polycoordinatesprop+".items["+j+"].longitude");var f=getPropertyValue(e.polycoordinatesprop+".items["+j+"].latitude");if(c==null||f==null){break}else{k[j]=([parseFloat(c),parseFloat(f)])}}e.CASA_feature.setGeometry(new parent.ol.geom.Polygon([k]));e.CASA_feature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),d.getLayers().item(0).getSource().getProjection());var g=undefined;if(e.fillcolor!=null){g=new parent.ol.style.Fill({});g.setColor(e.fillcolor)}var h=new parent.ol.style.Stroke({});if(e.strokecolor!=null){h.setColor(e.strokecolor)}if(e.strokewidth!=null){h.setWidth(e.strokewidth)}if(e.strokelinedash!=null){h.setLineDash(e.strokelinedash.split(";"))}var a=new parent.ol.style.Style({fill:g,stroke:h});e.CASA_feature.setStyle(function(l,m){if(l.CASA_animation!=undefined&&l.CASA_animation.finished==false){return null}else{return a}});romuAnimate(e);setTimeout(function(){b.addFeature(e.CASA_feature)},100)}}function getOSMLayer(a){return m_OSMLayers[a]}function getPOINT(b,a){return m_OSMLayers[b].osmPoints[a]}function getLINE(b,a){return m_OSMLayers[b].osmLines[a]}function getPOLYGON(b,a){return m_OSMLayers[b].osmPolygons[a]}function getVectorSource(a){return m_OSMVectorSources[a]}function updatePointLocation(a,b){b.CASA_feature.getGeometry().setCoordinates([parseFloat(getPropertyValue(b.longitudeprop)),parseFloat(getPropertyValue(b.latitudeprop))]);b.CASA_feature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),a.getLayers().item(0).getSource().getProjection())}function updateLineLocation(a,b){b.CASA_feature.getGeometry().setCoordinates([[parseFloat(getPropertyValue(b.startlongitudeprop)),parseFloat(getPropertyValue(b.startlatitudeprop))],[parseFloat(getPropertyValue(b.endlongitudeprop)),parseFloat(getPropertyValue(b.endlatitudeprop))]]);b.CASA_feature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),a.getLayers().item(0).getSource().getProjection())}function updatePolygonLocation(c,e){var a=[];for(j=0;;j++){var d=getPropertyValue(e.polycoordinatesprop+".items["+j+"].longitude");var b=getPropertyValue(e.polycoordinatesprop+".items["+j+"].latitude");if(d==null||b==null){break}else{a[j]=([parseFloat(d),parseFloat(b)])}}e.CASA_feature.getGeometry().setCoordinates([a]);e.CASA_feature.getGeometry().transform(new parent.ol.proj.Projection({code:"EPSG:4326"}),c.getLayers().item(0).getSource().getProjection())}function addVersionInfoANIMATIONCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("ANIMATIONCONTROLS")}function iccAnimatePOINT(b,f,a,l,d,k,n,m,h,c,g){var e=this.getPOINT(f,b);e.CASA_animation=new Object();if(a!=null){e.CASA_animation.duration=parseInt(a)}if(l!=null){e.CASA_animation.repeat=parseInt(l)}if(d!=null){e.CASA_animation.startradius=parseFloat(d)}if(k!=null){e.CASA_animation.endradius=parseFloat(k)}if(n!=null){e.CASA_animation.width=parseFloat(n)}if(m!=null){e.CASA_animation.rgbcolor=m}if(h!=null){e.CASA_animation.fillrgbcolor=h}if(c!=null){e.CASA_animation.prop=c}if(g!=null&&g.toLowerCase()=="true"){e.CASA_animation.onadd=true}else{e.CASA_animation.onadd=false}e.CASA_animation.finished=true;if(e.CASA_animation.onadd==true){e.CASA_animation.finished=false}}function iccAnimateLINE(b,e,a,h,l,g,k,c,f){var d=this.getLINE(e,b);d.CASA_animation=new Object();if(a!=null){d.CASA_animation.duration=parseInt(a)}if(h!=null){d.CASA_animation.repeat=parseInt(h)}if(g!=null){d.CASA_animation.dash=g.split(";")}if(l!=null){d.CASA_animation.width=parseFloat(l)}if(k!=null){d.CASA_animation.rgbcolor=k}if(c!=null){d.CASA_animation.prop=c}if(f!=null&&f.toLowerCase()=="true"){d.CASA_animation.onadd=true}else{d.CASA_animation.onadd=false}d.CASA_animation.finished=true;if(d.CASA_animation.onadd==true){d.CASA_animation.finished=false}}function iccAnimatePOLYGON(b,e,a,k,m,g,l,h,c,f){var d=this.getPOLYGON(e,b);d.CASA_animation=new Object();if(a!=null){d.CASA_animation.duration=parseInt(a)}if(k!=null){d.CASA_animation.repeat=parseInt(k)}if(g!=null){d.CASA_animation.dash=g.split(";")}if(m!=null){d.CASA_animation.width=parseFloat(m)}if(l!=null){d.CASA_animation.rgbcolor=l}if(h!=null){d.CASA_animation.fillrgbcolor=h}if(c!=null){d.CASA_animation.prop=c}if(f!=null&&f.toLowerCase()=="true"){d.CASA_animation.onadd=true}else{d.CASA_animation.onadd=false}d.CASA_animation.finished=true;if(d.CASA_animation.onadd==true){d.CASA_animation.finished=false}}function romuAnimate(c){if(c.CASA_feature.CASA_animation==undefined){c.CASA_feature.CASA_animation=c.CASA_animation}if(c.CASA_feature.CASA_animation.onadd==true){return}if(c.CASA_feature.CASA_animation.prop==undefined){return}var a=getPropertyValue(c.CASA_feature.CASA_animation.prop);if(a=="true"||a=="TRUE"){if(c.CASA_feature.CASA_animation.finished==true){var b=getVectorSource(c.layerid);c.CASA_feature.CASA_animation.finished=false;b.removeFeature(c.CASA_feature);b.addFeature(c.CASA_feature)}}else{c.CASA_feature.CASA_animation.finished=true}}function animateMapFeature(k,d){var b=new Date().getTime();var e=3000;var c=1;var f=5;var h=30;var g;if(k.CASA_animation!=undefined){if(k.CASA_animation.startradius!=undefined){f=k.CASA_animation.startradius}if(k.CASA_animation.duration!=undefined){e=k.CASA_animation.duration}if(k.CASA_animation.repeat!=undefined){c=k.CASA_animation.repeat}if(k.CASA_animation.endradius!=undefined){h=k.CASA_animation.endradius}k.CASA_animation.onadd=false}function a(l){if(k.CASA_animation==undefined){return}var w=l.frameState.time-b;var q=w/e;var r=parent.ol.easing.easeOut(1-q);var m=null;var u=null;var o=null;var n=0;var x=undefined;if(k.CASA_animation.rgbcolor!=undefined){o=k.CASA_animation.rgbcolor;if(o.toLowerCase().indexOf("rgb")==0&&o.toLowerCase().indexOf("rgba")<0){o=o.replace(/rgb/g,"rgba");o=o.replace(/\)/g,","+r+")")}}if(o==null){o="rgba(255, 0, 0, "+r+")"}if(k.CASA_animation.fillrgbcolor!=undefined){var t=k.CASA_animation.fillrgbcolor;if(t.toLowerCase().indexOf("rgb")==0&&t.toLowerCase().indexOf("rgba")<0){t=t.replace(/rgb/g,"rgba");t=t.replace(/\)/g,","+r+")")}x=new parent.ol.style.Fill({color:t})}if(k.CASA_animation.width!=undefined){n=k.CASA_animation.width+r}if(n==0){n=1+r}function s(){var y=(parent.ol.easing.easeOut(q)*(h-f))+f;u=k.getGeometry().clone();m=new parent.ol.style.Style({image:new parent.ol.style.Circle({radius:y,snapToPixel:false,fill:x,stroke:new parent.ol.style.Stroke({color:o,width:n})})})}function v(){u=k.getGeometry().clone();m=new parent.ol.style.Style({stroke:new parent.ol.style.Stroke({color:o,width:n,lineDash:k.CASA_animation.dash})})}function p(){var z=k.getGeometry().getCoordinates();var y=z.length+1;u=new parent.ol.geom.Polygon(z);m=new parent.ol.style.Style({fill:x,stroke:new parent.ol.style.Stroke({color:o,width:n,lineDash:k.CASA_animation.dash})})}if(k.getId().indexOf("MP_")==0){s()}if(k.getId().indexOf("ML_")==0){v()}if(k.getId().indexOf("MY_")==0){p()}l.vectorContext.setStyle(m);l.vectorContext.drawGeometry(u);if(w>e||k.CASA_animation.finished==true){c=c-1;if(c<=0||k.CASA_animation.finished==true){parent.ol.Observable.unByKey(g);if(k.CASA_animation.prop!=undefined){setPropertyValue(k.CASA_animation.prop,"false")}k.CASA_animation.finished=true;k.changed()}else{b=new Date().getTime()}}getOSMAP(d).render()}g=this.getOSMAP(d).on("postcompose",a)};