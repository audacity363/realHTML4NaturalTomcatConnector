function addVersionInfoCSC(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("CSC")}var m_doLog=true;var m_firstUsage=true;var m_pageInactive=false;var m_modelName;var m_modelId;var m_sessionId;var m_processId;var m_pageName="dummy";var m_modelListeners=[];var m_modelListenersLast=[];var m_modelListenersSCROLL=[];var m_propertyListeners=[];var m_propertyListenersTBP=[];var m_statuspropListeners=[];var m_switchToDisplayListeners=[];var m_switchToOccupiedListeners=[];var m_dcListeners=[];var m_properties;var m_model;var m_currentArray;var m_currentRow;var m_internalProperties=[];var m_bufferNeedsRefresh=false;var m_callcounter=0;var m_processCasabacSynchronizeIfNecessary;var m_processInvokeMethodInModel;var m_dateDisplay="DD.MM.YYYY";var m_americanStyle=null;var m_timeDisplay="HH:MM:SS";var m_decimalSeparator=",";var m_1000Separator=true;var m_language="en";var m_direction="ltr";var m_hotKeyCode="17;18";var m_headerObjects=[];var m_footerObjects=[];var m_clickAwayObjects=[];var m_clickAwayMethods=[];var m_avoidClickAway=false;var m_modelDeltaId="inittini";var m_formulas=[];var m_FieldsArray=[];var m_validationRules=[];var m_calledInPopup=false;var casaPopupParameters;var casaPopupReturnValue;var m_parentparent=parent.parent;var m_parentdocument=parent.document;var m_parentparentdocument=parent.parent.document;var m_bufferedxml=null;var m_validationErrors=[];var m_logStrings=[];var m_logDates=[];var m_logIndex=0;var m_mozdivs=[];var m_isSafari;var m_isFirefox;var m_firefoxVersion;var m_inEditMode=null;var m_lastProcessedControlId=-1;var m_continueMethod=null;var m_innerFrames=[];var m_innerFramesIndex=0;var m_innerMFFrames=[];var m_innerMFFramesIndex=0;var m_synchronizePage=false;var m_synchronizeAvoidDrillDown=false;var m_firstFocusCall=true;var m_newModelForAddFocusRequestor=false;var m_focusRequestors=[];var m_focusables=[];var m_focusablesCat=[];var m_focusSETIN=undefined;var m_suppressFocusManagementOncePAGE;var m_hotKeys=[];var m_hotKeysWithCallback=[];var m_hotKeysWithControlScope=[];var m_hotKeysPAGE=new Object();var m_noProcessingForNextHotKey=false;var m_tabElements=new Object();var m_tabElementsUndefined=new Object();var m_completeCounter=0;var m_cscformOccupied=false;var m_cscformxmlstack=[];var m_cre1="\001";var m_cre2="\002";var m_cre3="\003";var m_cre4="\004";var m_cre5="\005";var m_cre6="\006";var m_cre35="\035";var m_cre36="\036";var m_re1=new RegExp("\001","g");var m_re2=new RegExp("\002","g");var m_re3=new RegExp("\003","g");var m_re4=new RegExp("\004","g");var m_re5=new RegExp("\005","g");var m_re6=new RegExp("\006","g");var m_re35=new RegExp("\035","g");var m_re36=new RegExp("\036","g");var m_beforeFirstReactOnNewModel=true;var m_firstModel=true;var m_continueUpdateModelListeners;var m_killedItems=0;var m_pushedContinueMethod;var m_bufferedMethodName="inittini";var m_noactivityuntil;var m_displayOccupied=true;var m_suppressClearAdapterStream=false;var m_doBlockIO=true;var m_checkIOFalseCounter=0;var m_MLValues=[];var m_MLTextNodes=[];var m_MLSpans=[];var m_MLButtons=[];var m_MLOptions=[];var m_MLImages=[];var m_MLTabs=[];var m_openedAmodals=[];var m_lastStamp=undefined;var m_jsversions=[];var m_jsfiles=[];var m_consolelog=undefined;var m_islogonform=false;var m_uiprop=null;var m_uipropframe;var m_resetValiddationErrorsAndFlush;var m_iccInfos=[];var m_resizeTimeout=null;var m_focusTimeout=null;function doReactOnResize(a){for(i=parent.m_resizeListeners.length-1;i>=0;i--){parent.m_resizeListeners[i]()}updateModelListenersScroll(null);m_resizeTimeout=null}function handleReactOnResize(){if(m_modelName==undefined||m_modelName==null){return}if(m_modelName.indexOf("natlegacy")>0){doReactOnResize()}else{if(m_resizeTimeout!=null){return}m_resizeTimeout=99;parent.window.requestAnimationFrame(this.doReactOnResize)}}function addMozDiv(a,b){if(addMozDivInternally){addMozDivInternally(a,b)}}function replaceMozDiv(a,b){if(replaceMozDivInternally){replaceMozDivInternally(a,b)}}function deactivatePage(){m_pageInactive=true;for(var b=0;b<m_openedAmodals.length;b++){try{m_openedAmodals[b].close()}catch(c){}}m_openedAmodals=[];for(var d=0;d<m_innerFrames.length;d++){try{m_innerFrames[d].WORKAREA.csciframe.deactivatePage()}catch(a){}}}function setDisplayPage(b){try{setDisplayTHISOCCUPIED(b)}catch(a){}for(var c=0;c<m_innerFrames.length;c++){try{m_innerFrames[c].WORKAREA.csciframe.setDisplayPage(b)}catch(a){}}}function checkIfPageIsDeactivated(){return m_pageInactive}function getTargetFrame(b,c,a){return CL().C_findFrame(b,c,a)}function initGlobals(){if(m_firstUsage==true){m_firstUsage=false;return}m_modelName=undefined;m_modelId=undefined;m_sessionId=undefined;m_processId=undefined;m_pageName="dummy";m_properties=undefined;m_model=undefined;m_currentArray=undefined;m_currentRow=undefined;m_internalProperties=[];m_bufferNeedsRefresh=false;m_processCasabacSynchronizeIfNecessary=false;m_processInvokeMethodInModel=false;m_avoidClickAway=false;m_modelDeltaId="inittini";m_calledInPopup=false;casaPopupParameters=null;casaPopupReturnValue=null;m_bufferedxml=null;m_validationErrors=[];m_inEditMode=null;m_continueMethod=null;m_innerFrames=[];m_innerFramesIndex=0;m_innerMFFrames=[];m_innerMFFramesIndex=0;m_synchronizePage=false;m_firstFocusCall=true;m_focusSETIN=undefined;m_hotKeys=[];m_hotKeysPAGE=new Object();m_noProcessingForNextHotKey=false;m_tabElements=new Object();m_tabElementsUndefined=new Object();m_completeCounter=0;m_cscformOccupied=false;m_cscformxmlstack=[];m_beforeFirstReactOnNewModel=true;m_firstModel=true;m_continueUpdateModelListeners=undefined;m_killedItems=0;m_pushedContinueMethod=undefined;m_bufferedMethodName="inittini";m_openedAmodals=[];m_lastStamp=undefined;m_formulas=[];m_FieldsArray=[];m_islogonform=false;m_uiprop=null;m_uipropframe=null;m_currentFocusLine=null;m_currentFocusGrid=null;m_iccInfos=[];if(parent.m_roi_firstusage!=false){m_mozdivs=[];m_headerObjects=[];m_footerObjects=[]}}function dragEnter(b){b.preventDefault();var a=parent.document.querySelector(".previewDragOver");if(a!=null){a.classList.remove("previewDragOver")}if(b.target!=null){b.target.classList.add("previewDragOver")}}function dragLeave(a){a.preventDefault();if(a.target!=null){a.target.classList.remove("previewDragOver")}}function dragEnd(b){b.preventDefault();var a=parent.document.querySelector(".previewDragOver");if(a!=null){a.classList.remove("previewDragOver")}}function addEventListenerIFRAME(b){if(b==null){return}var a=parent.document.getElementById(b);if(a==null){return}var c=(a.contentWindow||a.contentDocument);if(c.document){c=c.document}if(c.addEventListener){c.addEventListener("keydown",suppressBrowserKeysIFRAME,false);c.addEventListener("mousewheel",suppressBrowserKeysIFRAME,false)}}function suppressBrowserKeysIFRAME(b){if(b==null){return}if(b.type=="mousewheel"&&b.shiftKey){return CL().cancelEvent(b)}try{if(b.keyCode>111&&b.keyCode<124){return CL().cancelEvent(b)}if((b.keyCode==87&&b.ctrlKey==true)||(b.keyCode==82&&b.ctrlKey==true)){return CL().cancelEvent(b)}if(b.keyCode==8){return CL().cancelEvent(b)}}catch(a){}}function addIccInfo(b,a,c){var d=new Object();d.name=b;d.baseIndex=a;d.iccString=c;m_iccInfos.push(d)}function repeatIcc(a){a=(-1)*a*(-1);for(var b=0;b<m_iccInfos.length;b++){var d=m_iccInfos[b];var e=d.baseIndex+a;var c=d.iccString.replace(/items\[[0-9]+\]/g,"items["+e+"]");parent.iccExec(d.name,c)}}function initCasaControl(a){for(var b in a){if(b.indexOf("CASA_")>=0){a[b]=undefined}}}function findVisibleValue(a){if(a!=null&&a!=undefined&&a!=""){return a}if(parent.m_visiblevalueifundefined==undefined){return a}return parent.m_visiblevalueifundefined}function CL(){var a=m_parentparent.m_centralLib;return a}function calculatePageOffset(e){var g=0;var a=0;var b=document.documentElement;var c=e.getBoundingClientRect();var f=b.scrollLeft;var d=b.scrollTop;if(m_direction=="rtl"){g=c.right+f}else{g=c.left+f}a=c.top+d;e.CASA_pageoffsetleft=g;e.CASA_pageoffsettop=a}function calculateFrameOffset(f){var c=m_parentparent;var g=0;var e=0;while(true){try{if(c==null){break}if(f=="_top"){break}if(f!=null&&c.name==f){break}g+=c.frameElement.offsetTop;e+=c.frameElement.offsetLeft;var d=c.parent.parent;if(c==d){break}c=d}catch(b){return null}}var a=new Object();a.frameOffsetLeft=e;a.frameOffsetTop=g;return a}function calculateScrollTop(e){var d=e;var b=0;while(true){try{if(d==null){break}b=b+d.scrollTop;var c=d.offsetParent;if(d==c){break}d=c}catch(a){break}}return b}var mm_openCasabacPageAsModalPopup=null;function openCasabacPageAsModalPopup(b,a,c){if(mm_openCasabacPageAsModalPopup==null){mm_openCasabacPageAsModalPopup=CL().C_openCasabacPageAsModalPopup}return mm_openCasabacPageAsModalPopup(b,a,c)}function setPageName(a){m_pageName=a}function reactOnInit(){if(parent.parent.m_centralLib==null){window.location.href="../HTMLBasedGUI/general/aboutBlank.html";return}parent.reactOnInit()}function convertDoubleTildeToUTag(c){if(c==null){return null}if(c.indexOf("~~")<0){return c}var a=[];var d=0;var b=c.indexOf("~~");while(b>=0&&(b+2)<c.length){a.push(c.substring(d,b));a.push("<u>");a.push(c.charAt(b+2));a.push("</u>");d=b+3;b=c.indexOf("~~",d)}a.push(c.substring(d,c.length));return a.join("")}function reactOnResizePAGEBODY(a){doResizePAGEBODY(a);if(this.sizeMozDivs!=undefined){sizeMozDivs()}doResizePAGEBODY(a)}function doResizePAGEBODY(b){var a=parent.innerHeight||parent.document.body.clientHeight;a=a-calculateHeaderHeight()-calculateFooterHeight();if(a<0){a=0}var c=parent.innerWidth||parent.document.body.clientWidth;if(b.CASA_bufferedHeight==a&&b.CASA_bufferedWidth==c){return}b.CASA_bufferedHeight=a;b.CASA_bufferedWidth=c;passPagePixelSize(c,a);b.style.height=C_adjustUnits(a);b.style.width=C_adjustUnits(c)}function passPagePixelSize(a,b){if(b<=0){b=parent.innerHeight||parent.document.body.clientHeight}if(a<=0){a=parent.innerWidth||parent.document.body.clientWidth}setPropertyValue("pagePixelHeight",b);setPropertyValue("pagePixelWidth",a)}function passTimeZoneOffset(){try{var b=new Date();setPropertyValue("timeZoneOffset",(-1)*(b.getTimezoneOffset()))}catch(a){}}function switchToOccupiedPAGE(){m_focusTimeout=99;if(m_doBlockIO){parent.m_blockIO=true}m_doBlockIO=true;if(m_displayOccupied){setDisplayTHISOCCUPIED("")}m_displayOccupied=true;for(var b=0;b<m_switchToOccupiedListeners.length;b++){var c=m_switchToOccupiedListeners[b];try{c.listenermethod(c.param)}catch(a){addLogMessage("ERROR on calling switchToOccupiedListeners "+a);addLogMessage("ERROR on calling switchToOccupiedListeners "+c.listenermethod)}}}m_firstMozillaSwitch=true;function switchToDisplayPAGE(){m_focusTimeout=null;m_pageInactive=false;m_cscformOccupied=false;parent.m_blockIO=false;parent.m_blockIOByFlush=false;parent.CasaPAGE.style.display="";var a=findTHISOCCUPIED(false);if(a!=null){setDisplayTHISOCCUPIED("");setDisplayTHISOCCUPIED("none")}if(m_firstMozillaSwitch==true){if(parent.C.sizeMozDivs!=undefined){parent.C.sizeMozDivs()}m_firstMozillaSwitch=false}if(parent.CasaLOADING&&parent.CasaLOADING.style.display==""){parent.CasaLOADING.style.display="none"}try{parent.parent.bringToFrontSCP(parent.location.href)}catch(b){}}var mm_startDragCL=null;function startDragCL(d,e,a,c,b){if(mm_startDragCL==null){mm_startDragCL=CL().C_startDrag}return mm_startDragCL.call(this,d,e,a,c,b)}var mm_setDragShift=null;function setDragShift(c,b,a){if(mm_setDragShift==null){mm_setDragShift=CL().C_setDragShift}return mm_setDragShift.call(this,c,b,a)}var mm_moveDragCL=null;function moveDragCL(a){if(mm_moveDragCL==null){mm_moveDragCL=CL().C_moveDrag}return mm_moveDragCL.call(this,a)}var mm_checkIfDragProcessIsActiveCL=null;function checkIfDragProcessIsActiveCL(){if(mm_checkIfDragProcessIsActiveCL==null){mm_checkIfDragProcessIsActiveCL=CL().C_checkIfDragProcessIsActive}return mm_checkIfDragProcessIsActiveCL.call(this)}var mm_endDragCL=null;function endDragCL(a){if(mm_endDragCL==null){mm_endDragCL=CL().C_endDrag}return mm_endDragCL.call(this,a)}var m_startDragTime=null;function startDragPAGE(a,b){try{var c=findDRAGDROP();m_startDragTime=(new Date()).getTime();parent.m_dragMode=true;c.innerHTML=a}catch(d){}}function setDragShiftPAGE(b,a){parent.m_dragIconShiftLeft=b;parent.m_dragIconShiftTop=a}var m_colMoveVisTEXTGRID;function moveDragPAGE(b){try{if(b!=null&&b.button!=0){if(checkIO()==false){var e=findTHISOCCUPIED(false);if(e!=null){setDisplayTHISOCCUPIED("");if(m_parentparent.m_fixedOccupiedImage){e.style.left=0;e.style.top=0}else{e.style.left=C_adjustUnits((b.clientX+10));e.style.top=C_adjustUnits((b.clientY+10))}}}else{setDisplayTHISOCCUPIED("none")}}if(checkIfDragProcessIsActiveCL()){moveDragCL(b);return}var c=findDRAGDROP(false);if(c==null){return}if(parent.m_dragMode==false){return}if(m_startDragTime!=null&&(new Date().getTime()-m_startDragTime<250)){return}c.style.display="";if(parent.m_dragType=="RESIZABLE"){var a=parent.m_dragRsizable;c.style.top=C_adjustUnits(a.CASA_posY);c.style.left=C_adjustUnits(b.clientX)}else{if(parent.m_dragType=="COLMOVE"){m_colMoveVisTEXTGRID=true;var a=parent.m_dragRsizable;c.style.top=C_adjustUnits(a.CASA_posY);var g=b.clientX;if(a.CASA_posXMin>g){c.style.left=C_adjustUnits(a.CASA_posXMin)}else{if(a.CASA_posXMax<g){c.style.left=C_adjustUnits(a.CASA_posXMax)}else{c.style.left=C_adjustUnits((g-10))}}}else{if(parent.m_dragType=="VSPLIT"){var a=parent.document.getElementById(parent.m_dragId);c.style.top=C_adjustUnits(a.CASA_posY);var g=b.clientX;if(a.CASA_posXMin>g){c.style.left=C_adjustUnits(a.CASA_posXMin)}else{if(a.CASA_posXMax<g){c.style.left=C_adjustUnits(a.CASA_posXMax)}else{c.style.left=C_adjustUnits(g)}}}else{if(parent.m_dragType=="HSPLIT"){var a=parent.document.getElementById("HSPLIT"+parent.m_dragId);c.style.left=C_adjustUnits(a.CASA_posX);var f=b.clientY;if(a.CASA_posYMin>f-3){c.style.top=C_adjustUnits(a.CASA_posYMin)}else{if(a.CASA_posYMax<f){c.style.top=C_adjustUnits(a.CASA_posYMax)}else{c.style.top=C_adjustUnits(f)}}}else{if(parent.m_dragType=="CHARTAREA"){c.style.left=C_adjustUnits((b.clientX+parent.m_dragIconShiftLeft));c.style.top=C_adjustUnits((b.clientY+parent.m_dragIconShiftTop))}else{c.style.left=C_adjustUnits((b.clientX+10));c.style.top=C_adjustUnits((b.clientY+10))}}}}}dsc();return false}catch(d){}}function dsc(){if(this.parent.document.selection){this.parent.document.selection.empty()}else{var a=this.parent.window.getSelection();if(a&&a.rangeCount>0&&a.getRangeAt(0).getClientRects().length>0){this.parent.window.getSelection().removeAllRanges()}}}var m_dragEndCallback;var m_draggingControl;function endDragPAGE(a){if(checkIfDragProcessIsActiveCL()){endDragCL(a);return}try{if(m_dragEndCallback!=null){m_dragEndCallback(m_draggingControl);m_dragEndCallback=null}var b=findDRAGDROP(false);if(b==null){return}m_startDragTime=null;m_colMoveVisTEXTGRID=undefined;parent.document.body.style.cursor="";b.style.display="none";parent.m_dragMode=false;parent.m_dragId=null;parent.m_dropMethod=null;if(parent.m_dragType=="VSPLIT"){reactOnMouseUpVSPLIT(b.CASA_splitCC,a)}else{if(parent.m_dragType=="HSPLIT"){reactOnMouseUpHSPLIT(b.CASA_splitCC,a)}}parent.m_dragType=null;return true}catch(c){}}function registerValidationError(a){a.CASA_cscValidationErrorStamp="FIELD";a.CASA_hasValidationError=true;m_validationErrors.push(a)}function registerValidationErrorForDateInput(a){a.CASA_cscValidationErrorStamp="DATEINPUT";m_validationErrors.push(a)}function unregisterValidationError(c){var b=[];for(var a=0;a<m_validationErrors.length;a++){if(m_validationErrors[a]!=c){b.push(m_validationErrors[a])}}m_validationErrors=b}function checkAllValidations(){checkAllValidations(true)}function checkAllValidations(u){if(m_resetValiddationErrorsAndFlush==true){resetValidationErrors();m_resetValiddationErrorsAndFlush=false;return true}for(var j=0;j<m_innerFrames.length;j++){try{var e=m_innerFrames[j].WORKAREA.csciframe.checkAllValidations();if(e==false){return false}}catch(m){}}if(m_FieldsArray.length>0&&m_validationRules.length>0){for(var p=0;p<m_FieldsArray.length;p++){var l=m_FieldsArray[p];for(var t=0;t<m_validationRules.length;t++){var r=m_validationRules[t];var c=r.split(";");c=self.rulesStringtoFieldValueProp(c[0]);if(l.CASA_valueprop==c){var g=r.split("_");if(g[g.length-1]=="onsubmit"){l.CASA_checkOnSubmit=true;var n=l.value;if(l.CASA_datatype=="float"){n=convertDisplayStringIntoFLOAT(n)}self.checkValidationRules(l,g,n)}}}}}if(m_validationErrors.length==0){return true}var d="";for(var s=0;s<m_validationErrors.length;s++){if(m_validationErrors[s].CASA_valErrors!=null){var b=m_validationErrors[s].CASA_valErrors;for(var q=0;q<b.length;q++){if(d.search(b[q])<0){d+=b[q]+"\n\n"}}m_validationErrors[s].lastTitle=m_validationErrors[s].title;m_validationErrors[s].title=d;self.decorateInputFieldOnError(m_validationErrors[s]);m_validationErrors[s].CASA_valErrors=[]}}try{m_validationErrors[m_validationErrors.length-1].focus()}catch(a){}d=d.substring(0,d.lastIndexOf("\n"));var f=d;d=replaceLiteralWithAddTextTRANSLATION(m_language,"labelNoValidInput",d,self);if(d==null||d==""||u==false){d=replaceLiteralTRANSLATION(m_language,"labelNoValidPage")}if(getPropertyValue("cISAddons.cisA1")!="false"){return false}else{if(u==true&&confirm(d)){resetValidationErrors();return true}if(u==false){var h=d.lastIndexOf("\n");if(h>0){d=d.substring(0,h)}alert(d+"\n\n"+f);m_validationErrors=[]}}if(window.location.href.indexOf("ZZZZZZZZGenerated")>0){return true}return false}function isValueHelpOpen(){var a=findMPADIV();return((a!=null)&&(a.style.display!="none"))}function isContextMenuOpen(){var a=findTHISCONTEXTMENU(false);return((a!=null)&&(a.style.display!="none"))}function resetValidationErrors(){for(var a=0;a<m_validationErrors.length;a++){var c=m_validationErrors[a];if(c.CASA_cscValidationErrorStamp=="DATEINPUT"){resetValidationErrorDI(c);if(c.lastValue!=undefined){c.value=c.lastValue}}else{resetValidationErrorFIELD(c);if(c.lastValue!=undefined){c.value=c.lastValue}}}m_validationErrors=[];var b=findMPADIV();if(b!=null){b.style.display="none"}}function addLogMessage(b){vDate=new Date();m_logStrings[m_logIndex]=b;m_logDates[m_logIndex]=vDate;m_logIndex++;if(m_logIndex>300){m_logIndex=0}try{CL().m_lastLogString=b+" in "+parent.location.href;CL().m_lastLogDate=vDate}catch(a){}if(m_consolelog==undefined){m_consolelog=getPropertyValue("cISAddons.jsconsolelog")}if(m_consolelog==true||m_consolelog=="true"){console.log(vDate.getMinutes()+"/"+vDate.getSeconds()+"/"+vDate.getMilliseconds()+" ==> "+m_modelName+" ==> "+b)}}function convertCasabacURL(a){if(a==null){return null}if(a.charAt(0)=="/"){return m_parentparent.m_currentWebApp+a}return a}function isFirefox(){if(m_isFirefox==undefined){m_isFirefox=/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent);m_firefoxVersion=new Number(RegExp.$1)}return m_isFirefox}function getFirefoxVersion(){if(isFirefox()){return m_firefoxVersion}return -1}function isSafari(){if(m_isSafari==undefined){m_isSafari=navigator.userAgent.toLowerCase().indexOf("safari")!=-1}return m_isSafari}function findSrcElement(a){if(a==null){return null}return a.target}function handleLastInput(a){a.blur();try{a.focus()}catch(b){}}function avoidNextSynchronizationDrillDown(){m_synchronizeAvoidDrillDown=true}function addInnerFrame(a){m_innerFrames[m_innerFrames.length]=a}function synchronizeAndContinue(a){synchronizePageAndInnerPagesAndContinue(a)}function synchronizePageAndInnerPagesAndContinue(a){m_continueMethod=a;m_innerFramesIndex=m_innerFrames.length-1;m_synchronizePage=true;synchronizeAndContinueWithNextIndex()}function synchronizeInnerPagesAndContinue(b){m_continueMethod=b;if(m_synchronizeAvoidDrillDown==false){m_innerFramesIndex=m_innerFrames.length-1}else{m_innerFramesIndex=-1;m_synchronizeAvoidDrillDown=false}m_synchronizePage=false;try{synchronizeAndContinueWithNextIndex()}catch(a){}}function synchronizeAndContinueWithNextIndex(){if(m_innerFrames!=null&&m_innerFramesIndex>=0&&m_innerFramesIndex<m_innerFrames.length){var c=m_innerFrames[m_innerFramesIndex];m_innerFramesIndex--;try{if(c!=null&&c.WORKAREA!=null&&c.m_isCasabacMFPAGE!=true&&c.WORKAREA.csciframe!=null){addLogMessage("synchronizing inner frame "+(m_innerFramesIndex+1));c.WORKAREA.m_blockIOByFlush=true;if(m_resetValiddationErrorsAndFlush==true){c.WORKAREA.csciframe.m_resetValiddationErrorsAndFlush=true}c.WORKAREA.csciframe.synchronizePageAndInnerPagesAndContinue(synchronizeAndContinueWithNextIndex)}else{if(c!=null&&c.WORKAREA!=null&&c.WORKAREA.m_isCasabacMFPAGE==true){addLogMessage("synchronizing inner frame "+(m_innerFramesIndex+1)+" - this is a MFPAGE");m_innerMFFrames=c.WORKAREA.getCasabacFrames();m_innerMFFramesIndex=m_innerMFFrames.length;synchronizeNextMFFrame()}else{synchronizeAndContinueWithNextIndex()}}}catch(a){synchronizeAndContinueWithNextIndex()}}else{if(m_synchronizePage==true){var e=false;if(m_properties==null){var g=m_continueMethod;m_continueMethod=null;if(g!=null){g()}return}invokeDCListeners();var f=m_properties.length;for(var b=0;b<f;b++){if(m_properties[b].isChanged==true){var d=m_properties[b].name.indexOf("rowCount");if(d>0&&d==m_properties[b].name.length-8){}else{if(!m_internalProperties[m_properties[b].name]==true){e=true;break}}}}if(e==true){setPropertyValue("cISubPageRefresh","true");submitModel("submit")}else{var g=m_continueMethod;m_continueMethod=null;if(g!=null){g()}}}else{var g=m_continueMethod;m_continueMethod=null;if(g!=null){g()}}}}function synchronizeNextMFFrame(){m_innerMFFramesIndex--;if(m_innerMFFramesIndex<0){synchronizeAndContinueWithNextIndex();return}addLogMessage("synchronizing inner MF frame "+m_innerMFFramesIndex);try{m_innerMFFrames[m_innerMFFramesIndex].WORKAREA.csciframe.synchronizePageAndInnerPagesAndContinue(synchronizeNextMFFrame)}catch(a){addLogMessage("Exception caught: csc.synchronizeNextMFFrame:"+a);synchronizeNextMFFrame()}}function checkIO(){if(m_modelName==undefined||m_modelName==null){return false}if(m_modelName.indexOf("natlegacy")>0){return checkIOTrue()}if(parent.m_blockIOByFlush==true){return checkIOTrue()}if(parent.m_blockIO==true){return checkIOFalse2()}if(CL().checkMozIO(m_parentparent,false)==false){return checkIOFalse()}return checkIOTrue()}function checkIOForNoSubmits(){if(parent.m_blockIO==true&&parent.m_blockIOByFlush==true){var b=new Date();if(m_lastServerFetch!=null){var a=b.getTime()-m_lastServerFetch.getTime();if(a>250){return checkIOFalse2()}}}return checkIO()}function checkIOFalse(a){return false}function checkIOFalse2(){m_checkIOFalseCounter++;if(m_checkIOFalseCounter>=5){resetCheckIO()}return false}function checkIOTrue(){m_checkIOFalseCounter=0;return true}function resetCheckIO(){parent.m_blockIOByFlush=false;parent.m_blockIO=false;m_checkIOFalseCounter=0}function addFocusable(b,a){if(parent.m_roi_firstusage==false){return}m_focusables.push(b);m_focusablesCat.push(a)}var m_currentFocusLine;var m_currentFocusGrid;function startFocusGrid(g){try{var d=m_currentFocusGrid[0];var c=m_currentFocusGrid[1];var f=d.length-c.length;var b=[];for(var e=0;e<c.length;e++){b.push(d[e+f])}m_currentFocusGrid[0]=b;g.CASA_fg=m_currentFocusGrid;m_currentFocusGrid=null}catch(a){}}function startFocusLine(){if(m_currentFocusGrid==null){m_currentFocusGrid=[]}m_currentFocusGrid.push(m_currentFocusLine);m_currentFocusLine=null}function startFocusCell(a){if(m_currentFocusLine==null){m_currentFocusLine=[]}m_currentFocusLine.push(a)}function buildLineCells(e){var b=[];for(var d=0;d<e.length;d++){var a=e[d];var f=a.CASA_fgsubs;if(f==null){b.push(a)}else{for(var c=0;c<f.length;c++){b.push(f[c])}}}return b}function findFocusControl(g,f,a){var b=g.CASA_fg;if(b==null){return -1}if(b.length==0){return -1}for(var h=0;h<b.length;h++){var d=b[h];d=buildLineCells(d);for(var c=0;c<d.length;c++){if(d[c]==f){try{var k=h+a;if(a==1000){k=0}if(a==1001){k=b.length-1}var e=b[k];e=buildLineCells(e);var j=e[c];return j}catch(l){return 0}}}}return -1}function findFirstFocusControl(c){var a=c.CASA_fg;if(a==null){return null}if(a.length==0){return null}var b=buildLineCells(a[0]);return b[0]}function findLastFocusControl(c){var a=c.CASA_fg;if(a==null){return null}if(a.length==0){return null}var b=buildLineCells(a[a.length-1]);return b[b.length-1]}function findIndexOfLastTabableFocusLine(f){var d=f.CASA_fg;if(d==null){return null}if(d.length==0){return null}var b=-1;for(var c=0;c<d.length;c++){var e=d[c];e=buildLineCells(e);for(var a=0;a<e.length;a++){if(e[a].tabIndex>=0&&e[a].readOnly!=true&&e[a].disabled!=true){b=c;break}}}return b}function findFocusControlXY(g,e){var d=g.CASA_fg;if(d==null){return null}if(d.length==0){return null}for(var c=0;c<d.length;c++){var f=d[c];f=buildLineCells(f);for(var a=0;a<f.length;a++){if(f[a]==e){var b=new Object();b.X=a;b.Y=c;return b}}}return null}function findFocusControlForXY(e,d,b){var a=e.CASA_fg;if(a==null){return null}if(a.length==0){return null}var c=a[b];c=buildLineCells(c);return c[d]}function repointFocusInScreenExecute(){m_firstFocusCall=true;pointFocusInternally(false)}function repointFocus(){m_firstFocusCall=true;pointFocusInternally(true)}function pointFocus(){if(m_focusTimeout==null){pointFocusInternally(true)}m_focusTimeout=null}function isSuppressFocus(){var a=getPropertyValue("cISAddons.suppressFocusManagement");return((a==true||a=="true"))}function pointFocusInternally(a){addLogMessage("FOCUS - pointFocus started");var c=getPropertyValue("cISAddons.suppressFocusManagement");if(a&&(c==true||c=="true")){addLogMessage("FOCUS - Adapter suppressed focus management");return}if(m_suppressFocusManagementOncePAGE==true){m_suppressFocusManagementOncePAGE=null;addLogMessage("FOCUS - Flas suppressFocusManagementOncePAGE suppressed focus management");return}var b=false;try{addLogMessage("pointFocus - pointFocusToFirstRequestor");b=pointFocusToFirstRequestor()}catch(d){}if(b==true){m_firstFocusCall=false;return}if(b==false&&m_firstFocusCall==false){try{if(pointFocusAfterIP){pointFocusAfterIP()}}catch(e){}return}m_firstFocusCall=false;addLogMessage("FOCUS - No explicit focus set by application, normal focus selection started");pointFocusForFreshPage()}function pointFocusForFreshPage(){var b=getPropertyValue("cISAddons.suppressFocusManagement");if(b==true||b=="true"){addLogMessage("FOCUS - Adapter suppressed focus management");return}for(var c=0;c<2;c++){if(c==1){vfirstcat=false}for(var d=0;d<m_focusables.length;d++){if(c==0&&m_focusablesCat[d]!=true){continue}var g=m_focusables[d];if(g.disabled!=true&&g.tabIndex>=0){try{addLogMessage("FOCUS - Setting focus in focusable "+d+" ==> "+g.tagName);g.focus();if(g.offsetWidth==0){throw ("set focus not succeessfull")}if(g.CASA_alwaysflush!="true"){if(parent.m_flushMethodPAGE==null){parent.focus()}g.focus()}return}catch(a){addLogMessage("FOCUS - Execption occurred in focusable "+d+": "+a)}}}}try{parent.gebid("THISBODY").focus()}catch(f){}}function pointFocusToFirstRequestor(){if(m_focusRequestors==null){return false}addLogMessage("FOCUS - pointFocusToFirstRequestor started, number of focus requestors = "+m_focusRequestors.length);if(m_focusRequestors.length==1){try{var e=m_focusRequestors[0];if(e.setActiveOnly!=true){e.control.focus();if(e.control.CASA_alwaysflush!="true"){if(parent.m_flushMethodPAGE==null){parent.focus()}e.control.focus()}try{e.control.select()}catch(c){}}else{if((e.control.type=="textarea")||(e.control.type=="text")){setSelectionRange(e.control,0,0)}}try{if(e.control.setActive){e.control.setActive()}}catch(c){}m_focusRequestors=null;addLogMessage("FOCUS - Did set focus to first requestor");return true}catch(b){m_focusRequestors=null;addLogMessage("FOCUS - Exception occurred "+b);return false}}var d=m_focusRequestors.length;for(var a=0;a<d;a++){try{var e=m_focusRequestors[a];if(e.control.focus!=null){if(e.setActiveOnly!=true){e.control.focus();if(e.control.offsetWidth==0){throw ("set focus not succeessfull")}if(e.control.CASA_alwaysflush!="true"){if(parent.m_flushMethodPAGE==null){parent.focus()}e.control.focus()}try{e.control.select()}catch(c){}}else{if((e.control.type=="textarea")||(e.control.type=="text")){setSelectionRange(e.control,0,0)}}try{if(e.control.setActive){e.control.setActive()}}catch(c){}m_focusRequestors=null;addLogMessage("FOCUS - Did set focus to requestor "+a);return true}else{addLogMessage("FOCUS - Focus requestor does not support focus() "+a)}}catch(b){addLogMessage("FOCUS - Could not set focus for requestor "+a+": "+b)}}m_focusRequestors=null;return false}function setSelectionRange(b,c,d){if(b.setSelectionRange){b.focus();b.setSelectionRange(c,d)}else{if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.moveEnd("character",d);a.moveStart("character",c);a.select()}}}function addFocusRequestorInternal(c,b){if(m_newModelForAddFocusRequestor){clearFocusRequestor();m_newModelForAddFocusRequestor=false}if(m_focusRequestors==null){m_focusRequestors=[]}var a=new Object();a.control=c;a.setActiveOnly=b;m_focusRequestors[m_focusRequestors.length]=a}function addFocusRequestor(a){addFocusRequestorInternal(a,false)}function clearFocusRequestor(){m_focusRequestors=null}function addActiveElementRequestor(a){addFocusRequestorInternal(a,true)}function applyCasaTabIndex(b,a){applyCasaTabIndexFor(b,b,a)}function disableCasaTabIndexFor(c,a,b){applyCasaTabIndexFor(c,a,b);a.tabIndex=-1}function applyCasaTabIndexFor(c,a,b){if(c.CASA_cti==null){c.CASA_cti=1}a.tabIndex=c.CASA_cti;if(c.CASA_tabindex==null){c.CASA_tabindex="-"}if(m_tabElements.LOGCOUNT==null){m_tabElements.LOGCOUNT=0}if(m_tabElements.LOGCOUNT>100){return}m_tabElements.LOGCOUNT+=1;a.CASA_tabIndexInfo=b;a.CASA_tabindex=c.CASA_tabindex;a.CASA_cti=c.CASA_cti;if(c.CASA_cti>1){m_tabElements[c.CASA_cti]=a}else{m_tabElementsUndefined[a.id]=a}}function addAreaTabIndexInfo(e,a,c,b){var d=new Object();d.CASA_cti=c;d.CASA_tabindex=b;d.CASA_valueprop=a;d.id=e;applyCasaTabIndex(d,"ROWAREA")}function addHotKey(d,e,a,c,f){var b=new Object();b.keyCode=d;b.ctrlKey=e;b.shiftKey=a;b.altKey=c;b.method=f;m_hotKeys.push(b)}function addControlBasedHotKey(a,e,b,c){var d=new Object();d.ccId=a;d.keyCode=e;d.ctrlKey=m_hotKeyCode.indexOf("17")>=0;d.shiftKey=m_hotKeyCode.indexOf("16")>=0;d.altKey=m_hotKeyCode.indexOf("18")>=0;d.callbackMethod=b;d.callbackParam=c;m_hotKeysWithCallback.push(d)}function addHotKeyWithControlScope(e,f,b,d,g,a){var c=new Object();c.keyCode=e;c.ctrlKey=f;c.shiftKey=b;c.altKey=d;c.method=g;c.controlInfo=a;m_hotKeysWithControlScope.push(c)}function removeHotKeys(a){v=[];for(var b=0;b<m_hotKeysWithCallback.length;b++){if(m_hotKeysWithCallback[b].ccId!=a){v.push(m_hotKeysWithCallback[b])}}m_hotKeysWithCallback=v}var mm_processHotKeys=null;function processHotKeys(a){if(mm_processHotKeys==null){mm_processHotKeys=CL().C_processHotKeys}return mm_processHotKeys.call(this,a)}var mm_changeReturnToTab=null;function changeReturnToTab(a){if(mm_changeReturnToTab==null){mm_changeReturnToTab=CL().C_changeReturnToTab}return mm_changeReturnToTab.call(this,a)}var mm_focusNextInput=null;function focusNextInput(a){if(mm_focusNextInput==null){mm_focusNextInput=CL().C_focusNextInput}return mm_focusNextInput.call(this,a)}var mm_focusNextTabInput=null;function focusNextTabInput(a){if(mm_focusNextTabInput==null){mm_focusNextTabInput=CL().C_focusNextTabInput}return mm_focusNextTabInput.call(this,a)}function avoidProcessingForNextHotKey(){m_noProcessingForNextHotKey=true}function findHotkeyKeycode(b){if(b==null){return null}var a=b.indexOf("~~");if(a>=0&&a!=b.length-2){var d=b.charCodeAt(b.indexOf("~~")+2);if(d>=97){d-=32}return d}return null}function decodeCSVStringEMPTY(b){if(b==""){var a=[];a[0]="";return a}else{return decodeCSVString(b)}}var s_bufferCSV=[];function decodeCSVStringUsingBuffer(b){var a=s_bufferCSV[b];if(a!=null){return a}a=decodeCSVString(b);s_bufferCSV[b]=a;return a}function decodeCSVString(a){return decodeString(a,";")}function decodeString(c,f){var a=[];if((c==null)||(c=="")){return a}var d=0;var b=c.indexOf(f);var e="";while(b>=0){if((b==0)||(c.charAt(b-1)!="\\")){e=e+c.substring(d,b);a[a.length]=e;e=""}else{e=e+c.substring(d,b-1)+f}d=b+1;b=c.indexOf(f,b+1)}a[a.length]=e+c.substring(d,c.length);return a}function addClickAwayObject(a){m_clickAwayObjects[m_clickAwayObjects.length]=a}function addClickAwayMethod(a){m_clickAwayMethods.push(a)}function avoidClickAway(){m_avoidClickAway=true}function clickAway(){if(m_avoidClickAway==false){for(var a=0;a<m_clickAwayObjects.length;a++){if(m_clickAwayObjects[a].CASA_callbackcc!=null&&m_clickAwayObjects[a].CASA_callbackcc.CASA_hasValidationError==true){continue}m_clickAwayObjects[a].style.display="none"}for(var a=0;a<m_clickAwayMethods.length;a++){m_clickAwayMethods[a]()}try{if(CL().m_MPADIVOwnerFrame!=null&&CL().m_MPADIVOwnerFrame!=this){CL().m_MPADIVOwnerFrame.clickAway()}}catch(b){}}m_avoidClickAway=false}function addHeaderObject(a){if(parent.m_roi_firstusage==false){return}m_headerObjects.push(a)}function addFooterObject(a){if(parent.m_roi_firstusage==false){return}m_footerObjects.push(a)}function calculateHeaderHeight(){var a=0;for(var b=0;b<m_headerObjects.length;b++){a+=m_headerObjects[b].offsetHeight}return a}function calculateFooterHeight(){var a=0;for(var b=0;b<m_footerObjects.length;b++){a+=m_footerObjects[b].offsetHeight}return a}function addMLValue(a){if(parent.m_roi_firstusage==false){return}if(a!=null){m_MLValues.push(a)}}function addMLTextNode(a){if(parent.m_roi_firstusage==false){return}if(a!=null){m_MLTextNodes.push(a)}}function addMLSpan(a){if(parent.m_roi_firstusage==false){return}if(a!=null){m_MLSpans.push(a)}}function addMLOption(a){if(parent.m_roi_firstusage==false){return}if(a!=null){m_MLOptions.push(a)}}function addMLImage(a){if(parent.m_roi_firstusage==false){return}if(a!=null){m_MLImages.push(a)}}function addMLButton(a,b,c){if(parent.m_roi_firstusage==false){return}if(a!=null){o=new Object();o.input=a;o.callbackMethod=b;o.callbackParam=c;m_MLButtons.push(o)}}function addMLTab(c,a,b){if(parent.m_roi_firstusage==false){return}if(c!=null){o=new Object();o.span=c;o.callbackMethod=a;o.callbackParam=b;m_MLTabs.push(o)}}function doReplaceValue(a){if(a.charAt(0)!="$"){return null}var b=getPropertyValue(a);if(b==null||b==""){return null}return convertDoubleTildeToUTag(b)}function replaceTextIds(){var a=0;var l=m_MLValues;a=l.length;for(var b=0;b<a;b++){var c=null;if(l[b].value==undefined){c=doReplaceValue(l[b].textContent);if(c!=null){l[b].innerHTML=l[b].innerHTML.replace(l[b].textContent,c)}}else{c=doReplaceValue(l[b].value);if(c!=null){l[b].value=c}}}var e=m_MLSpans;a=e.length;for(var b=0;b<a;b++){if(e[b].id.charAt(0)=="$"){var r=getPropertyValue(e[b].innerHTML);if(r==null){continue}if(r==""){continue}e[b].innerHTML=convertDoubleTildeToUTag(r)}}var d=m_MLTextNodes;a=d.length;for(var b=0;b<a;b++){var s=doReplaceValue(d[b].nodeValue);if(s!=null){d[b].nodeValue=s}}var h=m_MLTabs;a=h.length;for(var b=0;b<a;b++){if(h[b].span.id.charAt(0)=="$"){var r=getPropertyValue(h[b].span.innerHTML);if(r==null){continue}if(r==""){continue}var n=findHotkeyKeycode(r);if(n!=null){addControlBasedHotKey(h[b].span.id,n,h[b].callbackMethod,h[b].callbackParam)}h[b].span.innerHTML=convertDoubleTildeToUTag(r)}}buttons=m_MLButtons;a=buttons.length;for(var b=0;b<a;b++){var q=buttons[b].input.innerHTML;var k=q.indexOf("$1$");var j=q.indexOf("$2$");if(k>=0&&j>k){var g=q.substring(0,k);var m=q.substring(k+3,j);var r=getPropertyValue("$"+m);if(r==null){continue}if(r==""){continue}var n=findHotkeyKeycode(r);if(n!=null){addControlBasedHotKey(buttons[b].input.id,n,buttons[b].callbackMethod,buttons[b].callbackParam)}if(r!=null){g+=convertDoubleTildeToUTag(r)}g+=q.substring(j+3,q.length);buttons[b].input.innerHTML=g}}var p=m_MLOptions;a=p.length;for(var b=0;b<a;b++){if(p[b].text!=null&&p[b].text.charAt(0)=="$"){var r=getPropertyValue(p[b].text);if(r==null){continue}if(r==""){continue}p[b].text=r}}var f=m_MLImages;a=f.length;for(var b=0;b<a;b++){if(f[b].title!=null&&f[b].title.charAt(0)=="$"){var r=getPropertyValue(f[b].title);if(r==null){continue}if(r==""){continue}f[b].title=r}}}var mm_refreshOccuranceOfAdapter=null;function refreshOccuranceOfAdapter(a){if(mm_refreshOccuranceOfAdapter==null){mm_refreshOccuranceOfAdapter=CL().C_refreshOccuranceOfAdapter}return mm_refreshOccuranceOfAdapter(a,this)}function enqueueRefreshOccuranceOfAdapter(a){try{CL().m_refreshOccuranceQueue.push(a)}catch(b){}}function flushRefreshOccuranceQueue(){try{var b=CL().m_refreshOccuranceQueue;for(var a=0;a<b.length;a++){refreshOccuranceOfAdapter(b[a])}CL().m_refreshOccuranceQueue=[]}catch(c){}}var mm_repointFocusInScreen=null;function repointFocusInScreen(a){if(mm_repointFocusInScreen==null){mm_repointFocusInScreen=CL().C_repointFocusInScreen}return mm_repointFocusInScreen(a)}var mm_setURLInTarget=null;function setURLInTarget(a,b){if(mm_setURLInTarget==null){mm_setURLInTarget=CL().C_setURLInTarget}return mm_setURLInTarget.call(this,a,b)}var mm_callMethodInTarget=null;function callMethodInTarget(a,b){if(mm_callMethodInTarget==null){mm_callMethodInTarget=CL().C_callMethodInTarget}return mm_callMethodInTarget.call(this,a,b)}var mm_findParameterInQuery=null;function findParameterInQuery(a,b){if(mm_findParameterInQuery==null){mm_findParameterInQuery=CL().C_findParameterInQuery}return mm_findParameterInQuery(a,b)}var mm_sizeTarget=null;function sizeTarget(b,a){if(mm_sizeTarget==null){mm_sizeTarget=CL().C_sizeTarget}return mm_sizeTarget(b,a)}function initAlreadyLoadedPage(){}function initWithModelIdAndSessionIdAndProcessId(e,g,c,a){addLogMessage("initWithModelId... - started");m_pageInactive=false;if(parent.m_roi_firstusage!=false){for(var d=0;d<m_modelListenersLast.length;d++){m_modelListeners.push(m_modelListenersLast[d])}m_modelListenersLast=[]}if(parent.m_roi_firstusage){var h=m_parentparent.m_cisversion;for(var d=0;d<m_jsversions.length;d++){var b=m_jsversions[d];if(b!=h){alert("VERSIONING PROBLEM\n\nThe file "+m_jsfiles[d]+" is version "+b+". The server's version is "+h+".\nLayout definitions need to be regenerated.")}}}passPagePixelSize(-1,-1);passTimeZoneOffset();m_modelName=e;m_sessionId=c;m_processId=a;m_modelId=g;vPageInitParam=m_parentparent.pageInitParam;if(vPageInitParam!=null){setPropertyValue("pageInitParam",vPageInitParam);cscformiframe.document.getElementById("PAGEINITPARAM").value=vPageInitParam;m_parentparent.pageInitParam=null}if(m_parentparent.CasaSessionSTYLESHEET!=null&&m_parentparent.CasaSessionSTYLESHEET!=""){setPropertyValue("style",m_parentparent.CasaSessionSTYLESHEET)}try{if(m_parentparent.m_previousWORKAREA==null||m_parentparent.m_previousWORKAREA.m_withownborder!=parent.m_withownborder){setWithOwnBorder(parent.m_withownborder)}}catch(j){}var f=buildFirstTag("i","")+buildXMLFromModel("initWithModelIdAndSessionIdAndProcessId");if(m_doLog){addLogMessage("initWithModelId... - submitting")}if(m_parentparent.isPopupPage==true){CL().C_registerPopupPage(m_parentparent,true);try{m_parentparent.focus()}catch(j){}}fetchModelFromServer(f);m_parentparent.pageInitParam=null}function setWithOwnBorder(a){var c="visible";if(a=="false"){c="hidden"}var b=m_parentparent.document.getElementById("SCPRowHeader");if(b==null){return}b.style.visibility=c;b=m_parentparent.document.getElementById("SCPCellIFrameLeft");b.style.visibility=c;b=m_parentparent.document.getElementById("SCPCellIFrameRight");b.style.visibility=c;b=m_parentparent.document.getElementById("SCPRowFooter");b.style.visibility=c}function findPseudoURL(){var c=parent.location.href;var b=c.lastIndexOf("/");var a=c.substring(b,c.length);c=c.substring(0,b);b=c.lastIndexOf("/");a=c.substring(b,c.length)+a;return a}var m_lastServerFetch;function fetchModelFromServer(e){m_bufferedxml=null;var d=null;try{if(CL()!=null){d=CL().buildBufferAccesKey(m_sessionId,m_processId,m_modelId,m_modelName,findPseudoURL());m_bufferedxml=CL().findBufferedAdapterStream(d)}}catch(b){m_bufferedxml=null}if(m_cscformOccupied==true){if(m_doLog){addLogMessage("fetchModelFromServer - Try again in 20 ms")}setTimeout('fetchModelFromServer("'+e+'")',20);return}m_lastServerFetch=new Date();if(m_bufferedxml==null){if(m_doLog){addLogMessage("fetchModelFromServer - Model is fetched from server")}m_cscformOccupied=true;var a=true;if((parent.m_usexmlhttprequest=="true")||(parent.m_usexmlhttprequest=="mozilla")||(m_parentparent.m_usexmlhttprequest=="true")||(m_parentparent.m_usexmlhttprequest=="mozilla")){a=false}if(a==true){cscformiframe.document.getElementById("SESSIONID").value=m_sessionId;cscformiframe.document.getElementById("XML").value=e;try{cscformiframe.submitPost()}catch(c){m_cscformOccupied=false;return}if(m_doLog){addLogMessage("fetchModelFromServer - Submit executed")}}else{executeXMLHTTTPPost(e)}}else{if(m_doLog){addLogMessage("fetchModelFromServer - Model is available in central library")}CL().clearBufferedAdapterStream(d);reactOnNewModel(true)}}function createXMLHttpRequest(){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}try{return new XMLHttpRequest()}catch(a){}alert("XMLHttpRequest not supported");return null}function continueInit(a,d,c,b){setTimeout("initWithModelIdAndSessionIdAndProcessId('"+a+"','"+d+"','"+c+"','"+b+"')",30)}function doMozResize(a){if(m_doLog){addLogMessage("doMozResize - calling reactOnResize()")}parent.reactOnResize()}function reactOnNewModel(ab,W){m_callcounter++;CL();if(CL()==null){return}if(ab==null||ab==false){if(m_processCasabacSynchronizeIfNecessary!=true&&m_processInvokeMethodInModel==true){if(CL()!=null&&m_suppressClearAdapterStream!=true){CL().clearBufferedAdapterStreams(parent.location.href+" in reactOnNewModel")}}}m_newModelForAddFocusRequestor=true;m_processInvokeMethodInModel=false;m_beforeFirstReactOnNewModel=false;m_bufferNeedsRefresh=false;m_resetValiddationErrorsAndFlush=false;if(m_doLog){addLogMessage("reactOnNewModel - started")}var O=new Date();var aa=true;var q=null;if(m_continueMethod!=null){try{var S=m_continueMethod;m_continueMethod=null;S()}catch(L){}}if(W==null){var w=cscformiframe.document.getElementById("ERRORMESSAGE");if(w!=null){q=w.value}}else{q=W.error}if(q!=null&&q!=""){if(m_doLog){addLogMessage("reactOnNewModel - error message was passed from server")}if((q.indexOf("(1)")>=0&&q.indexOf("(2)")>=0&&q.indexOf("(3)")>=0)||(q.indexOf("Session was already removed")>=0)){window.top.location.href="../servlet/StartMessagePage?TYPE=SESSIONTIMEOUT";status="";return}else{if(q.indexOf("ProcessNotAvailableError")>=0){try{addLogMessage("reactOnNewModel - Suppressed ProcessNotAvailableError");switchToDisplayPAGE()}catch(L){}status="";return}else{if(q.indexOf("MAXIMUM NUMBER OF PARALLEL SESSIONS WAS REACHED.")>=0){parent.location.href="../HTMLBasedGUI/general/toomanysessions.html";alert("Number of parallel sessions is reached.");return}else{alert("ERROR IN APPLICATION:\n\n"+q);switchToDisplayPAGE();status="";return}}}}var e=cscformiframe.document.getElementById("STAMP").value;if(m_lastStamp!=undefined&&m_lastStamp!="INIT"&&e!=undefined&&e!="INIT"){var p=m_lastStamp*(-1)*(-1);var l=e*(-1)*(-1);if(p>l){if(getPropertyValue("cISAddons.reloadpageonbackbutton")=="true"){alert("Warning - Your session is no longer synchronized with the server. This is the result of one of the following\n\n(1) Most Likely Cause - You have used your browsers back button - which is not permitted in order to keep the application session consistent.\n(2) Your Server has been restarted - please contact your System Administrator for more information.\n(3) There is a error in your server configuration - please contact your System Administrator if this message persists.\n\nAfter pressing 'Ok' your session will be synchronized with the server.");parentLocationReload()}else{window.top.location.replace("../servlet/StartMessagePage?TYPE=BACKBUTTONPRESSED")}status="";return}}m_lastStamp=e;try{if(unloadINTPOPUP){unloadINTPOPUP()}}catch(U){}var F=null;if(W!=null){F=W.xml;if(F.indexOf(m_cre1)>=0){F=F.replace(m_re1,"\b")}if(F.indexOf(m_cre2)>=0){F=F.replace(m_re2,"\t")}if(F.indexOf(m_cre3)>=0){F=F.replace(m_re3,"\n")}if(F.indexOf(m_cre4)>=0){F=F.replace(m_re4,"\f")}if(F.indexOf(m_cre5)>=0){F=F.replace(m_re5,"\r")}if(F.indexOf(m_cre6)>=0){F=F.replace(m_re6,"&")}if(F.indexOf(m_cre35)>=0){F=F.replace(m_re35,"<")}if(F.indexOf(m_cre36)>=0){F=F.replace(m_re36,">")}if(m_doLog){addLogMessage("reactOnNewModel - convert special characters - end")}}else{if(ab==null||ab==false){if(m_doLog){addLogMessage("reactOnNewModel - convert special characters - start")}F=cscformiframe.document.getElementById("XML").value;if(F.indexOf(m_cre1)>=0){F=F.replace(m_re1,"\b")}if(F.indexOf(m_cre2)>=0){F=F.replace(m_re2,"\t")}if(F.indexOf(m_cre3)>=0){F=F.replace(m_re3,"\n")}if(F.indexOf(m_cre4)>=0){F=F.replace(m_re4,"\f")}if(F.indexOf(m_cre5)>=0){F=F.replace(m_re5,"\r")}if(F.indexOf(m_cre6)>=0){F=F.replace(m_re6,"&")}if(F.indexOf(m_cre35)>=0){F=F.replace(m_re35,"<")}if(F.indexOf(m_cre36)>=0){F=F.replace(m_re36,">")}if(m_doLog){addLogMessage("reactOnNewModel - convert special characters - end")}}else{F=m_bufferedxml;m_bufferedxml=null}}m_cscformOccupied=false;if(F==null||F.length==0){switchToDisplayPAGE();status="";return}if(m_doLog){addLogMessage("reactOnNewModel - transfer model into datastructure - start")}var C=transferXMLIntoModel(F);if(m_doLog){addLogMessage("reactOnNewModel - transfer model into datastructure - end")}if(C==true){if(m_doLog){addLogMessage("reactOnNewModel - transfer model into datastructure - have found an unsupported char! \n XML: "+F)}switchToDisplayPAGE();status="";return}var y;y=getPropertyValue("dateDisplay");if(y!=null&&y!=""){m_dateDisplay=y}y=getPropertyValue("fdiw");if(y!=null&&y!=""){m_americanStyle=y}y=getPropertyValue("timeDisplay");if(y!=null&&y!=""){m_timeDisplay=y}y=getPropertyValue("decimalSeparator");if(y!=null&&y!=""){m_decimalSeparator=y}m_1000Separator=getPropertyValue("cISAddons.suppress1000Sep");y=getPropertyValue("language");if(y!=null&&y!=""){m_language=y}y=getPropertyValue("hotKeyCode");if(y!=null&&y!=""){m_hotKeyCode=y}y=getPropertyValue("cISAddons.dir");if(y!=null&&y!=""){m_direction=y}if(m_firstModel==true){if(m_doLog){addLogMessage("reactOnNewModel - fill textid spans - start")}parent.fillTextIdSpans();if(m_doLog){addLogMessage("reactOnNewModel - fill textid spans - end")}}var I=getPropertyValue("style");parent.parent.CasaSTYLESHEET=I;if(I!=null&&I!=""&&m_parentparent.CasaSessionSTYLESHEET!=null){m_parentparent.CasaSessionSTYLESHEET=I}var f=m_parentdocument.getElementById("casabacstylesheet");if(parent.CASAstylesheetfile==null&&m_parentparent.CasaSTYLESHEET!=null&&m_parentparent.CasaSTYLESHEET!=""){if(f.href.substring(0,4)!="http"){if(f.href!=m_parentparent.CasaSTYLESHEET){f.href=m_parentparent.CasaSTYLESHEET}}else{hrefSheetName=f.href;if(f.href.lastIndexOf("/")>0){hrefSheetName=f.href.substring(f.href.lastIndexOf("/")-0+1,f.href.length)}ppSheetName=m_parentparent.CasaSTYLESHEET;if(ppSheetName.lastIndexOf("/")>0){ppSheetName=ppSheetName.substring(ppSheetName.lastIndexOf("/")-0+1,ppSheetName.length)}if(hrefSheetName!=ppSheetName){f.href=m_parentparent.CasaSTYLESHEET}}}executeFormulas();var h=getPropertyValue("cISAddons.ulb");if(h!=null){m_parentparent.updateULB(h)}try{var R=getPropertyValue("cISAddons.noControlUpdate");if(R!="true"){if(m_doLog){addLogMessage("reactOnNewModel - informing listeners")}updateModelListeners(F);var u=getPropertyValue("cISAddons.browserTitle");if(m_parentparent.isPopupPage==true){u=CL().C_formatPopupTitle(u)}if(u!=null&&u.length>0){try{top.document.title=u}catch(A){}}var N=getPropertyValue("messageType");var k=getPropertyValue("messageShortText");CL().C_outputMessageSSW(m_parentparent.getCurrentSessionId(),m_parentparent.getCurrentProcessId(),N,k);if(getPropertyValue("cISAddons.cisA1")!="false"){CL().romuSB(this,k,N)}}else{reactOnModelUpdatePAGE();if(m_doLog){addLogMessage("reactOnNewModel - SKIPPING informing listeners - cisAddons.noControlUpdate is set")}}if(m_doLog){addLogMessage("reactOnNewModel - informing listeners - finished")}var K=new Date();try{if(getPropertyValue("cISAddons.lops")!="true"){switchToDisplayPAGE()}}catch(L){addLogMessage("Error when switching to display occurred");addLogMessage("This error normally happens when back is pressed in the browser");alert("Reloading page, reason (most likely): back-button pressed in browser");parentLocationReload()}var Q=new Date();if(parent.m_perfPageLoadEnd==null){parent.m_perfPageLoadEnd=Q}if(m_doLog){addLogMessage("reactOnNewModel - Duration of switchToDisplay = "+(Q.getTime()-K.getTime()))}if(R!="true"){upateSwitchToDisplayListerners(F);doMozResize(F)}status="";var x=getPropertyValue("nextPopup");var s=getPropertyValue("nextPopupId");var r=getPropertyValue("nextPopupModal");var z=getPropertyValue("nextPopupFeatures");var H=getPropertyValue("nextPopupTitle");var M=x!=null&&x!="null"&&x!="";if(M){CL().reactOnOpenPopupCL(this);if(s==null){s=""}var a=getPropertyValue("nextPopupSessionId");var D=getPropertyValue("nextPopupSubsessionId");var Z=getPropertyValue("nextPopupOnCloseMethod");var E=getPropertyValue("nextPopupOnCloseProperty");var t=getPropertyValue("nextPopupOnClosePropertyValue");openPopupPAGE(x,s,r,z,H,a,D,Z,E,t)}var g=getPropertyValue("cISAddons.favName");if(g!=null&&g!=""){var d=getPropertyValue("cISAddons.favURL");try{if(window.sidebar){window.sidebar.addPanel(g,d,"")}else{alert("Adding Favorites is not supported by your browser.")}}catch(c){alert('Error when calling the "Add To Favorites..."-Popup with...\nTitle = '+g+"\nURL = "+d+"\n"+c.message)}}try{var n=0;while(true){var P=getPropertyValue("frameMessages["+n+"].frameURL");var B=getPropertyValue("frameMessages["+n+"].frameTarget");var m=getPropertyValue("frameMessages["+n+"].frameMethod");if(B==null){break}if(m_doLog){addLogMessage("reactOnNewModel - frame communication "+B+"/"+m+"/"+P)}if(m=="FRAMERESIZE"){sizeTarget(B,P)}else{if(B!=null&&(B.substring(0,8)=="CASAOCC;"||B.substring(0,8)=="CASASWI;")){if(m_parentparent.isPopupPage){enqueueRefreshOccuranceOfAdapter(B)}else{refreshOccuranceOfAdapter(B)}}else{if(B!=null&&B.substring(0,8)=="CASAFOC;"){repointFocusInScreen(B)}else{if(P!=null&&P!=""){setURLInTarget(P,B)}else{if(m!=null&&m!=""){callMethodInTarget(m,B)}}}}}n++}var P=getPropertyValue("frameURL");var B=getPropertyValue("frameTarget");if(P!=null&&P!=""&&B!=null&&B!=""){setURLInTarget(P,B)}}catch(L){}try{if(m_focusSETIN==null){}}catch(Y){m_focusSETIN=undefined}try{var j=getPropertyValue("refreshParent");if(j!=null&&j=="true"){if(m_parentparent!=null&&m_parentparent.parent!=null&&m_parentparent.parent.csciframe!=null){switchToDisplayPAGE();try{if(m_focusSETIN==null){m_parentparent.parent.csciframe.m_focusSETIN=self}else{m_parentparent.parent.csciframe.m_focusSETIN=m_focusSETIN;m_focusSETIN=undefined}}catch(Y){m_focusSETIN=undefined}m_parentparent.parent.m_blockIOByFlush=true;m_parentparent.parent.csciframe.submitModel("submit");status="";return}if(m_parentparent!=null&&m_parentparent.parent!=null&&m_parentparent.parent.m_isCasabacMFPAGE==true&&m_parentparent.parent.parent!=null&&m_parentparent.parent.parent.parent!=null&&m_parentparent.parent.parent.parent.csciframe!=null){switchToDisplayPAGE();try{if(m_focusSETIN==null){m_parentparent.parent.parent.parent.csciframe.m_focusSETIN=self}else{m_parentparent.parent.parent.parent.csciframe.m_focusSETIN=m_focusSETIN;m_focusSETIN=undefined}}catch(Y){m_focusSETIN=undefined}m_parentparent.parent.parent.parent.csciframe.submitModel("submit");status="";return}if(parent!=null&&m_parentparent!=null&&m_parentparent.leaveToPage!=null){switchToDisplayPAGE();m_parentparent.window.location.href=m_parentparent.leaveToPage;status="";return}if(CL().CASA_popupopenersvalues!=null&&CL().CASA_popupopenersvalues.length>0&&CL().CASA_popupopenersvalues[CL().CASA_popupopenersvalues.length-1].csciframe!=null){var b=CL().CASA_popupopenersvalues[CL().CASA_popupopenersvalues.length-1].csciframe;switchToDisplayPAGE();try{if(m_focusSETIN==null){b.m_focusSETIN=self}else{b.m_focusSETIN=m_focusSETIN;m_focusSETIN=undefined}}catch(V){m_focusSETIN=undefined;b.m_focusSETIN=self}b.m_blockIOByFlush=true;if(b.parent){b.parent.m_blockIOByFlush=true}b.submitModel("submit");status="";return}if(parent!=null&&m_parentparent!=null){if(!(m_parentparent.isPopupPage==true||m_parentparent.isPopupPage=="true")){switchToDisplayPAGE();m_parentparent.window.location.href="../../HTMLBasedGUI/general/aboutBlank.html";status="";return}else{}}}}catch(L){m_firstModel=false}m_firstModel=false;var X=getPropertyValue("forcePageReload");if(X=="true"){setPropertyValue("forcePageReload",false,true);CL().clearBufferedAdapterStream(CL().buildBufferAccesKey(m_sessionId,m_processId,m_modelId,m_modelName,findPseudoURL()));parentLocationReload()}if(!M){if(m_doLog){addLogMessage("reactOnNewModel - Setting focus")}var J=0;if(m_resizeTimeout==null&&m_focusTimeout==null){J=10}else{if(m_focusTimeout==null){J=200}}if(J>0){parent.window.requestAnimationFrame(this.doSetFocus)}}var G=new Date();if(M&&parent.m_perfPageFocusEnd==null){parent.m_perfPageFocusEnd=G}if(m_doLog){addLogMessage("reactOnNewModel - Duration of client update = "+(G.getTime()-O.getTime()))}if(m_doLog){addLogMessage("reactOnNewModel - finished")}}catch(T){if(m_doLog){addLogMessage("reactOnNewModel - exception caught"+T)}}}function doSetFocus(c){pointFocus();try{if(m_focusSETIN==null){if(parent.m_perfPageFocusEnd==null){parent.m_perfPageFocusEnd=new Date()}status=""}else{try{m_focusSETIN.pointFocus()}catch(b){}m_focusSETIN=undefined;status=""}}catch(a){m_focusSETIN=undefined}}function executeFormulas(b){try{executeFORMULA(b)}catch(a){}}function getSCPBufferPriortity(){return getPropertyValue("cISAddons.scpBufferPriority")}function parentLocationReload(){var a=parent.location.href;parent.location.replace(a)}function updateModelListenersS(){updateModelListeners(null);m_focusRequestors=null}function updateModelListenersScroll(a){for(var b=0;b<m_modelListenersSCROLL.length;b++){m_modelListenersSCROLL[b](a)}}function updateModelListeners(c){m_continueUpdateModelListeners=true;addLogMessage("updateModelListeners - processing statusproplisteners");for(var a in m_statuspropListeners){try{var k=getPropertyValue(a);if(k=="ERROR"||k=="FOCUS"||k=="FOCUS_NO_SELECT"){vls=m_statuspropListeners[a];for(iiii=0;iiii<vls.length;iiii++){if(vls[iiii].CASA_displayprop!=null){var f=getPropertyValue(vls[iiii].CASA_displayprop);k=applyDisplayProperty(f,k)}if(k=="ERROR"||k=="FOCUS"){addFocusRequestor(vls[iiii])}else{if(k=="FOCUS_NO_SELECT"){addActiveElementRequestor(vls[iiii])}}}}}catch(j){}}var b=m_modelListeners.length;addLogMessage("updateModelListeners - #modellisteners: "+m_modelListeners.length);for(var h=0;h<m_modelListeners.length;h++){try{var g=new Date();m_modelListeners[h](c);var e=new Date()}catch(j){}if(m_continueUpdateModelListeners==false){return}}for(var a in m_propertyListenersTBP){try{var g=new Date();m_propertyListenersTBP[a](c);var e=new Date();if(m_doLog){addLogMessage("updateModelListeners - propertyListenersTBP["+a+"] "+(e.getTime()-g.getTime()))}}catch(j){}}m_propertyListenersTBP=[]}function transferXMLIntoModel(d){var F=[];var D=[];var r=0;var C="";if(m_properties==null){m_properties=[];m_model=[];addLogMessage("transferXMLIntoModel - m_properties was null");reapplyPropertyListeners("transferXMLIntoModel")}var l=false;var e=d.length;var B=0;var j=0;while(true){if(B>=e){break}vcurrentchar=d.charAt(B);if(vcurrentchar=="p"||vcurrentchar=="q"||vcurrentchar=="z"||vcurrentchar=="w"){j++;var z=5;if(vcurrentchar=="z"){z=10;vcurrentchar="p"}else{if(vcurrentchar=="w"){z=10;vcurrentchar="q"}}nLength=d.substr(B+1,2)*1;vLength=d.substr(B+3,z)*1;B+=(3+z);var a=d.substr(B,nLength);if(vcurrentchar=="q"){vNameBefore=a;a=D[a]}a=C+a;B+=nLength;var m=d.substr(B,vLength);B=B+vLength;var h=m_model[a];if(h==null){h=new Object();h.isNormalField=true;h.name=a;h.value=m;h.isChanged=false;h.isKilled=false;m_properties[m_properties.length]=h;m_model[a]=h;addPropertyListenerTBP(h)}else{h.value=m;h.isChanged=false;h.isKilled=false;addPropertyListenerTBP(h)}}else{if(vcurrentchar=="s"){var q=new Object();nLength1=d.substr(B+1,1)*1;nLength2=d.substr(B+2,2)*1;B+=4;var u=d.substr(B,nLength1);B+=nLength1;var n=d.substr(B,nLength2);B+=nLength2;D[u]=n}else{if(vcurrentchar=="x"){nLength=d.substr(B+1,2)*1;B+=3;m_modelDeltaId=d.substr(B,nLength);B+=nLength}else{if(vcurrentchar=="b"){nLength=d.substr(B+1,2)*1;B+=3;F[r]=d.substr(B,nLength);r++;C="";for(var H=0;H<r;H++){C+=F[H];C+="."}B+=nLength}else{if(vcurrentchar=="c"){B+=1;r--;C="";for(var H=0;H<r;H++){C+=F[H];C+="."}}else{if(vcurrentchar=="k"){nLength=d.substr(B+1,2)*1;B+=3;var a=d.substr(B,nLength);var E=a;B+=nLength;var h=m_model[E];if(h!=null){h.isKilled=true;h.isChanged=false;addPropertyListenerTBP(h)}m_killedItems++}else{if(vcurrentchar=="l"){addLogMessage("transferXMLIntoModel - model needs to be killed!");m_properties=[];m_model=[];reapplyPropertyListeners("vcurrentchar == l");B++}else{if(vcurrentchar=="a"){var w=d.substr(B+1,2)*1;var y=d.substr(B+3,2)*1;var g=d.substr(B+5,2)*1;var k=d.substr(B+7,2)*1;var I=d.substr(B+9,2)*1;var G=d.substr(B+11,8)*1;B+=19;var x=d.substr(B,w);B+=w;var K=d.substr(B,y);B+=y;var c=d.substr(B,g);B+=g;var t=d.substr(B,k);B+=k;var f=d.substr(B,I);B+=I;var A=d.substr(B,G);B+=G;var b=CL().buildBufferAccesKey(x,K,c,t,f);CL().bufferAdapterStream(b,A)}else{if(checkCharSequence(d.substr(0,20))){l=true}else{alert("Previous property: "+a);alert(d.substr(B,B+10));alert("This should never happen: "+d.charAt(B)+"\nat"+B+"\n\n"+d)}break}}}}}}}}}if(m_killedItems>100){var L=[];var J=[];for(var p in m_model){var s=m_model[p];if(s!=null&&(s.isKilled==false||s.listeners!=null)){L[p]=m_model[p];J[J.length]=s}}m_model=L;m_properties=J;m_killedItems=0}return l}function checkCharSequence(c){var b=new RegExp("^[a-z]{1}[0-9]{19}$").exec(c);if(b==null){return false}var a=""+b[0];return(b.index==0&&a.length==c.length)}function normalizeItemValuePair(d,e){var f="";var g=e.split(" ");var c="";var b=["width","height","font-size","padding","margin","top","left","right","bottom","border","border-top","border-left","border-right","border-bottom","margin-top","margin-left","margin-right","margin-bottom","padding-top","padding-left","padding-right","padding-bottom","text-indent","background-position","box-shadow","text-shadow","line-height","letter-spacing","max-height","min-height","max-width","min-width"];if(b.indexOf(d)>=0){var a;for(a=0;a<g.length;a++){c=g[a];if(a>0){f+=" "}f+=C_adjustUnits(c)}}else{f=e}return d+":"+f}function getStylePropertyValue(a){var e=getPropertyValue(a);if(e!=null){var d="";var f=e.split(";");var b;for(b=0;b<f.length;b++){var c=f[b].split(":");if(b>0){d+=";"}if(c.length==2){d+=normalizeItemValuePair(c[0].trim(),c[1].trim())}else{d+=f[b]}}}return d}function getPropertyValue(b){if(b==null){return null}var a=b;if(m_model==null){return}property=m_model[a];if(property==null){return null}if(property.isKilled==true){return null}return property.value}function setPropertyIsKilled(a,b){if(b==null){b=false}if(m_properties==null){return}if(m_model==null){return}property=m_model[a];if(property!=null){property.isKilled=b}}function setPropertyValue(a,b,c){if(b==null){b=""}b=""+b;if(m_properties==null){m_properties=[];m_model=[]}property=m_model[a];if(property!=null){property.value=b;if(c!=true){property.isChanged=true;addPropertyListenerTBP(property)}}else{property=new Object();property.isNormalField=true;property.name=a;property.value=b;if(c!=true){property.isChanged=true}m_properties[m_properties.length]=property;m_model[a]=property}if(m_beforeFirstReactOnNewModel==true){m_internalProperties[property.name]=true}else{handleUserInputProp(a)}if(m_internalProperties[a]!=true){m_bufferNeedsRefresh=true}}function handleUserInputProp(a){if(m_uiprop==null){if(parent.m_userinputprop!=null){m_uiprop=parent.m_userinputprop;m_uipropframe=this}else{try{if(m_parentparent.parent.m_userinputprop!=null){m_uiprop=m_parentparent.parent.m_userinputprop;m_uipropframe=m_parentparent.parent.C}else{m_uiprop=""}}catch(b){m_uiprop=""}}}if(m_uiprop!=""){if(m_uipropframe.getPropertyValue(m_uiprop)!="true"&&a.indexOf("pagePixel")!=0&&a.indexOf("repeatIndex")!=0&&a.indexOf("cISAddons.focus")!=0&&m_uiprop!=a){m_uipropframe.setPropertyValue(m_uiprop,"true");m_uipropframe.updateModelListeners(null)}}}function removePropertyValue(a){if(m_model[a]!=null){m_model[a]=null}}function blockActivities(){m_noactivityuntil=new Date()}function checkIfNoActivities(a){if(m_noactivityuntil==null){return false}if(a.valueOf()<(m_noactivityuntil.valueOf()+250)){return true}return false}function pushContinueMethod(){m_pushedContinueMethod=m_continueMethod}function popContinueMethod(){m_continueMethod=m_pushedContinueMethod}var m_submitModelFlushCalled;function submitModelFlush(b,a){if(m_lastServerFetch!=null&&m_submitModelFlushCalled!=null&&m_lastServerFetch.getTime()>=m_submitModelFlushCalled.getTime()){addLogMessage("submitModelFlush(): Already transferred!");return}else{addLogMessage("submitModelFlush(): Not yet transferred!");submitModel(b,a)}}function submitModel(b,a){var c=getPropertyValue("cISAddons.noResponse");if(c=="true"){addLogMessage("submitModel(): no submit - adapter sends noResponse==true");return}if(parent.m_blockIOByFlush==true){addLogMessage("submitModel(): parent.m_blockIOByFlush = "+parent.m_blockIOByFlush);addLogMessage("submitModel(): Processing Mozilla Flush Management!");parent.m_blockIOByFlush=false;m_submitModelFlushCalled=new Date();setTimeout('submitModelFlush("'+b+'",'+a+")",100);return}if(checkAllValidations()==false){parent.m_blockIOByFlush=false;return}if(m_sessionId==null){addLogMessage("submitModel - page not initialized yet, submit suppressed\nThis may happen in multi frame pages when not carefully paying attention to order of building up frame content\nProcessing will be interrupted for this page.");return}if(m_bufferNeedsRefresh==true||a==true){CL().clearBufferedAdapterStream(CL().buildBufferAccesKey(m_sessionId,m_processId,m_modelId,m_modelName,findPseudoURL()))}if(checkIO()==false){if(m_doLog){addLogMessage("submitModel - ended, page just blocked")}return}switchToOccupiedPAGE();pushContinueMethod();synchronizeInnerPagesAndContinue(submitModelContinue)}function submitModelContinue(){popContinueMethod();invokeDCListeners();var a=buildFirstTag("m","")+buildXMLFromModel("submitModel");fetchModelFromServer(a)}function refreshModel(){addLogMessage("refreshModel - started");if(this.m_refreshPopupParams!=null){setPropertyValue("cISAddons.closedPopupAdapterName",m_refreshPopupParams.modelName);setPropertyValue("cISAddons.closedPopupAdapterId",m_refreshPopupParams.modelId);m_refreshPopupParams=null}if(checkIO()==false){addLogMessage("refreshModel - need to repeat page or inner page just blocked");setTimeout("refreshModel();",50);return}switchToOccupiedPAGE();var a=buildFirstTag("e","")+buildXMLFromModel("refreshModel");addLogMessage("refreshModel - sending "+a);m_continueUpdateModelListeners=false;fetchModelFromServer(a)}function invokeMethodInModel(c,b,a){if(c=="casabacSynchronizeIfNecessary"&&this.m_modelName!=null&&(this.m_modelName.indexOf("NatLogon")>0||this.m_modelName.indexOf("NatDisconnect")>0)){return}if(CL().m_flushInProgress!=null){if(((new Date()).getTime()-CL().m_flushInProgress)>200){CL().m_flushInProgress=null}if(a!=true){setTimeout('invokeMethodInModel("'+c+'", "'+b+'")',20);return}}var h=getPropertyValue("cISAddons.noResponse");if(h=="true"){addLogMessage("invokeMethodInModel(): no invoke - adapter sends noResponse==true");return}if(b!=true){CL().clearBufferedAdapterStream(CL().buildBufferAccesKey(m_sessionId,m_processId,m_modelId,m_modelName,findPseudoURL()))}if(c!="casabacSynchronizeIfNecessary"&&checkAllValidations(false)==false){return}if(c=="xyzzyxxyzzyxxyzzyx_cishelp"){m_firstFocusCall=true}if(m_doLog){addLogMessage("invokeMethodInModel - started ("+c+")")}if(checkIO()==false){if(m_doLog){addLogMessage("invokeMethod - ended, page just blocked")}return}var d=new Date();if(checkIfNoActivities(d)){addLogMessage("invokeMethodInModel - page is blocked (Reason: noactivityuntil was set)");return}try{if(m_islogonform){for(var f=0;f<m_FieldsArray.length;f++){transferChangeFIELD(m_FieldsArray[f],false)}}}catch(g){}switchToOccupiedPAGE();CL().C_flushFocusInfo(this,a);m_bufferedMethodName=c;pushContinueMethod();synchronizeInnerPagesAndContinue(invokeMethodInModelContinue)}function invokeMethodInModelContinue(){try{var c=parent.window.location.href;if((c.indexOf("com.softwareag.cis.workplace.MFWorkplace")>=0||c.indexOf("com.softwareag.cis.workplace.MFActivities")>=0||c.indexOf("PluggableUI/Taskbar")>=0)&&m_bufferedMethodName!="xxxxxxxxxx"){callMethodInTarget("casabacSynchronizeIfNecessary","CONTENT")}}catch(a){}if(m_doLog){addLogMessage("invokeMethodInModelContinue - started")}popContinueMethod();invokeDCListeners();m_processCasabacSynchronizeIfNecessary=false;if(m_bufferedMethodName!=null&&m_bufferedMethodName.indexOf("xxxxxxx")<0){m_processInvokeMethodInModel=true}if(m_bufferedMethodName=="casabacSynchronizeIfNecessary"){var e=false;var f=m_properties.length;for(var d=0;d<f;d++){if(m_properties[d].isChanged==true&&!(m_internalProperties[m_properties[d].name]==true)&&m_properties[d].name!=null&&m_properties[d].name.indexOf("rowCount")<0&&m_properties[d].name.indexOf("rowCount")<0){e=true;break}}if(e==false){switchToDisplayPAGE();return}else{m_processCasabacSynchronizeIfNecessary=true}}var b;if(m_bufferedMethodName!="casabacSynchronizeIfNecessary"){b=buildFirstTag("v",m_bufferedMethodName)+buildXMLFromModel("invokeMethodInModel")}else{var b=buildFirstTag("m","")+buildXMLFromModel("submitModel")}m_bufferedMethodName="inittini";if(m_doLog){addLogMessage("invokeMethodInModelContinue - submitting")}fetchModelFromServer(b)}function buildXMLFromModel(b){if(m_properties==null){return""}var a=[];var e=m_properties.length;for(var c=0;c<e;c++){vprop=m_properties[c];if(vprop==null){continue}if(vprop.isChanged==true){vName=vprop.name;vValue=vprop.value;if(vName==null){continue}if(vValue==null){continue}if(vValue==null||vValue.length<100000){a.push("p"+detLength(vName,2)+detLength(vValue,5)+vName+vValue)}else{a.push("z"+detLength(vName,2)+detLength(vValue,10)+vName+vValue)}vprop.isChanged=false}}a.push("x"+detLength(m_modelDeltaId,2)+m_modelDeltaId);var d=a.join("");return d}function registerListener(a){if(parent.m_roi_firstusage==false){return}if(a==null){return}m_modelListeners.push(a)}function registerPropertyListener(d,a,c,b){if(b==false&&parent.m_roi_firstusage==false){return}if(a==null){return}if(a==""){return}if(m_properties==null){m_properties=[];m_model=[]}property=m_model[a];if(property==null){property=new Object();property.isNormalField=true;property.name=a;property.value=null;m_properties[m_properties.length]=property;m_model[a]=property}if(property.listeners==null){property.listeners=[]}property.listeners[c]=d;var e=new Object();e.listener=d;e.propertyName=a;e.listenerId=c;if(b!=true){m_propertyListeners.push(e)}m_propertyListenersTBP[c]=d}function registerStatusPropertyListener(c,a,b,d){if(parent.m_roi_firstusage==false){return}registerPropertyListener(c,a,b,false);if(m_statuspropListeners[a]==null){m_statuspropListeners[a]=[]}m_statuspropListeners[a].push(d)}function registerSwitchToDisplayListener(a,d,b){if(parent.CasaPAGE.style.display!="none"){return}var c=new Object();c.listenermethod=a;c.param=d;c.param2=b;m_switchToDisplayListeners.push(c)}function upateSwitchToDisplayListerners(a){for(var b=0;b<m_switchToDisplayListeners.length;b++){var c=m_switchToDisplayListeners[b];if(c.param2!=null){c.listenermethod(c.param,c.param2)}else{c.listenermethod(c.param)}}m_switchToDisplayListeners=[]}function registerSwitchToOccupiedListener(a,c){if(parent.m_roi_firstusage==false){return}var b=new Object();b.listenermethod=a;b.param=c;m_switchToOccupiedListeners.push(b)}function reapplyPropertyListeners(c){addLogMessage("reapplyPropertyListeners was called: "+m_propertyListeners.length);for(var a=0;a<m_propertyListeners.length;a++){var b=m_propertyListeners[a];registerPropertyListener(b.listener,b.propertyName,b.listenerId,true)}}function addPropertyListenerTBP(b){var a=b.listeners;if(a==null){b.listeners=[]}for(var c in a){m_propertyListenersTBP[c]=a[c]}}function registerListenerAsFirst(b){if(parent.m_roi_firstusage==false){return}index=m_modelListeners.length;var a;for(var a=index;a>0;a--){m_modelListeners[a]=m_modelListeners[a-1]}m_modelListeners[0]=b}function registerListenerAsLast(a){if(parent.m_roi_firstusage==false){return}m_modelListenersLast.push(a)}function registerListenerforSCROLLBAR(a){m_modelListenersSCROLL.push(a)}function removeListener(b){for(var a=0;a<m_modelListeners.length;a++){var c=""+m_modelListeners[a];if(c.indexOf(b)>=0){m_modelListeners.splice(a,1);break}}}function removePropertyListener(c){var f=[];var g=[];var d=[];for(var e=0;e<m_propertyListeners.length;e++){var b=m_propertyListeners[e];if(b.listenerId!=c){f.push(b)}else{d.push(b.propertyName)}}m_propertyListeners=f;for(var e=0;e<d.length;e++){var j=m_model[d[e]];if(j==null){continue}var h=new Object();for(var a in j.listeners){if(a!=c){h[a]=j.listeners[a]}}j.listeners=h}for(var a in m_propertyListenersTBP){if(a!=c){g[a]=m_propertyListenersTBP[a]}}m_propertyListenersTBP=g}function registerDCListener(a){m_dcListeners.push(a)}function invokeDCListeners(){for(var a=0;a<m_dcListeners.length;a++){m_dcListeners[a]()}}function removeProcess(){alert("should not be called (csc.removeProcess)")}function submitConnector(d,c,a,b){var g;var f="SESSIONID="+d+"&XML="+c+"&PAGEINITPARAM="+a+"&STAMP="+b;if(typeof ActiveXObject=="undefined"){g=new XMLHttpRequest()}else{g=new ActiveXObject("Microsoft.XMLHTTP")}try{g.open("POST","../servlet/Connector",false);g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.setRequestHeader("Content-length",f.length);g.send(f)}catch(e){}return true}function removeSession(){try{var d=buildFirstTag("s","")+buildXMLFromModel("removeSession");var a=" ";var b=cscformiframe.document.getElementById("STAMP").value;submitConnector(m_sessionId,d,a,b)}catch(c){}}var mm_convertValue=null;function convertValue(c,a,b){if(mm_convertValue==null){mm_convertValue=CL().C_convertValue}return mm_convertValue.call(this,c,a,b)}var mm_convertYYYYMMDDIntoDisplayString=null;function convertYYYYMMDDIntoDisplayString(a){if(mm_convertYYYYMMDDIntoDisplayString==null){mm_convertYYYYMMDDIntoDisplayString=CL().C_convertYYYYMMDDIntoDisplayString}return mm_convertYYYYMMDDIntoDisplayString.call(this,a)}var mm_convertDisplayStringIntoYYYYMMDD=null;function convertDisplayStringIntoYYYYMMDD(a){if(mm_convertDisplayStringIntoYYYYMMDD==null){if(getPropertyValue("cISAddons.completedateinput")=="false"){mm_convertDisplayStringIntoYYYYMMDD=CL().C_convertDisplayStringIntoYYYYMMDD_2}else{mm_convertDisplayStringIntoYYYYMMDD=CL().C_convertDisplayStringIntoYYYYMMDD}}return mm_convertDisplayStringIntoYYYYMMDD.call(this,a)}var mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString=null;function convertYYYYMMDDHHMMSSMMMIntoDisplayString(a){if(mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString==null){mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString=CL().C_convertYYYYMMDDHHMMSSMMMIntoDisplayString}return mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString.call(this,a,"HHMMSSMMM")}function convertYYYYMMDDHHMMSSIntoDisplayString(a){if(mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString==null){mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString=CL().C_convertYYYYMMDDHHMMSSMMMIntoDisplayString}return mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString.call(this,a,"HHMMSS")}function convertYYYYMMDDHHMMIntoDisplayString(a){if(mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString==null){mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString=CL().C_convertYYYYMMDDHHMMSSMMMIntoDisplayString}return mm_convertYYYYMMDDHHMMSSMMMIntoDisplayString.call(this,a,"HHMM")}var mm_convertDisplayStringIntoYYYYMMDDHHMMSSMMM=null;function convertDisplayStringIntoYYYYMMDDHHMMSSMMM(a){if(mm_convertDisplayStringIntoYYYYMMDDHHMMSSMMM==null){mm_convertDisplayStringIntoYYYYMMDDHHMMSSMMM=CL().C_convertDisplayStringIntoYYYYMMDDHHMMSSMMM}return mm_convertDisplayStringIntoYYYYMMDDHHMMSSMMM.call(this,a)}function convertDisplayStringIntoYYYYMMDDHHMMSS(a){return a}var mm_convertHHMMSSIntoDisplayString=null;function convertHHMMSSIntoDisplayString(a){if(mm_convertHHMMSSIntoDisplayString==null){mm_convertHHMMSSIntoDisplayString=CL().C_convertHHMMSSIntoDisplayString}return mm_convertHHMMSSIntoDisplayString.call(this,a)}var mm_convertDisplayStringIntoHHMMSS=null;function convertDisplayStringIntoHHMMSS(a){if(mm_convertDisplayStringIntoHHMMSS==null){mm_convertDisplayStringIntoHHMMSS=CL().C_convertDisplayStringIntoHHMMSS}return mm_convertDisplayStringIntoHHMMSS.call(this,a)}var mm_convertFLOATIntoDisplayString=null;function convertFLOATIntoDisplayString(b,a){if(mm_convertFLOATIntoDisplayString==null){mm_convertFLOATIntoDisplayString=CL().C_convertFLOATIntoDisplayString}return mm_convertFLOATIntoDisplayString.call(this,b,a)}var mm_convertDisplayStringIntoFLOAT=null;function convertDisplayStringIntoFLOAT(a){if(mm_convertDisplayStringIntoFLOAT==null){mm_convertDisplayStringIntoFLOAT=CL().C_convertDisplayStringIntoFLOAT}return mm_convertDisplayStringIntoFLOAT.call(this,a)}var mm_convertINTIntoDisplayString=null;function convertINTIntoDisplayString(a){if(mm_convertINTIntoDisplayString==null){mm_convertINTIntoDisplayString=CL().C_convertINTIntoDisplayString}return mm_convertINTIntoDisplayString.call(this,a)}var mm_checkIfValueHasError=null;function checkIfValueHasError(c,a,b,d){if(mm_checkIfValueHasError==null){mm_checkIfValueHasError=CL().C_checkIfValueHasError}return mm_checkIfValueHasError.call(this,c,a,b,d)}var mm_checkIf1000SeparatorsHasError=null;function checkIf1000SeparatorsHasError(a){if(mm_checkIf1000SeparatorsHasError==null){mm_checkIf1000SeparatorsHasError=CL().C_checkIf1000SeparatorsHasError}return mm_checkIf1000SeparatorsHasError.call(this,a)}function convertDURATIONIntoDisplayString(a){}var CONTROLTYPE_CONTAINER=0;var CONTROLTYPE_INPUT=1;function convertStatusToVisible(b,a){if(b=="true"){return b}if(b=="false"){return b}if(b=="INVISIBLE"){return"false"}if(b=="DISPLAY"){if(a==CONTROLTYPE_CONTAINER){return"true"}else{return"false"}}if(b=="EDIT"){return"true"}if(b=="FOCUS"||b=="FOCUS_NO_SELECT"){return"true"}if(b=="ERROR"){return"true"}if(b=="ERROR_NO_FOCUS"){return"true"}return b}function detLength(a,b){if(a==null){a=""}a=""+a;a=a.replace(/\r\n/g,"\n");a=a.replace(/\n/g,"\r\n");vl=a.length;if(b==1){return""+vl}if(b==2){if(vl<10){return"0"+vl}return""+vl}if(b==3){if(vl<10){return"00"+vl}if(vl<100){return"0"+vl}return""+vl}if(b==5){if(vl<10){return"0000"+vl}if(vl<100){return"000"+vl}if(vl<1000){return"00"+vl}if(vl<10000){return"0"+vl}return""+vl}if(b==10){if(vl<10){return"000000000"+vl}if(vl<100){return"00000000"+vl}if(vl<1000){return"0000000"+vl}if(vl<10000){return"000000"+vl}if(vl<100000){return"00000"+vl}if(vl<1000000){return"0000"+vl}if(vl<10000000){return"000"+vl}if(vl<100000000){return"00"+vl}if(vl<1000000000){return"0"+vl}return""+vl}alert("This method is not prepared for the call, digits = "+b)}function detString(a){if(a!=null){return a}return""}function convertForSend(a){alert("convertForSend: Not required anymore!");return a}function convertForReceive(a){alert("convertForReceive: Not required anymore!");return a}function convertPropertyNameIn(a){alert("convertPropertyNameIn: Not required anymore!");return a}function convertApos(a){var b=a;if(b!=null&&b.indexOf("'")>=0){b=b.replace(/'/g,"&#146;")}return b}function convertSpecialHTMLCharacters(a){var b=a;if(b.indexOf("&")>=0){b=b.replace(/&/g,"&amp;")}if(b.indexOf('"')>=0){b=b.replace(/\"/g,"&quot;")}if(b.indexOf("<")>=0){b=b.replace(/\</g,"&lt;")}if(b.indexOf(">")>=0){b=b.replace(/\>/g,"&gt;")}return b}function buildFirstTag(a,d){var c=m_parentdocument.URL;var b=m_parentparent.isPopupPage;if(b==null){b=false}return a+detLength(m_sessionId,2)+detLength(m_processId,2)+detLength(m_modelId,2)+detLength(m_modelName,2)+detLength(m_pageName,2)+detLength(c,3)+detLength(d,5)+detLength(b,1)+detString(m_sessionId)+detString(m_processId)+detString(m_modelId)+detString(m_modelName)+detString(m_pageName)+detString(c)+detString(d)+detString(b)}function encodeURLParameter(c){if(c==null){return null}var b=c;try{c=encodeStringIntoUTF8(c);c=escape(c).replace(/\+/g,"%2C").replace(/\"/g,"%22").replace(/\'/g,"%27");return c}catch(a){return b}}function encodeStringIntoUTF8(e){e=e.replace(/\r\n/g,"\n");var a="";for(var d=0;d<e.length;d++){var b=e.charCodeAt(d);if(b<128){a+=String.fromCharCode(b)}else{if((b>127)&&(b<2048)){a+=String.fromCharCode((b>>6)|192);a+=String.fromCharCode((b&63)|128)}else{a+=String.fromCharCode((b>>12)|224);a+=String.fromCharCode(((b>>6)&63)|128);a+=String.fromCharCode((b&63)|128)}}}return a}var mm_replaceLiteralTRANSLATION=null;function replaceLiteralTRANSLATION(b,a){if(mm_replaceLiteralTRANSLATION==null){mm_replaceLiteralTRANSLATION=CL().C_replaceLiteralTRANSLATION}return mm_replaceLiteralTRANSLATION.call(this,b,a)}var mm_replaceLiteralWithAddTextTRANSLATION=null;function replaceLiteralWithAddTextTRANSLATION(d,c,b,a){if(mm_replaceLiteralWithAddTextTRANSLATION==null){mm_replaceLiteralWithAddTextTRANSLATION=CL().C_replaceLiteralWithAddTextTRANSLATION}return mm_replaceLiteralWithAddTextTRANSLATION.call(this,d,c,b)}function controlSelectionRefresh(f,a){var e=parent.document.querySelectorAll(".previewSelect");var d;for(d=0;d<e.length;d++){e[d].classList.remove("previewSelect")}e=parent.document.querySelectorAll(".previewActive");for(d=0;d<e.length;d++){e[d].classList.remove("previewActive")}var b;if(f==null&&a<0){return}var c=f.split(";");for(d=0;d<c.length-1;d++){b=parent.document.querySelector('[data-casaindex="'+c[d]+'"]');if(b!=null){b.classList.add("previewSelect")}}b=parent.document.querySelector('[data-casaindex="'+a+'"]');if(b!=null){b.classList.remove("previewSelect");b.classList.add("previewActive")}}function reactOnClickPage(b){if(parent.CASA_supressXYContextMenu==true){parent.CASA_supressXYContextMenu=false;return}var c=findSrcElement(b);if(c.tagName=="BUTTON"||c.tagName=="IMG"||c.tagName=="TD"){setControlMenuOffset(c,12,10)}else{try{setContextMenuXYPAGE(b.clientX,b.clientY)}catch(a){}}}function setControlMenuOffset(e,b,d){calculatePageOffset(e);var a=e.CASA_pageoffsetleft+b;var c=e.CASA_pageoffsettop+e.offsetHeight+d;setContextMenuXYPAGE(a,c)}var m_MPADIV=null;function findMPADIV(b){if(m_MPADIV==null&&b!=false){var a=parent.createElement("DIV");a.id="MPADIV";a.style.position="absolute";a.style.display="none";a.style.left="0";a.style.top="0";a.style.zIndex="100000";a.style.width="0";a.style.height="0";parent.document.body.appendChild(a);addClickAwayObject(a);m_MPADIV=a}return m_MPADIV}var m_THISOCCUPIED=null;var m_THISOCCUPIEDIMG=null;function findTHISOCCUPIED(g,f){if(m_THISOCCUPIED==null&&g!=false){var c=getPropertyValue("cISAddons.popupDivFrame");var e;if(c!=null&&c!=""){e=CL().C_findFrame(this,c,true)}var d;var a=null;if(e!=null){var b=findOwnerTHISOCCUPIED(e,f);d=b.document.getElementById("THISOCCUPIED");if(d==null){d=b.document.createElement("DIV")}}else{d=parent.createElement("DIV");a=parent.createElement("IMG")}d.id="THISOCCUPIED";d.style.position="absolute";d.style.display="none";d.style.cursor="wait";if(parent.m_immediatedisplay==true){d.style.display=""}d.style.left="0";d.style.top="0";d.style.zIndex="1010";d.style.width="100%";d.style.height="100%";m_THISOCCUPIEDIMG=buildOccupiedImage();if(e!=null){findOwnerTHISOCCUPIED(e,f).document.body.appendChild(d)}else{parent.document.body.appendChild(d);parent.document.body.appendChild(m_THISOCCUPIEDIMG)}m_THISOCCUPIED=d}return m_THISOCCUPIED}function findOwnerTHISOCCUPIED(a,b){if(b!=true&&(CL().CASA_popupopenersvalues!=null&&CL().CASA_popupopenersvalues.length>0&&m_parentparent!=null&&m_parentparent.parent!=null)){return m_parentparent.parent}if(CL().m_frameBufferSize==1){return parent}return extractContentWindow(a)}function buildOccupiedImage(){var a=parent.createElement("IMG");a.style.position="absolute";a.style.left="0";a.style.top="0";a.style.zIndex="1011";if(parent.m_immediatedisplay==true){a.style.display=""}a.src="../HTMLBasedGUI/general/occupied.gif";var b=parent.m_occupiedpixelwidth;if(parent.m_occupiedpixelwidth==null){b="29px"}a.style.width=C_adjustUnits(b);b=parent.m_occupiedpixelheight;b=C_adjustUnits(b);if(b==null){b="36px"}a.style.height=C_adjustUnits(b);if(parent.m_occupiedimage!=null){a.src=parent.m_occupiedimage}return a}function removeTHISOCCUPIED(){}function setDisplayTHISOCCUPIED(b){var a=findTHISOCCUPIED();a.style.display=b;if(m_THISOCCUPIEDIMG!=null){m_THISOCCUPIEDIMG.style.display=b}}function extractContentWindow(a){if(a==null){return null}if(a.contentWindow!=undefined){return a.contentWindow}else{return a}}function prepareDIR(a){if(a.body.style.direction!=parent.document.body.style.direction){a.body.style.direction=parent.document.body.style.direction}}var m_THISCONTEXTMENU=null;function findTHISCONTEXTMENU(h){if(m_THISCONTEXTMENU==null&&h!=false){try{var f;var e=null;var b=parent.m_centralContextMenu;var c=getPropertyValue("cISAddons.popupDivFrame");if(c!=null){e=CL().C_findFrame(this,c,true)}if(b&&e!=null){var d=extractContentWindow(e).document;f=d.createElement("DIV");if(!isSafari()){prepareDIR(d)}else{if(f.style.direction!=parent.document.body.style.direction){f.style.direction=parent.document.body.style.direction}}}else{f=parent.createElement("DIV")}f.id="THISCONTEXTMENU";f.style.display="none";f.style.position="absolute";f.style.top="0";f.style.width="100%";f.style.height="100%";f.style.zIndex="1000";if(parent.document.body.style.direction=="rtl"){f.style.right="0";f.style.align="right"}else{f.style.left="0";f.style.align="left"}f.style.valign="middle";if(b&&e!=null){f.CASA_cmOwnerFrame=extractContentWindow(e);f.CASA_iscentralCM=true;extractContentWindow(e).document.body.appendChild(f);var g=calculateFrameOffset(c);if(g!=null){f.CASA_frameOffsetLeft=g.frameOffsetLeft;f.CASA_frameOffsetTop=g.frameOffsetTop}}else{f.CASA_cmOwnerFrame=parent;f.CASA_iscentralCM=false;parent.document.body.appendChild(f)}addClickAwayObject(f);m_THISCONTEXTMENU=f}catch(a){}}if(parent.m_centralContextMenu&&m_THISCONTEXTMENU!=null){var g=calculateFrameOffset(getPropertyValue("cISAddons.popupDivFrame"));if(g!=null){m_THISCONTEXTMENU.CASA_frameOffsetLeft=g.frameOffsetLeft;m_THISCONTEXTMENU.CASA_frameOffsetTop=g.frameOffsetTop}}return m_THISCONTEXTMENU}var m_DRAGDROP=null;function findDRAGDROP(b){if(m_DRAGDROP==null&&b!=false){var a=parent.createElement("DIV");a.id="DRAGDROP";a.style.display="none";a.style.position="absolute";a.style.cursor="move";a.style.left="0";a.style.top="0";a.style.width="100px";a.style.height="100px";parent.document.body.appendChild(a);addClickAwayObject(a);m_DRAGDROP=a}return m_DRAGDROP}function submitModelFastBufferSwitch(){submitModel("submit")}function executeXMLHTTTPPost(f){var d=createXMLHttpRequest();var b="";if(m_parentparent.pageInitParam!=null){b=m_parentparent.pageInitParam}f=f.replace(/%/g,"%25");f=f.replace(/&/g,"%26");f=f.replace(/\n/g,"%0D%0A");var a="SESSIONID="+m_sessionId+"&XML="+f+"&PAGEINITPARAM="+b+"&STAMP=";var e=parent.location.href;var c=e.indexOf("?");if(c>0){e=e.substring(0,c)}var c=e.lastIndexOf("/");e=e.substring(0,c);var c=e.lastIndexOf("/");e=e.substring(0,c);d.open("POST",e+"/servlet/Connector",true);d.onreadystatechange=function(){if(d.readyState!=4){return}var h=d.responseText;var k=new Object();var g=h.indexOf('<textarea id="XML" name="XML">');var j=h.indexOf("</textarea>",g);k.xml=h.substring(g+30,j);g=h.indexOf('<textarea id="ERRORMESSAGE" name="ERRORMESSAGE">');j=h.indexOf("</textarea>",g);k.error=h.substring(g+48,j);g=h.indexOf('<input type="text" name="STAMP" id="STAMP" value="');j=h.indexOf('">',g);k.stamp=h.substring(g+50,j);reactOnNewModel(null,k)};d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(a)}function createDIVPOPUP(b,a,f,l){var d=getPropertyValue("cISAddons.popupDivFrame");if(d==null){alert("Unable to open popup");return}var h=CL().C_findFrame(this,d,true);if(h==null){alert("Unable to open popup");return}var c="";var g=extractContentWindow(h);var k=g.document;var j=g.innerHeight;var e=k.createElement("DIV");e.style.position="absolute";e.style.display="";e.style.left="0";e.style.top="0";e.style.height="100%";e.style.width="100%";e.style.zIndex="1000";e.style.backgroundColor="transparent";c+="<table height='100%' width='100%'>\n";c+="<tr align='center' valign='middle'>\n";c+="<td align='center' valign='middle'>\n";c+="<div id='POPUPDIV' name='POPUPDIV' style='align:center;valign:middle;"+abstractStyleInfo(a,j)+"'>\n";c+="<table cellspacing='0' cellpadding='0' height='100%' width='100%' class='POPUPDIVTable'>";c+="<tr class='POPUPDIVTitleBarCell'>";c+='<td class=\'POPUPDIVTitleBarCell\'><div nowrap="true" style="overflow-x: hidden;">'+f+"</div></td></tr>";c+="<tr class='POPUPDIVCell'><td class='POPUPDIVCell'>";c+='<iframe name=\'POPUPFRAME\' frameborder="0" scrolling="no" class="POPUPDIVFrame" id=\'POPUPFRAME\' src=\''+b+"'>\n";c+="</iframe>";c+="</td></tr></table>";c+="</div>";c+="</td></tr></table>";e.innerHTML=c;k.body.appendChild(e);e.refreshIt=l;if(extractContentWindow(h).m_divPopUpStack!=null){extractContentWindow(h).m_divPopUpStack.push(e)}}function findTHISPOPUPDIV(){var a=getPropertyValue("cISAddons.popupDivFrame");var b=CL().C_findFrame(this,a,true);if(extractContentWindow(b).m_divPopUpStack==null){return null}return extractContentWindow(b).m_divPopUpStack[extractContentWindow(b).m_divPopUpStack.length-1]}function removeDIVPOPUP(){try{var b=getPropertyValue("cISAddons.popupDivFrame");var d=CL().C_findFrame(this,b,true);var c=null;if(extractContentWindow(d).m_divPopUpStack!=null){c=extractContentWindow(d).m_divPopUpStack.pop()}var e=c.refreshIt;extractContentWindow(d).document.body.removeChild(c);e()}catch(a){}}function setHieghtWidthDIVPOPUP(){var c=findTHISPOPUPDIV();var b=c.getElementById("POPUPDIV");var a=b.style}function abstractStyleInfo(e,m){var h=e.split(";");var f="";var j=0;var c=0;var a=0;var n=0;var d=0;if((e.indexOf("dialogTop")>=0)||(e.indexOf("dialogLeft")>=0)){f+="position:absolute;"}for(var g=0;g<h.length;g++){var b=h[g];var k=b.split(":");if(b.indexOf("dialogHeight")>=0){j+=parseInt(k[1]);n=k[1];n=n.replace("px","")}if(b.indexOf("dialogWidth")>=0){d=k[1];d=d.replace("px","")}if(b.indexOf("dialogTop")>=0){var l=k[1];l=l.substring(l.indexOf("(")+1,l.indexOf(")"));j+=parseInt(l);a=l}if(b.indexOf("dialogLeft")>=0){var l=k[1];l=l.substring(l.indexOf("(")+1,l.indexOf(")"));c=l}}if(j>m){n=n-(parseInt(j)-parseInt(m))-5}f+="left:"+C_adjustUnits(c)+";top:"+C_adjustUnits(a)+";width:"+C_adjustUnits(d)+";height:"+C_adjustUnits(n)+";";return f}function applyDisplayProperty(b,a){if(b==null){return a}if(b.toLowerCase()=="true"){if(a=="FOCUS"||a=="FOCUS_NO_SELECT"){return"DISPLAY"}if(a=="ERROR"||a=="ERROR_NO_FOCUS"){return"ERROR_DISPLAY"}if(a=="INVISIBLE"||a=="ERROR_DISPLAY"||a=="EDIT"){return a}return"DISPLAY"}else{if(a=="FOCUS"||a=="FOCUS_NO_SELECT"||a=="ERROR"||a=="ERROR_NO_FOCUS"||a=="INVISIBLE"||a=="ERROR_DISPLAY"||a=="DISPLAY"){return a}return"EDIT"}}function showMessageInStatusBar(b,a){setPropertyValue(CASA_statusbar.CASA_typeprop,b);if(a.length>0){a="<font color='#B42C2C'><b>"+a+"</b></font>"}setPropertyValue(CASA_statusbar.CASA_shorttextprop,a);updateModelListenersS()}function getDateDisplay(){return m_dateDisplay}function getTimeDisplay(){return m_timeDisplay}function getDecimalSeparator(){return m_decimalSeparator}function get1000Separator(){return m_1000Separator}function getLanguage(){return m_language}function registerPopupPage(a,b){return CL().C_registerPopupPage(a,b)}function C_adjustUnits(a){return CL().C_adjustUnits(a)}function getTesttoolidHtml(){var a=false;if(getPropertyValue("testtoolidhtml4")=="true"){a=true}addLogMessage("ishtml4="+a);return CL().C_getTesttoolidHtml(a)}function addVersionInfoCSCMOZ(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("CSCMOZ")}function addMozDivInternally(a,c){if(a!=null){var b=getMozDivIndex(a);if(b==-1){var d=new Object();d.div=a;d.continueMethod=c;m_mozdivs.push(d)}}else{addLogMessage("addMozDiv: null inserted")}}function getMozDivIndex(a){var b=-1;if(a.id==""){addLogMessage("getMozDivIndex() found an element with no id!");return -1}for(var c=0;c<m_mozdivs.length;c++){var d=m_mozdivs[c];if(d!=null&&d.div!=null&&d.div.id!=null&&d.div.id==a.id){b=c;break}}return b}function replaceMozDivInternally(a,c){if(a!=null){var b=getMozDivIndex(a);var d=new Object();d.div=a;d.continueMethod=c;if(b==-1){m_mozdivs.push(d)}else{m_mozdivs[b]=d}}else{addLogMessage("addMozDiv: null inserted")}}function sizeMozDivs(){try{if(parent.innerHeight==0){return}if(m_model==null){return}addLogMessage("MOZDIV Starting Setting to 0");var f=m_mozdivs.length;for(var g=0;g<f;g++){try{var e=m_mozdivs[g].div;var d=m_mozdivs[g].div.CASA_SCROLL_OUTERDIV;if(d!=null&&d!=0&&d!=undefined){var h=parent.document.getElementById(m_mozdivs[g].div.CASA_SCROLL_OUTERDIV);if(h!=null&&h!=undefined){h.style.height="100%"}}var a=e.childNodes[2];if(a!=undefined&&a.CASA_scrollFactor==0){a.CASA_romuMethod()}if(e.CASA_noHeightReset!=true){var j=m_mozdivs[g].div.parentNode;if(j.vAlign!="top"){j.vAlign="top"}m_mozdivs[g].div.style.height="1px"}}catch(c){alert("m_mozdivs["+g+"]"+c)}}sizeMozDivsContinue()}catch(b){addLogMessage(">>>> sizeMozDivs"+b)}}function sizeMozDivsContinue(){for(var e=(m_mozdivs.length-1);e>=0;e--){try{var m=m_mozdivs[e].div.parentNode;var c=m_mozdivs[e].div.parentNode.style;addLogMessage("MOZDIV setting height: "+m_mozdivs[e].div.id+"/"+m.offsetHeight+"/"+m.scrollHeight+"/"+m_mozdivs[e].div.offsetTop+"/"+m.offsetTop);var a=m.scrollHeight;if(parent.m_roi_firstusage==true){a=m.offsetHeight}if(a>0){a=C_adjustUnits((a-calculatePixelValue(c.paddingTop)-calculatePixelValue(c.paddingBottom)))}m_mozdivs[e].div.style.height=a;if(m.vAlign!="top"){m.vAlign="top"}var k=m_mozdivs[e].div.top;var h=m_mozdivs[e].div.CASA_SCROLL_VID;if(h!=null&&h!=0&&h!=undefined){var f=parent.document.getElementById(m_mozdivs[e].div.CASA_SCROLL_VID);var g=m_mozdivs[e].div.childNodes[1].CASA_scrollTop;if(f!=null&&g!=undefined){f.scrollTop=g}var l=parent.document.getElementById(m_mozdivs[e].div.CASA_SCROLL_OUTERDIV);if(l!=null&&l!=undefined){l.style.height=a}}}catch(b){addLogMessage("MOZDIVSIZING "+b+"in "+m_mozdivs[e].div.id)}}for(var d=(m_mozdivs.length-1);d>=0;d--){try{if(m_mozdivs[d].continueMethod!=null){m_mozdivs[d].continueMethod()}}catch(b){addLogMessage("MOZDIVSIZINg "+b+"in "+m_mozdivs[d].div.id+"   "+m_mozdivs[d].continueMethod)}}}function calculatePixelValue(b){if(b==null){return 0}if(b.indexOf("px")>0){return b.substring(0,b.length-2)*1}try{return b*1}catch(a){}return 0}function addVersionInfoPAGECONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("PAGECONTROLS")}var m_stdDlgPopupFrame;function registerStandardDlgPopupPAGE(a){m_stdDlgPopupFrame=a}function closeStandardDlgPopupPAGE(){if(m_stdDlgPopupFrame!=null){CL().C_deregisterPopupPage(m_stdDlgPopupFrame);m_stdDlgPopupFrame.close();m_stdDlgPopupFrame=null}}var m_wpKeysInited=false;function initCasaControlPAGEBODY(a){a.CASA_bufferedHeight=undefined;a.CASA_bufferedWidth=undefined;m_wpKeysInited=false}var m_replacedCssPAGE=false;var m_closedByApplication=false;function reactOnModelUpdatePAGE(){if(CL()==null){return}if(!m_wpKeysInited){m_wpKeysInited=true;registerWPKeys(this.m_hotKeysPAGE)}try{if(romuINTPOPUP){romuINTPOPUP()}}catch(a){}m_closedByApplication=false;try{var t=getPropertyValue("cISAddons.zoom");if(t==null){t="100%"}}catch(g){}try{var c=getPropertyValue("cISAddons.dir");if(c==null){c="ltr"}if(c!=parent.document.body.style.direction){parent.document.body.style.direction=c}}catch(g){}try{var l=getPropertyValue("cISAddons.clearDS");if(l=="true"){if(this.parent.document.selection){this.parent.document.selection.empty()}else{this.parent.window.getSelection().removeAllRanges()}}}catch(g){}try{var w=getPropertyValue("cISAddons.popupWidth");if(w!=null){var b=getPropertyValue("cISAddons.popupHeight");parent.parent.resizeTo(w,b);if(parent.parent.dialogHeight!=undefined&&parent.parent.dialogWidth!=undefined){parent.parent.dialogHeight=b+"px";parent.parent.dialogWidth=w+"px"}}}catch(g){alert("POPUP WINDOW sizing "+g)}parent.m_pageCompletelyBuilt=true;var m=getPropertyValue("closeWindow");var p=getPropertyValue("nextPage");addLogMessage("nextPage = "+p);var z=getPropertyValue("nextPageId");if(parent.parent.isPopupPage==true){if(m=="true"){var q=false;m_continueUpdateModelListeners=false;m_closedByApplication=true;CL().C_deregisterPopupPage(parent.parent);var x=getPropertyValue("cISAddons.popupDivFrame");if(x!=null&&x!=""&&x!=undefined){var j=CL().C_findFrame(this,x,true);if(j!=null){if(extractContentWindow(j).m_divPopUpStack!=null&&extractContentWindow(j).m_divPopUpStack.length>0){q=true}}}if(q){removeDIVPOPUP()}else{parent.parent.close()}}}var d=getPropertyValue("cISAddons.closeWindow");try{if(d=="true"){m_continueUpdateModelListeners=false;m_closedByApplication=true;top.window.close()}}catch(g){}try{if(parent.parent.isPopupPage!=true&&this.m_modelName.indexOf("NatLogon")<0&&this.m_modelName.indexOf("NatDisconnect")<0&&this.m_modelName.indexOf("MFActivitiesAdapter")<0&&this.m_modelName.indexOf("MFWorkplaceAdapter")<0){var y=CL().findFrame(top,"AVAILABLEACTIVITIES");if(y!=null&&y.WORKAREA!=null&&y.WORKAREA.csciframe!=null&&y.WORKAREA.csciframe.unblockWorkplaceSelect!=undefined){addLogMessage("triggering unblockWorkplace");y.WORKAREA.csciframe.unblockWorkplaceSelect()}}}catch(k){}if(p!=null&&p!="null"&&p!=""){if(z==null){z=""}p=convertCasabacURL(p);var e=getPropertyValue("cISAddons.lops");parent.parent.changeCurrentPage(p,z,e);m_continueUpdateModelListeners=false}if(m_stdDlgPopupFrame!=null){if(p!=null&&p!="null"&&p!=""){closeStandardDlgPopupPAGE()}else{try{m_stdDlgPopupFrame.reactOnNewModel()}catch(n){alert("Date input refresh error "+n);closeStandardDlgPopupPAGE()}}}var r=findTHISCONTEXTMENU(false);if(r!=null){var h=getPropertyValue("cISContextMenuItems[0].text");if(h!=null&&h!=""){var u=getPropertyValue("cISAddons.cisContextMenuOnCloseMethod");r.style.display="";CL().openCONTEXTMENU(this,u,"marginAll")}else{r.style.display="none"}}try{reactOnModelUpdatePOPUPVALUES("cISAddons.pvinfos")}catch(n){}var f=getPropertyValue("cISAddons.popupSkipped");if(f=="true"){setTimeout("refreshModel();",50)}}function extractContentWindow(a){if(a.contentWindow!=undefined){return a.contentWindow}else{return a}}function reactOnClosePopup(){if(CL()==null){return}CL().C_deregisterPopupPage(m_parentparent);var b=CL().C_deregisterPopupOpener();var a=new Object();a.modelName=m_modelName;a.modelId=m_modelId;if(m_closedByApplication==false){if(m_parentparent.opener!=undefined&&m_parentparent.opener!=null){m_parentparent.opener.csciframe.m_refreshPopupParams=a}else{if(b!=null){b.m_refreshPopupParams=a}}}if(m_parentparent.opener!=undefined&&m_parentparent.opener!=null){m_parentparent.opener.csciframe.refreshModel();if(m_parentparent.opener.csciframe.m_parentparent.isPopupPage!=true){m_parentparent.opener.csciframe.flushRefreshOccuranceQueue()}}else{if(b!=null){b.refreshModel();if(b.m_parentparent.isPopupPage!=true){b.flushRefreshOccuranceQueue()}}}}var mm_openPopupPAGE;function openPopupPAGE(h,a,e,k,d,b,j,g,f,c){if(mm_openPopupPAGE==null){mm_openPopupPAGE=CL().C_openPopupPAGE}return mm_openPopupPAGE.call(this,h,a,e,k,d,b,j,g,f,c)}function setContextMenuXYPAGE(b,a){if(b==0&&a==0){return}var c=findTHISCONTEXTMENU();if(c.style.display!="none"){return}if(m_direction=="rtl"){c.style.right=""+C_adjustUnits((parent.innerWidth-b-10))}else{c.style.left=""+C_adjustUnits((b-10))}c.style.top=""+C_adjustUnits((a-8))}function reactOnHelpPAGE(){if(checkIO()==false){return}if(parent.m_helpIdPAGE!=null&&parent.m_helpIdPAGE!=""){setPropertyValue("param2",parent.m_helpIdPAGE);invokeMethodInModel("reactOnHelpRequestForHelpId")}}function reactOnContextMenuRequestPAGE(a){if(checkIO()==false){return false}if(parent.m_contextMenuMethodPAGE==null){return true}setContextMenuXYPAGE(a.clientX,a.clientY);invokeMethodInModel(parent.m_contextMenuMethodPAGE);return false}function onBlurPAGE(a){if(checkIO()==false){return}CL().reactOnBlurPageCL(this)}var xxxxxxxxxx=0;function onFocusPAGE(a){if(checkIO()==false){return}CL().reactOnFocusPageCL(this)}function invokeFlushMethodPAGE(){if(parent.m_flushMethodPAGE!=null){m_suppressFocusManagementOncePAGE=true;invokeMethodInModel(parent.m_flushMethodPAGE)}}function addVersionInfoINTPOPUPCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("INTPOPUPCONTROLS")}var m_identIP;var m_visIP;var m_prevActElem;function iccINTPOPUP(){}function romuINTPOPUP(){var g=getPropertyValue("cISAddons.popupOpening");var b=getPropertyValue("cISAddons.popupClosing");var e=getFrmNameIP();initValuesIP(g,b);var d=null;if(m_visIP==true){d=getFrmDocIP(e);prepareDIR(d);m_identIP=getBIdentIP();initObjIP(d,e);var f=d.getElementById("IPO_"+getIdentIP("span"));f.CASA_innerspan=d.getElementById("IPI_"+getIdentIP("span"));initMozIP(f,g);initArrsIP(f,g);initPosIP(f,d);f.style.display="";f.CASA_innerspan.style.display="";disableInputElements()}if(m_visIP==false&&CL().CASA_popupopenersids.length>0){m_identIP=CL().CASA_popupopenersids[CL().CASA_popupopenersids.length-1];if(d==null){d=getFrmDocIP(e)}var a=d.getElementById("PDIV_"+m_identIP);if(a!=null){var f=d.getElementById("IPO_"+getIdentIP("span"));f.CASA_innerspan=d.getElementById("IPI_"+getIdentIP("span"));f.CASA_outdiv=a;f.style.display="none";f.CASA_innerspan.style.display="none";var c=CL().CASA_popupopenersvalues[CL().CASA_popupopenersvalues.length-1].csciframe;CL().CASA_buffSpanIP=f;clearSPageIP(c.parent);clearTBarIP(c.parent);clearFuncIP(c.parent);clearControlIP(c)}}}function unloadINTPOPUP(){if(CL()==null){return}if(CL().CASA_buffSpanIP==null){return}enableInputElements();if(CL().CASA_popupopenersids.length>0){CL().CASA_popupopenersids=removeIndexOfIP(CL().CASA_popupopenersids,CL().CASA_popupopenersids.length-1);CL().CASA_popupopenersvalues=removeIndexOfIP(CL().CASA_popupopenersvalues,CL().CASA_popupopenersvalues.length-1)}var a=CL().CASA_buffSpanIP;a.CASA_innerspan.parentNode.removeChild(a.CASA_innerspan);a.CASA_outdiv.parentNode.removeChild(a.CASA_outdiv);a.parentNode.removeChild(a);CL().CASA_buffSpanIP=null}function clearFuncIP(c){var b=getIdentIP("casaPage");var a=getIdentIP("title");c["reactOnModelUpdate"+a]=null;c.onExecuteItem=null;c["closePage"+a]=null;c["showPage"+b]=null;c["reactOnModelUpdate"+b]=null}function genFuncIP(){var d=getIdentIP("casaPage");var c=getIdentIP("title");parent["reactOnModelUpdate"+c]=function e(f){CL().romuTITLEBAR(parent["C_"+c])};parent.onExecuteItem=function a(){CL().onExecutePageItemTITLEBAR(this)};parent["closePage"+c]=function(){try{if(parent["CasaCASAPAGE"+d]!=null&&parent["CasaCASAPAGE"+d].WORKAREA.csciframe.checkAllValidations()==false){return}}catch(f){}if(parent["CasaCASAPAGE"+d]!=null){CL().closePagePopupTITLEBAR(parent["C_"+c],parent["CasaCASAPAGE"+d])}else{CL().closePageTITLEBAR(parent["C_"+c])}};parent["showPage"+d]=function(f,j,h,g){parent.C.showPageSUBCISPAGE14(parent["CasaCASADIV"+d],f,j,h,g)};parent["reactOnModelUpdate"+d]=function b(f){parent.C.reactOnModelUpdateSUBCISPAGE14(parent["CasaCASADIV"+d],parent["showPage"+d])}}function pointFocusAfterIP(){if(m_prevActElem!=null&&m_visIP==null){try{if(m_prevActElem.setActive){m_prevActElem.setActive()}else{m_prevActElem.focus()}m_prevActElem=null}catch(a){}}}function genIP(){var l=[];var e=getIdentIP("span");var n="IPO_"+e;var q=1000;var d="IPI_"+e;var p=1001;var c=getIdentIP("title");var g="TITLEBARTITLEBARTR"+c;var r="TITLEBARTITLEBAR"+c;var j="TITLEBARSPAN"+c;var f="TITLEBAR"+c+"PAGEPOPUPCOMMANDS";var k="TITLEBAR"+c+"CLOSE";var m=getIdentIP("intITR");var a="ITR"+m;var b=getIdentIP("casaPage");var s="CASADIV"+b;var h="CASAPAGE"+b;l.push("<span class='FLASHActive' id='"+n+"'  style='position:absolute;left:0;top:0;width:2000px;height:1500px;z-index:"+q+";'> </span>");l.push("<span id='"+d+"' style='position:absolute;left:-100px;top:-100px;width:100px; height:100px;z-index:"+p+";background-color: #FFFFFF; overflow: hidden; border: 1px #808080 solid;'>");l.push("<table height='100%' style='height: 100%' width='100%' cellpadding='0' cellspacing='0'>");l.push("<tr id='"+g+"'  style=' '>");l.push("<td colspan='50' width='100%' height='0' align='center'>");l.push("<table width='100%' cellspacing=0 cellpadding=0 class='INTPOPUPTable'>");l.push("<tr><td width='100%' class='INTPOPUPDragCell' onmousedown='return romDownIP("+d+", event);'>");l.push("<table id='"+r+"' width='100%' cellspacing=1 cellpadding=0 style='table-layout: fixed'>");l.push("<tr><td width='100%'  class='TDAroundControl'>");l.push("<div nowrap='true' class='INTPOPUPCell' style='overflow-x: hidden;' id='"+j+"'></div>");l.push("</td></tr></table></td>");l.push("<td width=0>");l.push("<table width=0 cellspacing=0 cellpadding=0>");l.push("<tr><td onmousedown='return romDownIP("+d+", event);' class='INTPOPUPDragCell'>&nbsp;</td>");l.push("<td id='"+f+"'></td>");l.push("<td id='"+k+"'  valign='middle' onmouseenter='if (C.checkIO() == false) return; C.CL().C_rollinIconROLLOVER(this);' onmouseleave=\"this.className = 'ICONImage';\" onclick='closePage"+c+"()'><div class='INTPOPUPCellClose'>&nbsp;</div>");l.push("</td></tr></table></td></tr></table></td></tr>");l.push("<tr id='"+a+"' style='background-color: #ACADAF'>");l.push("<td  valign='top' colspan='50' class='TDAroundControl' width='100%' height='1px'>");l.push("</td></tr>");l.push("<td colspan=1 rowspan=1 width='100%' height='100%' class='TDAroundControl'>");l.push("<div id='"+s+"' width='100%' height='100%' style='width:100%;height:100%'>");l.push("<iframe name='"+h+"' id='"+h+"' "+getTesttoolidHtml()+"='pagepopup"+getBIdentIP()+"' src='../servlet/StartCISPage?PAGEURL=../HTMLBasedGUI/general/blankpage.html&UNIQUEID=99&ONUNLOADBEHAVIOUR=NOTHING&CENTRALLIB=PP' class='SUBCISPAGEIframe' style=';border-width:0' width='100%' height='100%'></iframe>");l.push("</div></td></table></span>");return l.join("")}function clearSPageIP(c){var b=getIdentIP("casaPage");if(c["reactOnModelUpdate"+b]){c["reactOnModelUpdate"+b]()}var a=0;while(c["CasaCASAPAGE"+b].frames&&c["CasaCASAPAGE"+b].frames[a]!=null){c["CasaCASAPAGE"+b].frames[a].location.href="../servlet/StartCISPage?PAGEURL=../HTMLBasedGUI/general/blankpage.html&UNIQUEID=99&ONUNLOADBEHAVIOUR=NOTHING&CENTRALLIB=PP";a++}c.C.removeListener("romuINTPOPUPPAGE");c["CasaCASAPAGE"+b]=null;c["CasaCASADIV"+b]=null}function initSPageIP(c){var f=getIdentIP("casaPage");var b="CASADIV"+f;var a="CASAPAGE"+f;var d=null;if(c.getElementById(a)!=null){d=parent["CasaCASAPAGE"+f]=c.getElementById(a).contentWindow}var e=parent["CasaCASADIV"+f]=c.getElementById(b);parent.C.initCasaControlSUBCISPAGE14(e);e.CASA_page=d;e.CASA_divid=f;parent.C.registerListener(parent["reactOnModelUpdate"+f]);e.CASA_valueprop="cISAddons.ppsubcispage.page";e.CASA_processidprop="cISAddons.ppsubcispage.subsessionId";e.CASA_modelidprop="cISAddons.ppsubcispage.pageId";e.CASA_refreshprop="cISAddons.ppsubcispage.changeIndex"}function clearTBarIP(b){var a=getIdentIP("title");b.C.removeListener("romuINTPOPUPTB");b.C.enableInputElements();b["C_"+a]=null}function initTBarIP(b,d){var a="closeTitleBarPopup";var e="true";var c=getIdentIP("title");var f=b.getElementById("TITLEBARTITLEBARTR"+c);parent["C_"+c]=f;CL().iccTITLEBAR(parent.C,f,parent["reactOnModelUpdate"+c],c,"nextPopupTitle",null,null,null,null,null,"true",a,"nextPagePopupCommands",d,e);f.CASA_spancontrol=b.getElementById("TITLEBARSPAN"+c);f.CASA_wcimg=b.getElementById("TITLEBAR"+c+"CLOSE");if(f.CASA_wcimg){f.CASA_wcimg.C=f.C;f.CASA_wcimg.onclick=parent["closePage"+c]}f.CASA_img=b.getElementById("TITLEBAR"+c+"IMG");f.CASA_pagepopupcommandscontrol=b.getElementById("TITLEBAR"+c+"PAGEPOPUPCOMMANDS")}function getIdentIP(a){if(a=="pdiv"){return m_identIP+"_"+1}if(a=="title"){return m_identIP+"_"+2}if(a=="span"){return m_identIP+"_"+3}if(a=="intITR"){return m_identIP+"_"+4}if(a=="subITR"){return m_identIP+"_"+5}if(a=="casaPage"){return m_identIP+"_"+6}return m_identIP+"_0"}function getBIdentIP(){if(m_identIP!=null){return m_identIP}if(!CL().CASA_intcounter){CL().CASA_intcounter=0}return CL().CASA_intcounter++}function removeIndexOfIP(a,b){a.splice(b,1);return a}function clearControlIP(a){a.m_identIP=null;a.m_visIP=null}function getFrmNameIP(){return getPropertyValue("cISAddons.popupDivFrame")}function getFrmDocIP(a){var b=null;if(a!=null&&a!=""){b=CL().C_findFrame(this,a,true)}if(b==null){b=CL().C_findFrame(this,"_top",true)}if(b!=null){return extractContentWindow(b).document}else{return parent.document}}function isOpeningIP(a){return(a=="true")}function initObjIP(a,b){var c=a.getElementById("PDIV_"+m_identIP);if(c==null){c=a.createElement("div");c.id="PDIV_"+m_identIP;c.innerHTML=genIP();a.body.appendChild(c);genFuncIP();initTBarIP(a,b);initSPageIP(a)}}function initMozIP(b,a){if(isOpeningIP(a)){b.style.position="absolute";b.style.left="0";b.style.top="0";b.style.width="100%";b.style.height="100%"}}function initPosIP(a,h){var j=getPropertyValue("cISAddons.ppintpopup.width");var f=getPropertyValue("cISAddons.ppintpopup.height");var k=getPropertyValue("cISAddons.ppintpopup.top");var c=getPropertyValue("cISAddons.ppintpopup.left");try{if(j==null||j==""){j=a.CASA_width}a.CASA_innerspan.style.width=C_adjustUnits(j);if(f==null||f==""){f=a.CASA_height}a.CASA_innerspan.style.height=C_adjustUnits(f)}catch(b){}try{var n=parent.innerHeight;var g=parent.innerWidth;if(h!=null){var e=h.body;if(e&&e.clientHeight&&e.clientWidth){n=e.clientHeight;g=e.clientWidth}}if(c==null||c==""){var d=Math.floor((g-j*1)/2);a.CASA_innerspan.style.left=C_adjustUnits(d)}else{vLeft=parseInt(c);if(vLeft>(g-j)){vLeft=g-j}if(vLeft<0){vLeft=0}a.CASA_innerspan.style.left=C_adjustUnits(vLeft)}if(k==null||k==""){var m=Math.floor((n-f*1)/2);a.CASA_innerspan.style.top=C_adjustUnits(m)}else{vTop=parseInt(k);if(vTop>(n-f)){vTop=n-f}if(vTop<0){vTop=0}a.CASA_innerspan.style.top=C_adjustUnits(vTop)}}catch(b){}}function initArrsIP(b,a){if(isOpeningIP(a)){CL().CASA_popupopenersids[CL().CASA_popupopenersids.length]=m_identIP;CL().CASA_popupopenersvalues[CL().CASA_popupopenersvalues.length]=parent;b.style.zIndex=1001+CL().CASA_popupopenersids.length*2;b.CASA_innerspan.style.zIndex=1002+CL().CASA_popupopenersids.length*2}}function initValuesIP(c,a){if(c=="true"){m_visIP=true;try{m_prevActElem=parent.document.activeElement}catch(b){}}if(a=="true"){m_visIP=false}if(CL().CASA_popupopenersvalues==null){CL().CASA_popupopenersvalues=new CL().Array()}if(CL().CASA_popupopenersids==null){CL().CASA_popupopenersids=new CL().Array()}}var m_ccDisable;var m_ccDisplOpac;var m_bodyDisable;var m_bodyDisplOpac;var m_divDisable;var m_divDisplOpac;var m_buttonDisable;var m_buttonDisplOpac;var m_inputDisable;var m_inputDisplOpac;var m_selectDisable;var m_selectDisplOpac;var m_textareaDisable;var m_textareaDisplOpac;var m_optgroupDisable;var m_optgroupDisplOpac;var m_optionDisable;var m_optionDisplOpac;var m_fieldsetDisable;var m_fieldsetDisplOpac;var m_bDoDisable="true";function disableInputElements(){if(getPropertyValue("cISAddons.popupparentdisabled")=="false"){return}if(m_bDoDisable=="true"){var j="0.7";var b=parent.document.getElementsByTagName("button");m_buttonDisable=new Array(b.length);m_buttonDisplOpac=new Array(b.length);for(var g=0;g<b.length;g++){m_buttonDisable[g]=b[g].disabled;b[g].disabled=m_bDoDisable;m_buttonDisplOpac[g]=b[g].style.opacity;b[g].style.opacity=j}var k=parent.document.getElementsByTagName("input");m_inputDisable=new Array(k.length);m_inputDisplOpac=new Array(k.length);for(var g=0;g<k.length;g++){m_inputDisable[g]=k[g].disabled;k[g].disabled=m_bDoDisable;m_inputDisplOpac[g]=k[g].style.opacity;k[g].style.opacity=j}var e=parent.document.getElementsByTagName("select");m_selectDisable=new Array(e.length);m_selectDisplOpac=new Array(e.length);for(var g=0;g<e.length;g++){m_selectDisable[g]=e[g].disabled;e[g].disabled=m_bDoDisable;m_selectDisplOpac[g]=e[g].style.opacity;e[g].style.opacity=j}var l=parent.document.getElementsByTagName("textarea");m_textareaDisable=new Array(l.length);m_textareaDisplOpac=new Array(l.length);for(var g=0;g<l.length;g++){m_textareaDisable[g]=l[g].disabled;l[g].disabled=m_bDoDisable;m_textareaDisplOpac[g]=l[g].style.opacity;l[g].style.opacity=j}var d=parent.document.getElementsByTagName("optgroup");m_optgroupDisable=new Array(d.length);m_optgroupDisplOpac=new Array(d.length);for(var g=0;g<d.length;g++){m_optgroupDisable[g]=d[g].disabled;d[g].disabled=m_bDoDisable;m_optgroupDisplOpac[g]=d[g].style.opacity;d[g].style.opacity=j}var a=parent.document.getElementsByTagName("option");m_optionDisable=new Array(a.length);m_optionDisplOpac=new Array(a.length);for(var g=0;g<a.length;g++){m_optionDisable[g]=a[g].disabled;a[g].disabled=m_bDoDisable;m_optionDisplOpac[g]=a[g].style.opacity;a[g].style.opacity=j}var m=parent.document.getElementsByTagName("fieldset");m_fieldsetDisable=new Array(m.length);m_fieldsetDisplOpac=new Array(m.length);for(var g=0;g<m.length;g++){m_fieldsetDisable[g]=m[g].disabled;m[g].disabled=m_bDoDisable;m_fieldsetDisplOpac[g]=m[g].style.opacity;m[g].style.opacity=j}var f=parent.document.getElementsByName("CC");m_ccDisable=new Array(f.length);m_ccDisplOpac=new Array(f.length);for(var g=0;g<f.length;g++){m_ccDisable[g]=f[g].disabled;f[g].disabled=m_bDoDisable;m_ccDisplOpac[g]=f[g].style.opacity;f[g].style.opacity=j}var h=parent.document.getElementsByTagName("body");m_bodyDisable=new Array(h.length);m_bodyDisplOpac=new Array(h.length);for(var g=0;g<h.length;g++){m_bodyDisable[g]=h[g].disabled;h[g].disabled=m_bDoDisable;m_bodyDisplOpac[g]=h[g].style.opacity;h[g].style.opacity=j}var c=parent.document.getElementsByTagName("div");m_divDisable=new Array(c.length);m_divDisplOpac=new Array(c.length);for(var g=0;g<c.length;g++){m_divDisable[g]=c[g].disabled;c[g].disabled=m_bDoDisable;m_divDisplOpac[g]=c[g].style.opacity;c[g].style.opacity=j}m_bDoDisable="false"}}function enableInputElements(){if(getPropertyValue("cISAddons.popupparentdisabled")=="false"){return}if(m_bDoDisable=="false"){var d=parent.document.getElementsByTagName("div");for(var f=0;f<d.length;f++){d[f].disabled=m_divDisable[f];d[f].style.opacity=m_divDisplOpac[f]}var h=parent.document.getElementsByTagName("body");for(var f=0;f<h.length;f++){h[f].disabled=m_bodyDisable[f];h[f].style.opacity=m_bodyDisplOpac[f]}var g=parent.document.getElementsByName("CC");if(g.length==m_ccDisable.length){for(var f=0;f<g.length;f++){g[f].disabled=m_ccDisable[f];g[f].style.opacity=m_ccDisplOpac[f]}}else{for(var f=0;f<g.length;f++){g[f].disabled="false";g[f].style.opacity="1"}}var b=parent.document.getElementsByTagName("button");for(var f=0;f<b.length;f++){b[f].disabled=m_buttonDisable[f];b[f].style.opacity=m_buttonDisplOpac[f]}var j=parent.document.getElementsByTagName("input");for(var f=0;f<j.length;f++){j[f].disabled=m_inputDisable[f];j[f].style.opacity=m_inputDisplOpac[f]}var e=parent.document.getElementsByTagName("select");for(var f=0;f<e.length;f++){e[f].disabled=m_selectDisable[f];e[f].style.opacity=m_selectDisplOpac[f]}var k=parent.document.getElementsByTagName("textarea");for(var f=0;f<k.length;f++){k[f].disabled=m_textareaDisable[f];k[f].style.opacity=m_textareaDisplOpac[f]}var c=parent.document.getElementsByTagName("optgroup");for(var f=0;f<c.length;f++){c[f].disabled=m_optgroupDisable[f];c[f].style.opacity=m_optgroupDisplOpac[f]}var a=parent.document.getElementsByTagName("option");for(var f=0;f<a.length;f++){a[f].disabled=m_optionDisable[f];a[f].style.opacity=m_optionDisplOpac[f]}var l=parent.document.getElementsByTagName("fieldset");for(var f=0;f<l.length;f++){l[f].disabled=m_fieldsetDisable[f];l[f].style.opacity=m_fieldsetDisplOpac[f]}m_ccDisable.length=0;m_ccDisplOpac.length=0;m_bodyDisable.length=0;m_bodyDisplOpac.length=0;m_divDisable.length=0;m_divDisplOpac.length=0;m_buttonDisable.length=0;m_buttonDisplOpac.length=0;m_inputDisable.length=0;m_inputDisplOpac.length=0;m_selectDisable.length=0;m_selectDisplOpac.length=0;m_textareaDisable.length=0;m_textareaDisplOpac.length=0;m_optgroupDisable.length=0;m_optgroupDisplOpac.length=0;m_optionDisable.length=0;m_optionDisplOpac.length=0;m_fieldsetDisable.length=0;m_fieldsetDisplOpac.length=0;m_bDoDisable="true"}}function addVersionInfoSUBCISPAGECONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("SUBCISPAGECONTROLS")}var m_SUBCISPAGEshowpagemethod;function initCasaControlSUBCISPAGE14(a){a.CASA_memPageURL=undefined;a.CASA_memProcessId=undefined;a.CASA_memModelId=undefined;a.CASA_memSessionId=undefined;a.CASA_memRefresh=undefined;a.CASA_refreshprop=undefined}function reactOnModelUpdateSUBCISPAGE14(c,e){var f=getPropertyValue(c.CASA_valueprop);var f=convertCasabacURL(f);if(f==null||f==""){f="../HTMLBasedGUI/general/blankpage.html"}var j=null;if(c.CASA_processidprop!=null){j=getPropertyValue(c.CASA_processidprop)}if(j==null||j=="inittini"){j=parent.parent.getCurrentProcessId()}var g=null;if(c.CASA_modelidprop!=null){g=getPropertyValue(c.CASA_modelidprop)}if(g==null||g=="inittini"){g=parent.parent.getCurrentModelId()}var a=null;if(c.CASA_sessionidprop!=null){a=getPropertyValue(c.CASA_sessionidprop)}if(a==null||a=="inittini"){a=parent.parent.getCurrentSessionId()}var b=getPropertyValue(c.CASA_refreshprop);var h=false;if(c.CASA_memPageURL!=f||c.CASA_memProcessId!=j||c.CASA_memModelId!=g||c.CASA_memSessionId!=a){c.CASA_memPageURL=f;c.CASA_memProcessId=j;c.CASA_memModelId=g;c.CASA_memSessionId=a;c.CASA_memRefresh=b;m_SUBCASAPAGEpageURL=f;m_SUBCASAPAGEprocessId=j;m_SUBCASAPAGEmodelId=g;m_SUBCASAPAGEsessionId=a;m_SUBCASAPAGEcasacontrol=c;m_SUBCISPAGEshowpagemethod=e;h=true;continueSUBCISPAGE14()}if(c.CASA_refreshprop!=null&&h==false){if(b!=c.CASA_memRefresh||b=="true"){var d=getPropertyValue("cISAddons.noResponse");if(d=="true"){addLogMessage("reactOnModelUpdateSUBCISPAGE14(): no refresh - adapter sends noResponse==true")}else{c.CASA_page.refreshModel()}}c.CASA_memRefresh=b}}function continueSUBCISPAGE14(){m_SUBCISPAGEshowpagemethod(m_SUBCASAPAGEpageURL,m_SUBCASAPAGEmodelId,m_SUBCASAPAGEsessionId,m_SUBCASAPAGEprocessId)}function showPageSUBCISPAGE14(c,h,j,e,a){var b="";try{var d=h.indexOf("&");if(d>0&&h.indexOf("StartDynamicPage?")<0&&h.indexOf("StartDynamicContent?")<0){c.CASA_page.pageInitParam=h.substring(d+1,h.length);b="&"+c.CASA_page.pageInitParam;h=h.substring(0,d)}}catch(k){}try{if(h.indexOf("/")<0){var g=parent.location.href;h=g.substring(0,g.lastIndexOf("/"))+"/"+h}else{h=h.substring(1,h.length);while(true){if(h.charAt(0)!="/"){h=h.substring(1,h.length)}else{break}}var f=parent.location.href;f=f.substring(0,f.lastIndexOf("/"));f=f.substring(0,f.lastIndexOf("/"));h=f+h}c.CASA_page.showPage(h,j,e,a)}catch(k){setTimeout('showPageSUBCISPAGE("'+c.CASA_page.name+'", "'+h+'","'+j+'","'+e+'","'+a+'")',200)}}function showPageSUBCISPAGE(a,c,f,e,d){var b=parent.frames[a];if(b==null){b=getFrameSUBCISPAGE(a)}if(b==null){return}if(b.document.readyState!="complete"){setTimeout('showPageSUBCISPAGE("'+a+'","'+c+'","'+f+'","'+e+'","'+d+'")',200);return}if(b.showPage){b.showPage(c,f,e,d)}}function getFrameSUBCISPAGE(e){var b=null;try{var c=getPropertyValue("cISAddons.popupDivFrame");var d=null;if(c!=null&&c!=""){d=CL().C_findFrame(this,c,true)}if(d==null){d=CL().C_findFrame(this,"_top",true)}if(d!=null){b=extractContentWindow(d).frames[e]}}catch(a){}return b}function addVersionInfoHOTKEYCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("HOTKEYCONTROLS")}function iccHOTKEY(e,c){e.CASA_doTextIdReplacement=true;e.CASA_hotkeys=[];var b=decodeCSVString(c);for(var a=0;a<b.length;a+=2){var d=newHOTKEY(b[a]);if(d==null){continue}d.method=b[a+1];e.CASA_hotkeys.push(d);registerInternal(e,d)}}function registerWPKeys(d){var b=getPropertyValue("cISAddons.workplaceHotkeys");if(b==null){return}if(d.CASA_hotkeys==null){d.CASA_hotkeys=[]}var a=decodeString(b,";");if(a.length!=2){return}var c=newHOTKEY(a[0]);c.method="switchToNextActivity";d.CASA_hotkeys.push(c);registerInternal(d,c);var c=newHOTKEY(a[1]);c.method="switchToPreviousActivity";d.CASA_hotkeys.push(c);registerInternal(d,c)}function registerInternal(c,b){var a=c.CASA_id;if(a==null){a=c.id}addHotKeyWithControlScope(b.keyCode,b.ctrlKey,b.shiftKey,b.altKey,b.method,"CONTROL #"+a)}function iccKEY(e){var c=getPropertyValue("cISAddons.valueHelpKeys");if(c==null){return}if(e.CASA_hotkeys==null){e.CASA_hotkeys=[]}var a=decodeString(c,";");for(var b=0;b<a.length;b++){var d=newHOTKEY(a[b]);if(d==null){continue}d.method="javascript:reactOnValueHelpFIELD";e.CASA_hotkeys.push(d);registerInternal(e,d)}}function newHOTKEY(c){var a=decodeString(c,"-");var e=new Object();e.ctrlKey=false;e.altKey=false;e.shiftKey=false;for(var b=0;b<a.length;b++){var d=a[b];if(d=="ctrl"){e.ctrlKey=true}else{if(d=="alt"){e.altKey=true}else{if(d=="shift"){e.shiftKey=true}else{e.keyCode=d}}}}if(e.keyCode!=null){return e}return null}function reactOnKeyDownHOTKEY(a,j){if(a.CASA_doTextIdReplacement==true){a.CASA_doTextIdReplacement=false;replaceTExtIdsHOTKEYS(a)}if(j.keyCode==13&&j.ctrlKey==false&&j.shiftKey==false&&j.altKey==false&&getPropertyValue("cISAddons.hE")==1){addLogMessage("Hotkey Managment: ENTER hot key suppressed because HOTKEYSEnterMode is disabled");return}for(var d=0;d<a.CASA_hotkeys.length;d++){var k=a.CASA_hotkeys[d];if(j.keyCode==k.keyCode&&j.ctrlKey==k.ctrlKey&&j.shiftKey==k.shiftKey&&j.altKey==k.altKey){try{parent.document.body.focus();var b=findSrcElement(j);try{b.focus()}catch(g){}}catch(c){}if(k.method.indexOf("javaScript:")==0||k.method.indexOf("javascript:")==0){var e=k.method.substring(11,k.method.length);try{this[e](a,j,true)}catch(l){var h="";for(id in l){h+=l[id]+"\n"}alert("ERROR when calling function "+e+"\n\n"+h)}}else{setTimeout('invokeMethodInModel("'+k.method+'")',20)}return true}}return false}function replaceTExtIdsHOTKEYS(b){for(var a=0;a<b.CASA_hotkeys.length;a++){if(b.CASA_hotkeys[a].keyCode.charAt(0)=="$"){b.CASA_hotkeys[a].keyCode=getPropertyValue(b.CASA_hotkeys[a].keyCode)}}}function addVersionInfoAREACONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("AREACONTROLS")}function iccAREA(d,a,b,j,n,l,m,f,g,e,k,c,h){d.CASA_id=a;d.CASA_areaIsFolded=false;d.CASA_timeout=null;if(j=="true"){d.CASA_areaIsFolded=true}if(b!=null){d.CASA_foldedprop=b}if(n!=null){d.CASA_foldableprop=n}d.CASA_flush=k;d.CASA_flushmethod=c;d.CASA_memVisible=undefined;d.CASA_memName=undefined;if(l!=null){d.CASA_visibleprop=l}d.CASA_tr=parent.gebid("TRAREA"+a);d.CASA_td=parent.gebid("TDAREA"+a);d.CASA_span=parent.gebid("$"+a);d.CASA_height=m;if(f!=null){d.CASA_toggleimg=f}if(g!=null){d.CASA_nameprop=g}if(e!=null){d.CASA_memImage=undefined;d.CASA_imageprop=e;d.CASA_img=parent.gebid("AREAIMG_"+a)}else{d.CASA_fadedtoggling=false}d.CASA_steps=4;d.CASA_tout=20;d.CASA_memFoldedSTATUS=null;d.CASA_withleftborder=h}function romuAREA(d){if(d.CASA_foldedprop!=null){var b=getPropertyValue(d.CASA_foldedprop);if(b!=null){if(b!=(""+d.CASA_memFoldedSTATUS)){d.CASA_areaIsFolded=false;if(b=="false"){d.CASA_areaIsFolded=true}toggleAreaAREA(d,false,null,d.CASA_toggleimg)}}}if(d.CASA_foldableprop!=null){var b=getPropertyValue(d.CASA_foldableprop);if(b!=null){if(b!=d.CASA_memFoldableSTATUS){d.CASA_memFoldableSTATUS=b;if(b=="false"){if(d.CASA_toggleimg!=null){d.CASA_toggleimg.style.display="none"}}else{if(d.CASA_toggleimg!=null){d.CASA_toggleimg.style.display=""}}}}}if(d.CASA_visibleprop!=null){var b=findVisibleValue(getPropertyValue(d.CASA_visibleprop));if(b!=null&&d.CASA_memVisible!=b){d.CASA_memVisible=b;b=convertStatusToVisible(b,CONTROLTYPE_CONTAINER);if(b!="false"){d.CASA_tr.style.display=""}else{d.CASA_tr.style.display="none"}}}if(d.CASA_nameprop!=null){var b=getPropertyValue(d.CASA_nameprop);if(b!=null&&d.CASA_memName!=b){d.CASA_memName=b;d.CASA_span.innerHTML=b}}if(d.CASA_imageprop!=null){var b=getPropertyValue(d.CASA_imageprop);if(b!=null&&d.CASA_memImage!=b){d.CASA_memImage=b;d.CASA_img.src=b}}if(d.CASA_memDirection==null&&m_direction=="ltr"){d.CASA_memDirection=m_direction}if(d.CASA_memDirection!=m_direction){try{if(d.CASA_withleftborder!="false"&&d.CASA_ltc==null){d.CASA_ltc=parent.gebid("AREALTC_"+d.CASA_id);if(d.CASA_ltc!=null){d.CASA_ltcClass=d.CASA_ltc.className}}if(d.CASA_ltc!=null){var a=d.CASA_ltcClass;if(m_direction=="rtl"){a+="RTL"}d.CASA_ltc.className=a}}catch(c){}d.CASA_memDirection=m_direction}}function getCounterHeightAREA(c,a){var b=(c.CASA_counterh*(100/c.CASA_steps));return((a*b)/100)}function toggleAreaAREA(g,f,b,e){if(b!=null){var d=findSrcElement(b);if(d!=null&&d.id!=null&&d.id.indexOf("ICON")>=0){return}}if(g.CASA_memFoldableSTATUS=="false"){return}g.CASA_areaIsFolded=!g.CASA_areaIsFolded;if(""+g.CASA_areaIsFolded==""+g.CASA_memFoldedSTATUS){return}g.CASA_memFoldedSTATUS=g.CASA_areaIsFolded;if(e!=null){var c="AREAToggleImg";if(g.CASA_stylevariant!=null){c="AREA"+g.CASA_stylevariant+"ToggleImg"}if(g.CASA_areaIsFolded){c+="Folded"}e.className=c}var a=g.CASA_fadedtoggling;if(getPropertyValue("cISAddons.anc")=="false"){a=false}if(g.CASA_areaIsFolded==true){g.style.display="none";if(g.CASA_height!=null){g.CASA_td.height=""}}else{g.style.display="";if(g.CASA_height!=null){g.CASA_td.height=g.CASA_height}}if(f==true){if(g.CASA_foldedprop!=null){setPropertyValue(g.CASA_foldedprop,""+g.CASA_areaIsFolded)}if(g.CASA_flushmethod!=null){m_displayOccupied=false;invokeMethodInModel(g.CASA_flushmethod)}else{if(g.CASA_flush=="server"){m_displayOccupied=false;submitModel("submit")}else{if(g.CASA_flush=="screen"){updateModelListenersS()}else{m_displayOccupied=false;invokeMethodInModel("__ZZZinternalProcessDefault")}}}}}function addVersionInfoBREADCRUMBCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("BREADCRUMBCONTROLS")}function iccBREADCRUMB(g,f,e,d,b,a,c){g.CASA_id=f;g.CASA_breadcrumbprop=d;registerListener(e);if(b!=null){g.CASA_cti=b}if(a!=null){g.CASA_breadcrumbstyle=a}if(c!=null){g.CASA_pixeldistance=c}g.CASA_prevChangeIndex=undefined}function romuBREADCRUMB(h){var f=getPropertyValue(h.CASA_breadcrumbprop+".changeIndex");if(h.CASA_prevChangeIndex!=undefined&&h.CASA_prevChangeIndex==f&&h.CASA_memDirection==m_direction){return}h.CASA_prevChangeIndex=f;h.CASA_memDirection=m_direction;var c=[];c.push("<table cellpadding=0 cellspacing=0 border=0 >");var j=0;var k=[];var a=0;if(h.CASA_pixeldistance!=null){try{a=h.CASA_pixeldistance*1}catch(q){}}var r="";if(h.CASA_breadcrumbstyle!=null){r=h.CASA_breadcrumbstyle}var e="";if(m_direction=="rtl"){e="RTL"}while(true){var d=h.CASA_breadcrumbprop+".items["+j+"].";vText=getPropertyValue(d+"text");if(vText==null){break}if(j>0){c.push("<td>");c.push("<div class='BREADCRUMBCell"+e+"'>&nbsp;</div>");c.push("</td>")}vStyle=getPropertyValue(d+"style");vClass="BREADCRUMBInput";var n=getPropertyValue(d+"tooltip");if(n!=null&&n!=""){n="title='"+convertApos(n)+"'"}if(j!=0&&a!=0){c.push("<td><div style='font-size: 1px; width: "+C_adjustUnits(a)+"'></div></td>")}var m="CasaBREADCRUMB"+h.CASA_id+"BUTTON"+j;var g="onmouseover='if (C.checkIO() == false) return false; this.className = \"BREADCRUMBInputRolledIn\"' onmouseout='this.className = \"BREADCRUMBInputRolledOut\";'";c.push("<td>");c.push("<a id='"+m+"' "+n+" style='"+vStyle+";"+r+"' class='"+vClass+"' "+g+" onclick='invokeBreadcrumb"+h.CASA_id+"("+j+")'>");c.push(vText);c.push("</a>");c.push("</td>");if(a!=0){c.push("<td><div style='font-size: 1px; width: "+C_adjustUnits(a)+"'></div></td>")}k.push(m);j++}c.push("</table>");h.innerHTML=c.join("");if(h.CASA_cti!=null&&h.CASA_tabindex!=null){for(var l=0;l<k.length;l++){var p=parent.gebid(k[l]);p.CASA_cti=h.CASA_cti;p.CASA_tabindex=h.CASA_tabindex;applyCasaTabIndex(p,"BREADCRUMB")}}}function invokeBreadcrumb(c,b){if(checkIO()==false){return}var a=c.CASA_breadcrumbprop+".items["+b+"].execute";invokeMethodInModel(a)}function addVersionInfoLABELCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("LABELCONTROLS")}function flexCreateControlLABEL(d){var b=d.width;var g=d.CONTROLID;var e="LABELCellNormal";if(d.asheadline=="true"){e="LABELCellHeadline"}if(d.asplaintext=="true"){e="LABELCellPlainText"}if(d.stylevariant!=null){e="LABELCell"+d.stylevariant}var h=parent.createElement("TD");h.style.width=0;if(d.width=="100%"){h.style.width="100%"}h.className=e;if(d.colspan!=null){h.colSpan=d.colspan}if(d.rowspan!=null){h.rowSpan=d.rowspan}if(d.valign!=null){h.vAlign=d.valign}if(d.align!=null){h.align=d.align}if(d["background-color"]!=null){h.style.backgroundColor=d["background-color"]}if(d.title!=null){h.title=d.title}var c=parent.createElement("DIV");c.id="CF_"+g;c.style.width=C_adjustUnits(b);if(d.cuttext=="true"||d.nowrap=="true"){c.style.whiteSpace="nowrap"}if(d.textalign!=null){c.style.textAlign=d.textalign}var a="&nbsp;";if(d.name!=null){a=d.name}hotKeyCode=findHotkeyKeycode(a);if(hotKeyCode!=null){var f=parent.createFunction("rohk"+g,"param","C.rohkLABEL(CF_"+g+");");addControlBasedHotKey(c.id,hotKeyCode,f);a=convertDoubleTildeToUTag(a)}c.innerHTML=a;h.appendChild(c);var j=new Object();j.cell=h;j.control=c;return j}function flexRemoveLABEL(a){removeHotKeys(a)}function initCasaControlLABEL(a){a.CASA_memvpv=undefined;a.CASA_memnpv=undefined}function reactOnModelUpdateLABEL(a){if(a==null){return}var b=getPropertyValue(a.CASA_nameprop);var c=getPropertyValue(a.CASA_visibleprop);if((a.CASA_memnpv!=undefined&&a.CASA_memnpv==b)&&(a.CASA_memvpv!=undefined&&a.CASA_memvpv==c)){return}a.CASA_memnpv=b;a.CASA_memvpv=c;if(a.CASA_memnpv!=null){a.textContent=a.CASA_memnpv}if(c=="false"||c=="INVISIBLE"){a.CASA_div.style.display="none";if(a.className!=null){a.CASA_memClassName=a.className}a.className=null}else{a.CASA_div.style.display="";if(a.CASA_memClassName!=null){a.className=a.CASA_memClassName}a.CASA_memClassName=null}if((c=="false"||c=="INVISIBLE")&&(a.CASA_invisiblemode==null||a.CASA_invisiblemode=="invisible")){a.style.display="none"}else{a.style.display=""}if(c=="DISPLAY"){a.CASA_div.className="LABELDivTextDisabled"}else{a.CASA_div.className="LABELDivText"}}function rohkLABEL(a,b){focusNextInput(a)}function registerOnClickLABEL(b,a){if(a!=null){b.onclick=a;b.style.cursor="pointer"}}function addVersionInfoFIELDCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("FIELDCONTROLS")}var m_leftFIELD;var m_topFIELD;var m_widthFIELD;var m_heightFIELD;var m_controlFIELD;var m_valuehelpKeyCodeFIELD;function flexCreateControlFIELD(a){return CL().C_flexCreateControlFIELD(this,a)}function flexRemoveFIELD(a){parent[a].CASA_td=null;parent[a]=undefined;parent["romu"+a]=undefined;parent["rf"+a]=undefined;removePropertyListener(a)}function iccFIELD(P,T,g,r,x,D,q,a,n,c,aa,y,W,b,Q,S,e,U,d,C,O,h,ad,X,V,A,N,p,Z,J,E,aj,R,Y,af,j,G,m,w,I,ae,s,ak,ai,M,ac,ag,ab,B,al,t,f,l,z,k,u,F,H){P.onfocus=g;P.onblur=g;P.onchange=g;P.onkeydown=g;P.onkeyup=g;P.onkeypress=g;P.onmouseup=g;P.onmousedown=g;P.ondrop=g;if(!ak){P.oncontextmenu=g}addFocusable(P,true);startFocusCell(P);P.tabIndex=0;registerPropertyListener(T,r,P.id);registerPropertyListener(T,x,P.id);registerStatusPropertyListener(T,D,P.id,P);registerPropertyListener(T,aa,P.id);registerPropertyListener(T,e,P.id);registerPropertyListener(T,C,P.id);registerPropertyListener(T,O,P.id);registerPropertyListener(T,A,P.id);registerPropertyListener(T,Z,P.id);registerPropertyListener(T,G,P.id);registerPropertyListener(T,m,P.id);registerPropertyListener(T,f,P.id);registerPropertyListener(T,ab,P.id);if(y=="date"){registerPropertyListener(T,"dateDisplay",P.id);if(z=="true"){P.CASA_isnatPage=true}}if(y=="time"){registerPropertyListener(T,"timeDisplay",P.id)}P.CASA_valueprop=r;if(l!=null){P.CASA_contextmenumethod=l}if(x!=null){P.CASA_valuetextprop=x}if(D!=null){P.CASA_statusprop=D}if(q!=null){P.CASA_flush=q}if(a!=null){P.CASA_flushmethod=a}if(n!=null){P.CASA_flushindexprop=n}if(c!=null){P.CASA_popupmethod=c}if(R!=null){P.CASA_popupicon=R}if(aa!=null){P.CASA_popupprop=aa}if(y!=null){P.CASA_datatype=y}else{P.CASA_datatype=undefined}if(W!=null){P.CASA_displayonly=W}if(b!=null){P.CASA_helptext=b}if(Q!=null){P.CASA_uppercase=Q}if(S!=null){P.CASA_validation=S}if(e!=null){P.CASA_validationprop=e}if(U!=null){P.CASA_keybwithdindisplaystatus=U}if(d!=null){P.CASA_helpid=d}if(C!=null){P.CASA_decimaldigitsprop=C}if(O!=null){P.CASA_optarrayprop=O}if(h!=null){P.CASA_validationuserhint=h}if(ad!=null){P.CASA_textidmode=ad}if(X!=null){P.CASA_popupinputonly=X}else{P.CASA_popupinputonly="false"}if(V!=null){P.CASA_touchpadinput=V}else{P.CASA_touchpadinput=false}if(A!=null){P.CASA_titleprop=A}if(N!=null){P.CASA_popuponalt40=N}if(p!=null){P.CASA_validationuserhintprop=p}if(Z!=null){P.CASA_bgcolorprop=Z}if(J!=null){P.CASA_cti=J}if(E!=null){P.CASA_tabindex=E}if(aj!=null){P.CASA_invisiblemode=aj}if(Y!=null){P.CASA_decimaldigits=Y}if(af!=null){P.CASA_popupcombowidth=af}if(G!=null){P.CASA_fgcolorprop=G}if(m!=null){P.CASA_maxlengthprop=m}if(f!=null){P.CASA_lengthprop=f}if(I!=null){P.CASA_autocallpopupmethod=I}if(ag!=null){P.CASA_autocallpopupmethodoffset=ag}if(ab!=null){P.CASA_displayprop=ab}if(ac!=null){P.CASA_takeoutFieldPopupIcon=ac}if(al!=null){P.CASA_alwaysflush=al}if(t!=null){P.CASA_autotab=t}if(B!=null){P.CASA_editmask=B}if(ae!=null){P.CASA_validationrules=ae;m_validationRules.push(ae)}if(ai!=null){P.CASA_digits=ai}if(M!=null){P.CASA_digitsprop=M}P.CASA_stylevariant=null;if(H!=null){P.CASA_stylevariant=H}P.CASA_lastValue=undefined;P.CASA_lastStatus=undefined;P.CASA_lastPopup=undefined;P.CASA_lastText=undefined;P.CASA_lastControlValue=undefined;P.m_lastDir="ltr";var L=P;for(var ah=0;ah<j;ah++){if(L.parentNode!=null){L=L.parentNode}else{break}}P.CASA_td=L;if(w!=null){iccHOTKEY(P,w)}if(s!=null){P.CASA_formula=s;m_formulas.push(s)}m_FieldsArray.push(P);if(u!=null){P.CASA_autocompletedisplayname=u}if(F!=null){P.CASA_autocompletedisplayref=F}if(k!=null){P.CASA_autocompleteref=k;var K=parent.document.getElementsByName(k);if(K.length>0){registerPropertyListener(T,K[0].CASA_autocomplete.sourcelocationprop,P.id);registerPropertyListener(T,K[0].CASA_autocomplete.sourceprop,P.id)}}}function initCasaControlFIELD(a){a.CASA_lastValue=undefined;a.CASA_lastStatus=undefined;a.CASA_lastPopup=undefined;a.CASA_lastText=undefined;a.CASA_lastControlValue=undefined;a.m_lastDir=null;a.CASA_lastTitle=undefined}function reactOnModelUpdateFIELD(a,b){return romuFIELD(a,b)}function romuFIELD(f,C){if(f==null){return}if(f.CASA_autocompleteref!=null){var D=parent.document.getElementsByName(f.CASA_autocompleteref);if(D.length>0){D[0].CASA_autocomplete.updateautocomplete(f)}}if(f.CASA_keyinited!=true){if(f.CASA_popupmethod!=null){iccKEY(f)}f.CASA_keyinited=true}if(f.CASA_defaultbgcolor==null){f.CASA_defaultbgcolor=f.style.backgroundColor;if(f.CASA_defaultbgcolor==null){f.CASA_defaultbgcolor=""}}if(f.CASA_defaultfgcolor==null){f.CASA_defaultfgcolor=f.style.color;if(f.CASA_defaultfgcolor==null){f.CASA_defaultfgcolor=""}}var h=getPropertyValue(f.CASA_valueprop);var m=null;if(f.CASA_statusprop!=null){m=getPropertyValue(f.CASA_statusprop)}if(h==null){m=null}if(f.CASA_displayprop!=null){var z=getPropertyValue(f.CASA_displayprop);m=applyDisplayProperty(z,m)}var w=null;if(f.CASA_popupprop!=null){w=getPropertyValue(f.CASA_popupprop)}var n=null;if(f.CASA_valuetextprop!=null){n=getPropertyValue(f.CASA_valuetextprop)}else{if(f.CASA_optarrayprop!=null){var x=0;var B=h;if(f.CASA_datatype!=null&&f.CASA_datatype=="float"){B=""+parseFloat(h)}while(true){var A=getPropertyValue(f.CASA_optarrayprop+"["+x+"].id");if(A==null){break}if(f.CASA_datatype!=null&&f.CASA_datatype=="float"){A=""+parseFloat(A)}if(A==B){n=getPropertyValue(f.CASA_optarrayprop+"["+x+"].name");if(n==null){n=getPropertyValue(f.CASA_optarrayprop+"["+x+"].text")}break}x++}}}var c=-1;if(f.CASA_decimaldigits!=null){c=f.CASA_decimaldigits}if(f.CASA_decimaldigitsprop!=null){c=getPropertyValue(f.CASA_decimaldigitsprop)}if(checkIfValueHasError(c,"int")==true){f.CASA_decimaldigitsprop=null;c=-1}if(f.CASA_titleprop!=null){var u=getPropertyValue(f.CASA_titleprop);if(u==null){u=""}if(u!=f.CASA_lastTitle){f.title=u;f.CASA_lastTitle=u}}if(m=="ERROR"||m=="FOCUS"){addFocusRequestor(f)}else{if(m=="FOCUS_NO_SELECT"){addActiveElementRequestor(f)}}if(f.m_lastDir!=m_direction){if(m_direction=="rtl"){f.style.backgroundPosition="left"}else{f.style.backgroundPosition="right"}f.m_lastDir=m_direction}var p=f.CASA_datatype;if(p!=null){if(p=="date"){h=convertYYYYMMDDIntoDisplayString(h)}else{if(p=="time"){h=convertHHMMSSIntoDisplayString(h)}else{if(p=="timestamp"){h=convertYYYYMMDDHHMMSSMMMIntoDisplayString(h)}else{if(p=="float"){h=convertFLOATIntoDisplayString(h,c)}else{if(p=="int"||p=="long"){h=convertINTIntoDisplayString(h)}else{if(p=="emtype"){try{h=convertIntoDisplayStringEDITMASK(this,h,f)}catch(y){}}}}}}}}var k=false;if(h==null&&m==null){f.value="";f.tabIndex=-1;f.style.backgroundColor=f.CASA_defaultbgcolor;f.readOnly=true;if(f.className!=resolveFieldClassName(f,"Null")){f.className=resolveFieldClassName(f,"Null")}if(f.CASA_popupicon!=null&&f.style.backgroundImage!=null){f.style.backgroundImage=""}if(f.CASA_fic!=null){if(f.CASA_fic.style.backgroundImage!=null){f.CASA_fic.style.backgroundImage=""}f.CASA_fic.className="FIELDCellPopupIconNull"}return}else{f.readOnly=false;if(n==null){f.value=h}else{if(n!=""){vDisplayMode=f.CASA_textidmode;if(vDisplayMode==undefined){vDisplayMode=getPropertyValue("cISFIELDTextIdMode")}if(vDisplayMode==null||vDisplayMode=="0"){f.value=h+" - "+n}else{if(vDisplayMode=="1"){f.value=h}else{if(vDisplayMode=="2"){f.value=n}}}}else{f.value=h}}applyCasaTabIndex(f,"FIELD");if(k){f.readOnly=false}}f.CASA_lastControlValue=f.value;var E=false;if((f.CASA_displayonly!="true")&&(p!=null&&p=="date"||p!=null&&p=="time"||p!=null&&p=="color"||f.CASA_popupmethod!=null&&f.CASA_popupprop==null||f.CASA_touchpadinput=="true"||f.CASA_popupmethod!=null&&w=="true")){E=true}if(f.CASA_displayonly=="true"&&(m==null||m=="")){f.tabIndex=-1;if(k){f.readOnly=true}if(E==false){if(f.className!=resolveFieldClassName(f,"Display")){f.className=resolveFieldClassName(f,"Display")}}else{if(f.className!=resolveFieldClassName(f,"DisplayWithPopup")){f.className=resolveFieldClassName(f,"DisplayWithPopup")}}}else{if(m==null){if(E==false){if(f.className!=resolveFieldClassName(f,"Edit")){f.className=resolveFieldClassName(f,"Edit")}}else{if(f.CASA_popupinputonly=="true"){if(f.className!="FIELDPopupInputOnlyWithPopup"){f.className="FIELDPopupInputOnlyWithPopup"}}else{if(f.CASA_touchpadinput=="true"){if(f.className!=resolveFieldClassName(f,"EditWithTouchScreenPopup")){f.className=resolveFieldClassName(f,"EditWithTouchScreenPopup")}}else{if(f.className!=resolveFieldClassName(f,"EditWithPopup")){f.className=resolveFieldClassName(f,"EditWithPopup")}}}}}else{if(E==false){if(m=="EDIT"||m=="FOCUS"||m=="FOCUS_NO_SELECT"){if(f.className!=resolveFieldClassName(f,"Edit")){f.className=resolveFieldClassName(f,"Edit")}}else{if(m=="DISPLAY"){if(f.className!=resolveFieldClassName(f,"Display")){f.className=resolveFieldClassName(f,"Display")}f.tabIndex=-1;if(k){f.readOnly=true}}else{if(m=="ERROR_DISPLAY"){if(f.className!=resolveFieldClassName(f,"Error")){f.className=resolveFieldClassName(f,"Error")}f.tabIndex=-1;if(k){f.readOnly=true}}else{if(m=="ERROR"||m=="ERROR_NO_FOCUS"){if(f.className!=resolveFieldClassName(f,"Error")){f.className=resolveFieldClassName(f,"Error")}}else{if(m=="INVISIBLE"){if(f.className!=resolveFieldClassName(f,"Invisible")){f.className=resolveFieldClassName(f,"Invisible")}}else{if(f.className!=resolveFieldClassName(f,"Edit")){f.className=resolveFieldClassName(f,"Edit")}}}}}}}else{if(m=="EDIT"||m=="FOCUS"||m=="FOCUS_NO_SELECT"){if(f.CASA_popupinputonly=="true"){if(f.className!="FIELDPopupInputOnlyWithPopup"){f.className="FIELDPopupInputOnlyWithPopup"}}else{if(f.CASA_touchpadinput=="true"){if(f.className!=resolveFieldClassName(f,"EditWithTouchScreenPopup")){f.className=resolveFieldClassName(f,"EditWithTouchScreenPopup")}}else{if(f.className!=resolveFieldClassName(f,"EditWithPopup")){f.className=resolveFieldClassName(f,"EditWithPopup")}}}}else{if(m=="DISPLAY"){f.tabIndex=-1;if(k){f.readOnly=true}if(f.CASA_touchpadinput=="true"&&f.className!=resolveFieldClassName(f,"DisplayWithTouchScreenPopup")){f.className=resolveFieldClassName(f,"DisplayWithTouchScreenPopup")}else{if(f.className!=resolveFieldClassName(f,"DisplayWithPopup")){f.className=resolveFieldClassName(f,"DisplayWithPopup")}}}else{if(m=="ERROR_DISPLAY"){f.tabIndex=-1;if(k){f.readOnly=true}if(f.CASA_popupinputonly=="true"){if(f.className!=resolveFieldClassName(f,"ErrorWithPopup")){f.className=resolveFieldClassName(f,"ErrorWithPopup")}}else{if(f.CASA_touchpadinput=="true"){if(f.className!=resolveFieldClassName(f,"ErrorWithTouchScreenPopup")){f.className=resolveFieldClassName(f,"ErrorWithTouchScreenPopup")}}else{if(f.className!=resolveFieldClassName(f,"ErrorWithPopup")){f.className=resolveFieldClassName(f,"ErrorWithPopup")}}}}else{if(m=="ERROR"||m=="ERROR_NO_FOCUS"){if(f.CASA_popupinputonly=="true"){if(f.className!=resolveFieldClassName(f,"ErrorWithPopup")){f.className=resolveFieldClassName(f,"ErrorWithPopup")}}else{if(f.CASA_touchpadinput=="true"){if(f.className!=resolveFieldClassName(f,"ErrorWithTouchScreenPopup")){f.className=resolveFieldClassName(f,"ErrorWithTouchScreenPopup")}}else{if(f.className!=resolveFieldClassName(f,"ErrorWithPopup")){f.className=resolveFieldClassName(f,"ErrorWithPopup")}}}}else{if(m=="INVISIBLE"){if(f.className!=resolveFieldClassName(f,"InvisibleWithPopup")){f.className=resolveFieldClassName(f,"InvisibleWithPopup")}}else{if(f.CASA_popupinputonly=="true"){if(f.className!="FIELDPopupInputOnlyWithPopup"){f.className="FIELDPopupInputOnlyWithPopup"}}else{if(f.CASA_touchpadinput=="true"){if(f.className!=resolveFieldClassName(f,"EditWithTouchScreenPopup")){f.className=resolveFieldClassName(f,"EditWithTouchScreenPopup")}}else{if(f.className!=resolveFieldClassName(f,"EditWithPopup")){f.className=resolveFieldClassName(f,"EditWithPopup")}}}}}}}}}if(f.CASA_td!=null){if(m=="INVISIBLE"){var r=f.CASA_invisiblemode;if(r==undefined||r=="invisible"){f.CASA_td.style.display="none"}}else{f.style.display="";f.CASA_td.style.display=""}}}}if(f.CASA_takeoutFieldPopupIcon){f.style.backgroundImage="url()";tableObj=f.parentNode.parentNode.parentNode.parentNode;if(m=="INVISIBLE"){w="false"}if(m=="INVISIBLE"){tableObj.style.display="none"}else{tableObj.style.display=""}if(f.CASA_fic!=null){if(w=="false"){f.CASA_fic.style.cursor=""}else{f.CASA_fic.style.cursor="pointer"}if(f.CASA_popupicon!=undefined){if(w=="false"){f.CASA_fic.style.backgroundImage=""}else{f.CASA_fic.style.backgroundImage="url("+f.CASA_popupicon+")"}}else{if(w=="false"){f.CASA_fic.className="FIELDCellPopupIconNull"}else{f.CASA_fic.className="FIELDCellPopupIcon"}}}}else{if(f.CASA_popupicon!=undefined){if(E==true){if(f.style.backgroundImage==null||f.style.backgroundImage==""){f.style.backgroundImage="url("+f.CASA_popupicon+")"}}else{if(f.style.backgroundImage!=undefined){f.style.backgroundImage=""}}}}if((f.value!=null)&&(f.value!="")&&(p!=null)&&(p=="color")&&(checkIfValueHasError(f.value,p)==false)){f.style.color=determineContrastColorCOLORSELECTION(f.value);f.style.backgroundColor=f.value}else{if((f.value=="")&&(p=="color")){f.style.color="";f.style.backgroundColor=f.CASA_defaultbgcolor}}var b=null;var e=false;if(f.CASA_bgcolorprop!=null){b=getPropertyValue(f.CASA_bgcolorprop);if(b==""){b=null}if(b!=null){e=checkIfValueHasError(b,"color")}}var t=null;var a=false;if(f.CASA_fgcolorprop!=null){t=getPropertyValue(f.CASA_fgcolorprop);if(t==""){t=null}if(t!=null){a=checkIfValueHasError(t,"color")}else{t=f.CASA_defaultfgcolor}}if(b!=null&&e==false&&t!=null&&a==false){f.style.backgroundColor=b;f.style.color=t}else{if(b!=null&&e==false){if(checkIfColorIsDarkCOLORSELECTION(b)==true){f.style.color="#FFFFFF"}else{f.style.color="#000000"}f.style.backgroundColor=b}else{if(t!=null&&a==false){if(t==""||checkIfColorIsDarkCOLORSELECTION(t)==true){f.style.backgroundColor=f.CASA_defaultbgcolor}else{f.style.backgroundColor="#000000"}f.style.color=t}}}if((b==null)&&(t==null)){f.style.backgroundColor=f.CASA_defaultbgcolor;f.style.color=f.CASA_defaultfgcolor}if(f.CASA_maxlengthprop!=null){var g=getPropertyValue(f.CASA_maxlengthprop);if(g!=null&&g!=""&&g!=f.maxlength){f.maxLength=(-1)*g*(-1)}}if(f.CASA_lengthprop!=null){var q=getPropertyValue(f.CASA_lengthprop);if(q>0&&q!=f.size){f.size=q}}if((p=="int"||p=="long"||p=="float")&&(f.style.textAlign==""||f.style.textAlign==null)){var j=getPropertyValue("cISAddons.fieldParam1");if(f.CASA_fieldParam1!=j){f.CASA_fieldParam1=j;if(j=="true"){f.style.textAlign=(m_direction=="rtl")?"left":"right"}else{f.style.textAlign=(m_direction=="rtl")?"right":"left"}}}}function resolveFieldClassName(a,b){if(a.CASA_stylevariant!=null){return"FIELDInput"+a.CASA_stylevariant+b}else{return"FIELDInput"+b}}function reactFIELD(a){return reactFIELDInternal(a)}function reactFIELDInternal(a){var b=true;if(a.type=="keydown"){b=reactOnKeyDownFIELD(a)}else{if(a.type=="keypress"){b=reactOnKeyPressFIELD(a)}else{if(a.type=="keyup"){b=reactOnKeyUpFIELD(a)}else{if(a.type=="mousedown"){b=reactOnMouseDownFIELD(a)}else{if(a.type=="mouseup"){b=reactOnMouseUpFIELD(a)}else{if(a.type=="change"){b=transferChangeFIELD(a.currentTarget,false)}else{if(a.type=="focus"){b=reactOnFocusFIELD(a.currentTarget)}else{if(a.type=="blur"){b=transferChangeFIELD(a.currentTarget,true,"blur")}else{if(a.type=="dblclick"){b=reactOnValueHelpFIELD(a.currentTarget)}else{if(a.type=="contextmenu"){b=reactOnValueHelpFIELD(a.currentTarget,a)}else{if(a.type=="drop"){b=false}}}}}}}}}}}return b}function transferChangeFIELD(c,b,d,e){if(CL()==null){return}if(b==true){CL().C_unregFocusInfo(c)}if(!e==true){if(checkIOForNoSubmits()==false){return false}}if(c.tabIndex==-1){return false}clearTimeoutAutoCallPopupMethodFIELD(c);var a=transferPropertyValueFIELD(c);if(c.CASA_flush=="screen"&&a==c){flushIfDesiredFIELD(c)}else{if((c.CASA_alwaysflush=="true"&&d=="blur"&&c.CASA_hasValidationError!=true)||((c.CASA_flushmethod!=undefined||c.CASA_flush!=undefined)&&c.CASA_alwaysflush!="true"&&a==c)){flushFIELD(c)}}return true}function flushFIELD(a){if((this.isValueHelpOpen()!=true)&&(this.isContextMenuOpen()!=true)&&(a.CASA_datepopupOpen!="true")){CL().C_saveCurrFocusInfo(a);m_flushCC=a;a.CASA_flushTimeoutId=window.setTimeout("rtaFlushFIELD()",20)}}var m_flushCC=null;function rtaFlushFIELD(){if(m_flushCC!=null){if(m_flushCC.CASA_flushTimeoutId!=null){window.clearTimeout(m_flushCC.CASA_flushTimeoutId)}flushIfDesiredFIELD(m_flushCC,"blur");m_flushCC=null}}m_ccAutoCallPopupMethod=null;function reactOnTimeoutAutoCallPopupMethodFIELD(){setPropertyValue("cISAddons.fieldParam4","true");reactOnValueHelpFIELD(m_ccAutoCallPopupMethod)}function clearTimeoutAutoCallPopupMethodFIELD(a){if(a.CASA_autocallTimeoutId!=null){window.clearTimeout(a.CASA_autocallTimeoutId)}}function setTimeoutAutoCallPopupMethodFIELD(a,b){if(a.CASA_autocallpopupmethod!="true"){return}if(b==null){return}if(b.keyCode!=8&&b.keyCode!=229&&(b.keyCode<32||b.keyCode>127||b.keyCode==37||b.keyCode==39||b.keyCode==38)){return}clearTimeoutAutoCallPopupMethodFIELD(a);m_ccAutoCallPopupMethod=a;var c=getPropertyValue("cISAddons.fieldParam5");if(a.CASA_autocallpopupmethodoffset!=null){c=a.CASA_autocallpopupmethodoffset}a.CASA_autocallTimeoutId=window.setTimeout("reactOnTimeoutAutoCallPopupMethodFIELD()",c)}function transferPropertyValueFIELD(a){return CL().C_transferPropertyValueFIELD(this,a)}function transferAndConvertPropertyValueFIELD(a){return CL().C_transferAndConvertPropertyValueFIELD(this,a)}function resetValidationErrorFIELD(a){a.style.color="";a.style.borderColor="";a.style.borderWidth="";a.CASA_hasValidationError=false;a.CASA_valErrors=[];reactOnModelUpdateFIELD(a,true)}function buildValidationErrorMessageFIELD(a){return CL().C_buildValidationErrorMessageFIELD(this,a)}function decorateInputFieldOnError(a){return CL().C_decorateInputFieldOnError(a)}var m_blockAfterFlushFIELD;function flushIfDesiredFIELD(a,b){if(CL()==null){return}CL().C_flushIfDesiredFIELD(this,a,b)}function reactOnMouseUpFIELD(a){return CL().C_reactOnMouseUpFIELD(this,a)}function reactOnMouseDownFIELD(a){return CL().C_reactOnMouseDownFIELD(this,a)}function reactOnFocusFIELD(a){return CL().C_reactOnFocusFIELD(this,a)}function reactOnKeyPressFIELD(a){return CL().C_reactOnKeyPressFIELD(this,a)}function reactOnKeyUpFIELD(a){return CL().C_reactOnKeyUpFIELD(this,a)}function reactOnValueHelpFIELD(b,c,a){return CL().C_reactOnValueHelpFIELD(this,b,c,a)}function reactOnKeyDownFIELD(a){return CL().C_reactOnKeyDownFIELD(this,a)}var m_retccFIELD;function openDatePopupFIELD(a){CL().C_openDatePopupFIELD(this,a)}function transferDatePopupRetValFIELD(a){CL().C_transferDatePopupRetValFIELD(this,a)}function openTimePopupFIELD(a){CL().C_openTimePopupFIELD(this,a)}function transferTimePopupRetValFIELD(a){closeStandardDlgPopupPAGE();CL().C_transferTimePopupRetValFIELD(this,a)}function openColorPopupFIELD(a){CL().C_openColorPopupFIELD(this,a)}function transferColorPopupRetValFIELD(a){if(a!=null){m_retccFIELD.value=a[0];transferChangeFIELD(m_retccFIELD,true,"blur",true)}}var m_casacontrol;function openTouchPadNumericFIELD(a){CL().C_openTouchPadNumericFIELD(this,a)}function openTouchPadFIELD(a){CL().C_openTouchPadFIELD(this,a)}function takeOverTouchPadResultMOZILLA(a){closeStandardDlgPopupPAGE();if(a!=null){m_casacontrol.value=a[0];transferPropertyValueFIELD(m_casacontrol);m_casacontrol=null}}function addVersionInfoCHECKBOXCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("CHECKBOXCONTROLS")}function flexCreateControlCHECKBOX(f){var g=f.width;var c=f.CONTROLID;var d=parent.createElement("TD");d.style.width=0;var e=parent.createElement("INPUT");e.type="CHECKBOX";e.name="CC";e.id="CB_"+c;e.style.width=C_adjustUnits(g);e.className="CHECKBOXEdit";parent["CCB_"+c]=e;var b=parent.createFunction("romuCB_"+c,"model","C.romuCHECKBOX(CCB_"+c+");");iccCHECKBOX(parent["CCB_"+c],null,b,this["reactCHECKBOX"],f.valuepropp,f.displayonly,f.statuspropp,f.flush,f.flushmethod,f.helpid,null,f.tabindex,f.invisiblemode,f.showifnull,f.displaypropp);d.appendChild(e);var a=new Object();a.cell=d;a.control=e;return a}function flexRemoveCHECKBOX(a){parent["C"+a]=undefined;parent["romu"+a]=undefined;removePropertyListener(a)}function iccCHECKBOX(d,n,p,m,f,j,a,q,c,h,k,e,b,l,g){d.onclick=m;d.onfocus=m;d.onblur=m;d.onkeydown=m;addFocusable(d,false);startFocusCell(d);d.CASA_valueprop=f;registerPropertyListener(p,f,d.id);registerStatusPropertyListener(p,a,d.id,d);registerPropertyListener(p,g,d.id);if(n!=null){d.CASA_label=n}if(j!=null){d.CASA_displayonly=j}if(a!=null){d.CASA_statusprop=a}if(q!=null){d.CASA_flush=q}if(c!=null){d.CASA_flushmethod=c}if(h!=null){d.CASA_helpid=h}if(k!=null){d.CASA_cti=k}if(e!=null){d.CASA_tabindex=e}if(b!=null){d.CASA_invisiblemode=b}if(l!=null){d.CASA_showifnull=l}if(g!=null){d.CASA_displayprop=g}d.CASA_memvalue=undefined;d.CASA_memstatus=undefined;applyCasaTabIndex(d,"CHECKBOX")}function initCasaControlCHECKBOX(a){a.CASA_memvalue=undefined;a.CASA_memstatus=undefined}function romuCHECKBOX(c){if(c==null){return}var h;var e;h=getPropertyValue(c.CASA_valueprop);if(c.CASA_statusprop!=null){e=getPropertyValue(c.CASA_statusprop)}if(c.CASA_displayprop!=null){var a=getPropertyValue(c.CASA_displayprop);e=applyDisplayProperty(a,e)}if(c.CASA_memvalue!=undefined&&c.CASA_memvalue==h&&c.CASA_memstatus==e){return}c.CASA_memvalue=h;c.CASA_memstatus=e;applyCasaTabIndex(c,"CHECKBOX");if(h==null){if(c.CASA_showifnull=="false"){c.style.display="none"}c.disabled=true;if(c.className!="CHECKBOXNull"){c.className="CHECKBOXNull"}if(c.CASA_label!=null&&c.CASA_label.className!="CHECKBOXNull"){c.CASA_label.className="CHECKBOXNull"}c.checked="";return}if(c.CASA_showifnull=="false"){c.style.display=""}if(h=="true"||h==true){h="checked"}else{h=""}c.checked=h;if(c.CASA_displayonly=="true"){c.disabled=true;if(c.className!="CHECKBOXEdit"){c.className="CHECKBOXEdit"}if(c.CASA_label!=null&&c.CASA_label.className!="CHECKBOXNull"){c.CASA_label.className="CHECKBOXNull"}}else{var f="CHECKBOXEdit";var g="CHECKBOXEdit";c.disabled=false;if(e!=null){try{c.CASA_td.style.display=""}catch(j){}if(e=="INVISIBLE"){c.disabled=true;f="CHECKBOXInvisible";g="CHECKBOXInvisible";if(c.CASA_invisiblemode=="cleared"){try{var d=c.offsetWidth;if(c.CASA_hdist!=null){d+=c.CASA_hdist.offsetWidth}if(c.CASA_label!=null){d+=c.CASA_label.offsetWidth}if(d==0){c.CASA_memstatus=undefined;registerSwitchToDisplayListener(romuCHECKBOX,c);return}c.CASA_td.width=d;if(c.CASA_table!=null){c.CASA_table.width=d}}catch(b){}}else{if(c.CASA_td!=null){c.CASA_td.style.display="none"}}}else{if(e=="DISPLAY"){c.disabled=true;f="CHECKBOXNull";g="CHECKBOXNull"}else{if(e=="EDIT"||e=="FOCUS"||e=="FOCUS_NO_SELECT"){c.disabled=false}else{if(e=="ERROR"||e=="ERROR_NO_FOCUS"){c.disabled=false;f="CHECKBOXError";g="CHECKBOXError"}else{if(e=="ERROR_DISPLAY"){c.disabled=true;f="CHECKBOXError";g="CHECKBOXError"}else{c.disabled=false}}}}}if(e=="ERROR"||e=="FOCUS"||e=="FOCUS_NO_SELECT"){addFocusRequestor(c)}}if(c.className!=f){c.className=f}if(c.CASA_label!=null&&c.CASA_label.className!=g){c.CASA_label.className=g}}}function reactCHECKBOX(a){return reactCHECKBOXInternal(a.currentTarget,a)}function reactCHECKBOXInternal(b,a){if(CL()==null){return}if(a.type=="click"){return reactOnClickedCHECKBOX(b,a)}else{if(a.type=="focus"){return reactOnFocusCHECKBOX(b)}else{if(a.type=="blur"){return reactOnBlurCHECKBOX(b)}else{if(a.type=="keydown"){if(a.keyCode==112){CL().cancelEvent(a);return reactOnHelpCHECKBOX(b,a)}}}}}}function reactOnBlurCHECKBOX(a){CL().C_unregFocusInfo(a);return true}function reactOnFocusCHECKBOX(a){CL().C_regFocusInfo(a);return true}function reactOnClickedCHECKBOX(e,a){if(isSafari()){e.focus()}if(checkIOForNoSubmits()==false){CL().cancelEvent(a);return false}if(e.disabled==true){parent.event.returnValue=false;return false}var c=findSrcElement(a);if(c!=undefined&&c.id!=undefined&&c.id.substring(0,3)!="CB_"){var b=e.checked;if(b=="true"||b==true||b=="checked"){b=""}else{b="checked"}e.checked=b;try{e.focus()}catch(d){}}setPropertyValue(e.CASA_valueprop,""+e.checked);e.CASA_memvalue=e.checked;if(e.CASA_flush=="server"||e.CASA_flushmethod!=null){setPropertyValue("param1",e.CASA_valueprop);m_displayOccupied=false;if(e.CASA_flushmethod!=null){invokeMethodInModel(e.CASA_flushmethod)}else{submitModel("submit")}}else{if(e.CASA_flush=="screen"){updateModelListenersS()}}return true}function reactOnHelpCHECKBOX(c,a){if(checkIOForNoSubmits()==false){return}if(c.CASA_helpid!=undefined){var b=c.CASA_helpid;if(c.CASA_helpid=="$valueprop$"){b=c.CASA_valueprop}setPropertyValue("param2",b);invokeMethodInModel("reactOnHelpRequestForHelpId")}a.returnValue=false}function addVersionInfoMETHODLINKCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("METHODLINKCONTROLS")}function flexCreateControlMETHODLINK(h){var d=parent.createElement("TD");if(h.width!=null){d.style.width=h.width}if(h.colspan!=null){d.colSpan=h.colspan}if(h.rowspan!=null){d.rowSpan=h.rowspan}if(h.valign!=null){d.vAlign=h.valign}if(h.align!=null){d.align=h.align}if(h.nowrap!=null){d.noWrap=h.nowrap}var c="MLINK"+h.CONTROLID;var f=parent.createElement("DIV");f.id=c;if(h.linkclass==null){f.className="METHODLINKLink"}else{f.className=h.linkclass}if(h.name!=null){f.innerHTML=h.name}if(h.nowrap!=null){f.noWrap=h.nowrap;f.style.overflow="hidden";f.style.whiteSpace="nowrap"}if(h.titlepropp!=null){f.CASA_titleprop=h.titlepropp}if(h.linkstatuspropp!=null){f.CASA_linkstatusprop=h.linkstatuspropp}if(h.straighttext!=null){f.CASA_straighttext=h.straighttext}d.appendChild(f);parent[c]=f;var g="evt";f.onclick=parent.createFunction("callMethodLink"+c,"evt","C.callMethodLinkMETHODLINK("+c+",'"+h.methodd+"',"+g+");");if(h.valuepropp!=null){f.CASA_valueprop=h.valuepropp;var b=parent.createFunction("romu"+c,"model","C.romuMETHODLINK("+c+");");registerListener(b)}if(h.oncontextmenumethodd!=null){f.oncontextmenu=parent.createFunction("rocm"+c,"evt","C.callMethodLinkMETHODLINK("+c+",'"+h.oncontextmenumethodd+"',"+g+");")}var a=new Object();a.cell=d;a.control=f;return a}function flexRemoveMETHODLINK(a){parent[a]=undefined;parent["romu"+a]=undefined;parent["callMethodLink"+a]=undefined;parent["rocm"+a]=undefined;removeListener(a)}function iccMETHODLINK(f,d,c,b,e,a){if(d!=null){f.CASA_valueprop=d}else{f.CASA_valueprop="null"}if(c!=null){f.CASA_titleprop=c}if(e!=null){f.CASA_method=e}if(b!=null){f.CASA_linkstatusprop=b}if(a=="true"){f.CASA_straighttext=true}}function callMethodLinkMETHODLINK(c,a,b){if(checkIO()==false){return}if(c.CASA_linkStatus=="DISPLAY"){if(b.stopPropagation){b.stopPropagation()}return false}if(c.CASA_method!=null){a=c.CASA_method}setContextMenuXYPAGE(b.clientX+10,b.clientY+10);invokeMethodInModel(a)}function romuMETHODLINK(d){if(d.CASA_valueprop!="null"){var c=getPropertyValue(d.CASA_valueprop);if(c==null){c=""}if(d.CASA_bufferedtext==undefined||d.CASA_bufferedtext!=c){if(d.CASA_straighttext==true){d.textContent=c}else{d.innerHTML=c}d.CASA_bufferedtext=c}}if(d.CASA_titleprop!=null){var b=getPropertyValue(d.CASA_titleprop);if(d.CASA_bufferedtitle!=b){if(b!=null){d.title=b}else{d.title=""}d.CASA_bufferedtitle=b}}if(d.CASA_linkstatusprop!=null){var a=getPropertyValue(d.CASA_linkstatusprop);if(a==null||a==""){a="EDIT"}if(a==d.CASA_linkStatus){return}d.CASA_linkStatus=a;if(a=="DISPLAY"){d.style.cursor="default";d.style.textDecoration="none";d.style.fontWeight="normal"}else{if(a=="EDIT"||a=="VISITED"){d.style.cursor="pointer";d.style.textDecoration="underline";d.style.fontWeight="normal"}else{if(a=="UNVISITED"){d.style.cursor="pointer";d.style.textDecoration="underline";d.style.fontWeight="bold"}}}}}function addVersionInfoHDISTCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("HDISTCONTROLS")}function iccHDIST(c,b,a){if(c==null){return}c.CASA_romumethod=b;c.CASA_visibleprop=a;c.CASA_mem=undefined;registerPropertyListener(b,a,c.id)}function romuHDIST(b){if(b==null){return}var a=getPropertyValue(b.CASA_visibleprop);a=convertStatusToVisible(a,CONTROLTYPE_CONTAINER);if(a==null){a="false"}if(a==b.CASA_mem){return}b.CASA_mem=a;if(a=="false"){b.style.display="none"}else{b.style.display=""}}function addVersionInfoPOPUPVALUESCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("POPUPVALUESCONTROLS")}var m_userInputPOPUPVALUES="";var m_selectedItemIndexPOPUPVALUES;function reactOnModelUpdatePOPUPVALUES(w){var n=getPropertyValue(w+".available");if(n==null){return}if(n=="false"){var p=findMPADIV(false);if(p!=null){if(p.CASA_ismessagepopup!=true){p.style.display="none";p.innerHTML=""}}return}var f=findMPADIV();var x=getPropertyValue(w+".pixelHeight")-0;if(x==null||x<=0){x=150}if(m_leftFIELD!=null){f.style.left=C_adjustUnits(m_leftFIELD)}vBodyHeight=parent.innerHeight;if(m_topFIELD!=null){var h=m_topFIELD+m_heightFIELD;var l=mozCalculatePageScoll(m_controlFIELD);f.style.top=C_adjustUnits((h-l));if(m_topFIELD+m_heightFIELD+x>vBodyHeight){if(x>m_topFIELD){if(vBodyHeight-(m_topFIELD+m_heightFIELD)>=m_topFIELD){x=vBodyHeight-(m_topFIELD+m_heightFIELD)-1}else{x=m_topFIELD-1;f.style.top=C_adjustUnits((m_topFIELD-x+1))}}else{if(l>0){maxHeight=m_topFIELD-l;if(x>maxHeight){x=maxHeight}}f.style.top=C_adjustUnits((m_topFIELD-l-x))}}}var g=getPropertyValue(w+".pixelWidth")-0;if(g==null||g<=0){if(m_controlFIELD.CASA_popupcombowidth!=null){g=m_controlFIELD.CASA_popupcombowidth-0}else{if(m_widthFIELD!=null&&m_widthFIELD>150){g=m_widthFIELD}else{g=150}}}var u=parent.document.body.clientWidth;if(m_leftFIELD+g>u){g=u-m_leftFIELD-10}m_selectedItemIndexPOPUPVALUES=0;var c=0;var j=0;var q=[];q.push("<div id='MPADIVDIV' tabindex='1' onkeydown='C.onkeydownPOPUPVALUES(\""+w+"\", event);' onkeypress='C.onkeypressPOPUPVALUES(\""+w+"\", event); event.stopPropagation(); return false;' class='POPUPVALUESDiv' style='overflow: auto; height: "+C_adjustUnits(x)+"; width:"+C_adjustUnits(g)+";' onclick='C.m_avoidClickAway = true;'>");q.push("<table cellspacing=0 cellpadding=1 width='100%' onmousemove='C.switchStylePOPUPVALUES(event,null,true);' onclick='C.selectValuePOPUPVALUES(\""+w+"\",event);'>");f.CASA_plusOneItem=false;f.CASA_topList=[];var d=false;var e=m_valuehelpKeyCodeFIELD;if(e!=null&&e!=""){var y=[];while(true){var b=w+".items["+c+"].name";if(m_textidmodeFIELD!=2){b=w+".items["+c+"].id"}var r=getPropertyValue(b);if(r==null){break}var m=false;try{m=compareSearchString(r,e)}catch(k){break}if(m==true){var a=buildHTMLForRowPOPUPVALUES(w,c,j);y.push(a);j++;d=true;f.CASA_topList.push(c)}c++}if(j==0){var t=replaceLiteralTRANSLATION(m_language,"nomatch");q.push("<tr><td colspan=2 class='POPUPVALUESColName'><b>"+e+"</b>  "+t+"</td></tr>");f.CASA_plusOneItem=true}else{q.push("<tr><td colspan=2 class='POPUPVALUESColName'><b>"+e+"</b></td></tr>");f.CASA_plusOneItem=true;q.push("<tr><td colspan=2><hr></td></tr>");q.push(y.join(""))}q.push("<tr><td colspan=2><hr></td></tr>")}c=0;while(true){var a=buildHTMLForRowPOPUPVALUES(w,c,j);if(a==null){break}q.push(a);j++;c++}q.push("</table>");q.push("</div>");f.innerHTML=q.join("");var s=parent.gebid("MPADIVDIV");f.CASA_length=j;f.CASA_innerdiv=s;if(d==true){m_selectedItemIndexPOPUPVALUES=0}f.CASA_itemIndex=m_selectedItemIndexPOPUPVALUES;f.style.display="";m_controlFIELD.style.cursor="";if(m_controlFIELD!=null&&m_controlFIELD.CASA_autocallpopupmethod=="true"){addFocusRequestor(m_controlFIELD)}else{if(m_controlFIELD.className=="FIELDInputEditWithPopup"||m_controlFIELD.className=="FIELDInputErrorWithPopup"){clearFocusRequestor()}addFocusRequestor(s);selectLinePOPUPVALUES(f,m_selectedItemIndexPOPUPVALUES)}}function compareSearchString(e,c){if(e==null){return false}if(c==null){return false}var d=e.toLowerCase();var b=c.toLowerCase();var a=d.search(b);return(a==0)}function buildHTMLForRowPOPUPVALUES(f,e,h){var b=[];var d=f+".items["+e+"].name";var c=getPropertyValue(d);if(c==null){return null}d=f+".items["+e+"].id";var j=getPropertyValue(d);var g=getPropertyValue(f+".property");if(g!=null){var l=getPropertyValue(g)}var a="";if(j==l){a="style='font-weight: bold'";m_selectedItemIndexPOPUPVALUES=e}var k="POPUPVALUESColName";b.push("<tr id='MPADIVLIN_"+h+"'>");if(m_textidmodeFIELD!=2){b.push("<td id='MPADIVLIN_"+h+"' class='POPUPVALUESColId' "+a+">"+j+"</td>")}else{k="POPUPVALUESColId"}c+="&nbsp;";b.push("<td id='MPADIVLIN_"+h+"' class='"+k+"' "+a+">"+c+"</td>");b.push("</tr>");return b.join("")}function selectLinePOPUPVALUES(e,d,b){var a=parent.gebid("MPADIVLIN_"+d);if(a==null){return}a.className="POPUPVALUESRowRollin";if(b!=undefined&&b!=null&&b){e.CASA_innerdiv.focus()}var c=e.CASA_innerdiv;calculatePageOffset(c);c.scrollTop=a.offsetHeight*d}function onkeydownPOPUPVALUES(b,a){CL().C_onkeydownPOPUPVALUES(this,b,a)}function onkeypressPOPUPVALUES(b,a){CL().C_onkeypressPOPUPVALUES(this,b,a)}function vscrollPOPUPVALUES(a,c,b){CL().C_vscrollPOPUPVALUES(this,a,c,b)}var m_selectedId=null;function selectValuePOPUPVALUES(b,a){if(checkIO()==false){return}var d=findSrcElement(a);var f=d.id;if(f!=""&&f.search("MPADIVLIN_")>-1){var c=f.split("MPADIVLIN_");var e=c[1];setPropertyValue(b+".flushMethod",m_flushMethodFIELD);setPropertyValue(b+".selIndex",determinSelectionIndexPOPUPVALUES(e));m_selectedId=e;invokeMethodInModel(b+".triggerSel");addFocusRequestor(m_controlFIELD);pointFocus()}}var m_rolledinRow=null;function switchStylePOPUPVALUES(c,b,d){if(checkIO()==false){return}if(d){var a=findSrcElement(c);if(a.id!=""&&a.id.search("MPADIVLIN_")>-1){if(a.tagName=="TD"){a=a.parentNode}if(m_rolledinRow==null){a.className="POPUPVALUESRowRollin";m_rolledinRow=a}else{if(a!=m_rolledinRow){a.className="POPUPVALUESRowRollin";m_rolledinRow.className="POPUPVALUESRowNormal";m_rolledinRow=a}}}}else{a=parent.document.getElementById("MPADIVLIN_"+c);if(b==1){a.className="POPUPVALUESRowRollin"}else{if(b==2){a.className="POPUPVALUESRowNormal"}}}}function determinSelectionIndexPOPUPVALUES(b){var a=findMPADIV();if(b>=a.CASA_topList.length){return b-a.CASA_topList.length}return a.CASA_topList[b]}function mozCalculatePageScoll(e){var d=e;var b=0;while(true){try{if(d==null){break}if(d.scrollTop>0){b=b+d.scrollTop}var c=d.parentNode;if(d==c){break}d=c}catch(a){break}}return b}function addVersionInfoVALIDATIONRULES(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("VALIDATIONRULES")}function checkValidationRules(t,p,x){t.CASA_valErrors=[];var e=[];for(var z=0;z<=p.length-1;z++){var b=p[z].split("-");var q=b[b.length-1];if(q.indexOf("$")>=0){var h=q.split("$");var a=h[0];txtid="$"+ruleStringToOriginalString(h[1]);if(a!=""){q=h[0]+"\n";q+=getPropertyValue(txtid)}else{q=getPropertyValue(txtid);q=q.replace("\n","")}}e.push(ruleStringToOriginalString(q));var d=[];var g=[];for(var y=0;y<b.length-1;y++){var n;var F=b[y].split(";");var s=rulesStringtoFieldValueProp(F[0]);if(s==t.CASA_valueprop){n=x}else{n=getPropertyValue(s)}var A=F[2];var E=F[3];if(t.CASA_datatype=="date"){if(n.indexOf(".")>=0||n.indexOf("/")>=0||n.indexOf("-")>=0){n=convertDisplayStringIntoYYYYMMDD(n)}var D=n.substring(6,8)+"/"+n.substring(4,6)+"/"+n.substring(0,4);var B=new Date(D);D=A.substring(6,8)+"/"+A.substring(4,6)+"/"+A.substring(0,4);var m=new Date(D);n=B.valueOf();A=m.valueOf()}if(F[1]=="!="){d.push(n*1!=A*1)}else{if(F[1]=="=="){d.push(n==A)}else{if(F[1]=="lt"){d.push(n*1<A*1)}else{if(F[1]=="gt"){d.push(n*1>A*1)}else{if(F[1]=="ltet"){d.push(n*1<=A*1)}else{if(F[1]=="gtet"){d.push(n*1>=A*1)}else{if(F[1]=="null"){d.push(n.length==0)}else{if(F[1]=="not null"){d.push(n.length!=0)}else{if(F[1]=="cnts"){var c=n.search(ruleStringToOriginalString(A));if(c>=0){d.push(true)}else{d.push(false)}}else{if(F[1]=="dncnts"){var c=n.search(ruleStringToOriginalString(A));if(c<0){d.push(true)}else{d.push(false)}}else{if(F[1]=="sw"){var c=n.search(ruleStringToOriginalString(A));if(c==0){d.push(true)}else{d.push(false)}}else{if(F[1]=="dnsw"){var c=n.search(ruleStringToOriginalString(A));if(c!=0){d.push(true)}else{d.push(false)}}else{if(F[1]=="mp"){var f=ruleStringToOriginalString(A);d.push(CL().C_checkRegularExpression(f,n))}else{if(F[1]=="dnmp"){var f=ruleStringToOriginalString(A);d.push(!CL().C_checkRegularExpression(f,n))}}}}}}}}}}}}}}if(F.length==4&&(E!=undefined||E!="")){g.push(E)}}if(g.length>0){var u=1;var C;if(g[0]=="And"){C=d[0]&&d[1]}else{if(g[0]=="Or"){C=d[0]||d[1]}}for(var r=2;r<d.length;r++){if(g[u]=="And"){C=d[r]&&C}else{if(g[u]=="Or"){C=d[r]||C}}u++}if(C){t.CASA_valErrors.push(e[z])}}else{if(d.length>0){for(var w=0;w<=d.length-1;w++){if(d[w]){t.CASA_valErrors.push(e[z])}}}}}if(t.CASA_valErrors.length>0){if(t.CASA_checkOnSubmit==false){return false}else{registerValidationError(t);return true}}}function ruleStringToOriginalString(a){while(a.indexOf("scln")>=0){a=a.replace("scln",";")}while(a.indexOf("hfn")>=0){a=a.replace("hfn","-")}while(a.indexOf("undscr")>=0){a=a.replace("undscr","_")}return a}function rulesStringtoFieldValueProp(a){while(a.indexOf("*usf*")>=0){a=a.replace("*usf*","_")}while(a.indexOf("*dsf*")>=0){a=a.replace("*dsf*","-")}return a}function addVersionInfoICONCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("ICONCONTROLS")}function flexCreateControlICON(G){var a=parent.createElement("TD");var r=parent.createElement("SPAN");var x=parent.createElement("TABLE");var k=parent.createElement("TBODY");var h=parent.createElement("TR");var E=parent.createElement("TD");x.cellSpacing=0;x.cellPadding=0;x.border=0;var F=G.CONTROLID;var z=G.withdistance;var g=G.imagewidth;var l=G.imageheight;var q=G.title;var w=G.image;var b=G.name;var t=G.nameposition;var A=G.displaymenuindicator;var d=G.align;var j=G.valign;var f="";var n="";var p="";if(g!=null&&g!=""&&g!=undefined){f="width = '"+g+"'"}if(l!=null&&l!=""&&l!=undefined){n="height = '"+l+"'"}if(q!=null&&q!=""&&q!=undefined){p="title = '"+q+"'"}if(d!=null&&d!=""&&d!=undefined){x.align=d}if(j!=null&&j!=""&&j!=undefined){x.valign=j}a.id="TDI"+F;a.width="100%";if(z=="true"){var B=parent.document.createElement("SPAN");B.innerHTML="&nbsp;";a.appendChild(B)}E.tabindex=0;E.id="ICON"+F;var s=[];var D="";if(b!=null&&b!=""){D="</td>";if(t=="below"){D+="</tr><tr>"}D+="<td valign='middle' align='center' nowrap='true' class='ICONText'>";D+="&nbsp;";D+=b;D+="&nbsp;"}var u="";if(A=="true"){u="</td>";if(t=="below"){u+="</tr><tr>"}u+="<td valign='middle' align ='center' nowrap='true'>";u+="&nbsp;";u+="<span valign='middle' class=\"ICONLISTMenuIndicatorImg\">&nbsp;&nbsp;&nbsp;</span>";u+="&nbsp;"}var y="<table cellpadding=0 cellspacing=0 align='center'><tr align='center'><td align='center' valign='middle'>";var c=D+u+"</td></tr></table>";s.push(y);s.push("<img id = 'ICONIMG"+F+"' src = '"+w+"' "+n+" "+f+" "+p+" >");s.push(c);E.innerHTML=s.join("");h.appendChild(E);k.appendChild(h);x.appendChild(k);a.appendChild(x);if(z=="true"){var e=parent.createElement("SPAN");e.innerHTML="&nbsp;";a.appendChild(e)}parent["C_"+F]=E;parent["C_"+F+".CASA_td"]=a;var C=parent.createFunction("romuICON"+F,"","C.romuICON(C_"+F+");");iccICON(parent["C_"+F],C,vri,this["reactICON"],w,G.imageinactive,G.indexpropp,G.referencepropp,G.visiblepropp,G.indexvalue,G.methodd,G.variant,G.repeatindex,G.cti,G.tabindex,G.invisiblemode,G.draginfo,G.draginfopropp,G.dropmethodd,G.dropinfopropp,G.titlepropp,G.imagepropp,G.switchvisibleproponuserinput,g,null);var m=new Object();m.cell=a;m.control=E;return m}function flexRemoveICON(b){var c=null;try{c=b.substring(4,b.length)}catch(a){}if(c!=null){parent["C_"+c+".CASA_td"]=undefined;parent["C_"+c]=undefined}parent["romu"+b]=undefined;removeListener("C_"+b)}function iccICON(r,p,y,m,q,A,b,u,e,j,f,l,t,a,B,n,w,h,d,k,x,s,c,g,z){if(f!=null||d!=null){r.onmouseenter=y;r.onmouseleave=y;r.className="ICONImage"}r.onmousedown=y;if(!CL().isEditorPreview()){r.onmouseup=y}r.onkeyup=y;r.oncontextmenu=y;r.ondrag=y;if(m!=null){r.CASA_id=m}if(q!=null){r.CASA_image=q}if(A!=null){r.CASA_imageinactive=A}if(b!=null){r.CASA_indexprop=b}if(u!=null){r.CASA_referenceprop=u}if(e!=null){r.CASA_visibleprop=e}if(j!=null){r.CASA_indexvalue=j}if(f!=null){r.CASA_method=f}if(l!=null){r.CASA_variant=l}if(t!=null){r.CASA_repeatindex=t}if(a!=null){r.CASA_cti=a}if(B!=null){r.CASA_tabindex=B}if(n!=null){r.CASA_invisiblemode=n}if(w!=null){r.CASA_draginfo=w}if(h!=null){r.CASA_draginfoprop=h}if(d!=null){r.CASA_dropmethod=d}if(k!=null){r.CASA_dropinfoprop=k}if(x!=null){r.CASA_titleprop=x}if(c!=null){r.CASA_switchvisibleproponuserinput=c}if(g!=null){r.CASA_imagewidth=g}if(s!=null){r.CASA_imageprop=s}if(z!=null){r.CASA_imageinactiveprop=z}if(u!=null||e!=null||x||s||r.CASA_imagertl!=null){registerListener(p)}r.CASA_memreferencevalue=undefined;r.CASA_memvisiblevalue=undefined;applyCasaTabIndex(r,"ICON")}function getWidthICON(b){var a=b.CASA_imagewidth;if(a==null){a=b.offsetWidth}return a}function romuICON(c){if(c==null){return}applyCasaTabIndex(c,"ICON");if(c.CASA_switchvisibleproponuserinput=="true"){CL().C_addSVPIcon(self,c,c.CASA_visibleprop)}var a=false;if(c.CASA_imageprop!=null){if(c.CASA_img==null){c.CASA_img=parent.gebid("ICONIMG"+c.CASA_id)}var j=getPropertyValue(c.CASA_imageprop);if(j!=c.CASA_memImg){c.CASA_image=j;if(j==null||j==""){j="../HTMLBasedGUI/general/nothing.gif"}a=true;if(c.CASA_visibleprop==null){c.CASA_memImg=c.CASA_image;c.CASA_img.src=j}}}if(c.CASA_referenceprop!=null){var j=getPropertyValue(c.CASA_referenceprop);if(j!=c.CASA_memreferencevalue){c.CASA_memreferencevalue=j;if(j==null){c.style.display="none"}else{c.style.display=""}}}if(c.CASA_titleprop!=null){var f=getPropertyValue(c.CASA_titleprop);if(f!=c.CASA_lastTitle){var g=parent.document.getElementById("ICONIMG"+c.CASA_id);if(g!=null){g.title=f}else{try{c.childNodes[0].title=f}catch(k){}}c.CASA_lastTitle=f}}if(c.CASA_visibleprop!=null){var j=findVisibleValue(getPropertyValue(c.CASA_visibleprop));if(c.CASA_memvisiblevalue==undefined||j!=c.CASA_memvisiblevalue){c.CASA_memvisiblevalue=j;j=convertStatusToVisible(j);if(c.CASA_imageinactive==null&&c.CASA_imageinactiveprop==null){if(j==null||j=="false"){if(c.CASA_invisiblemode=="cleared"&&c.offsetWidth==0){try{c.style.display="";c.CASA_memvisiblevalue=undefined;registerSwitchToDisplayListener(romuICON,c)}catch(e){}}try{c.CASA_td.width=getWidthICON(c)}catch(d){}c.style.display="none";if(c.CASA_invisiblemode!="cleared"&&c.CASA_td!=null){c.CASA_td.style.display="none"}}else{c.style.display="";if(c.CASA_td!=null){c.CASA_td.style.display=""}if(a&&(c.CASA_img!=null)){c.CASA_memImg=c.CASA_image;c.CASA_img.src=c.CASA_image}}}else{var b=parent.document.getElementById("ICONIMG"+c.CASA_id);if(j==null||j=="false"){if(b!=null){var h=c.CASA_imageinactive;if(c.CASA_imageinactiveprop!=null){h=getPropertyValue(c.CASA_imageinactiveprop);if(h==null||h==""){h="../HTMLBasedGUI/general/nothing.gif"}}b.src=h}c.style.cursor="default";c.CASA_blocked=true}else{if(b!=null){b.src=c.CASA_image}c.style.cursor="pointer";c.CASA_blocked=false}}}else{if(a){j=convertStatusToVisible(c.CASA_memvisiblevalue);if((j!=null)&&(c.CASA_img!=null)){c.CASA_memImg=c.CASA_image;if(j!="false"){c.CASA_img.src=c.CASA_image}else{var h=c.CASA_imageinactive;if(c.CASA_imageinactiveprop!=null){h=getPropertyValue(c.CASA_imageinactiveprop);if(h==null||h==""){h="../HTMLBasedGUI/general/nothing.gif"}}c.CASA_img.src=h}}}}}if(c.CASA_imagertl!=null&&c.CASA_memDir!=m_direction){c.CASA_memDir=m_direction;var b=parent.document.getElementById("ICONIMG"+c.CASA_id);if(m_direction=="rtl"){b.src=c.CASA_imagertl}else{b.src=c.CASA_image}}}function reactICON(a){return reactICONInternal(a)}function reactICONInternal(a){if(a.type=="keyup"){if(a.keyCode==13||a.keyCode==32){transferModelICON(a.currentTarget,a)}}else{if(a.type=="mousedown"){reactOnMouseDownICON(a.currentTarget,a)}else{if(a.type=="mouseup"){reactOnMouseUpICON(a.currentTarget,a)}else{if(a.type=="mouseenter"){if(checkIO()==false){return}if(a.currentTarget.CASA_blocked==true){return}a.currentTarget.className="ICONImageRollOver"}else{if(a.type=="mouseleave"){a.currentTarget.className="ICONImage"}else{if(a.type=="contextmenu"){a.returnValue=false}else{a.returnValue=false}}}}}}}function reactOnMouseDownICON(h,c){if(checkIO()==false){return}if(h.CASA_blocked==true){return}if(h.CASA_draginfo==null&&h.CASA_draginfoprop==null){return}c.preventDefault();var b="DUMMYINFO";if(h.CASA_draginfoprop!=null){b=getPropertyValue(h.CASA_draginfoprop);if(b==null||b==""){b="Error: Property "+h.CASA_draginfoprop+" does not provide for a value != null"}}else{b=h.CASA_draginfo}parent.m_dragId="ICON"+h.CASA_id;var a=h.CASA_image;if(a.substring(0,7)!="http://"){var f=window.location.pathname;var g=f.split("/");var e="";for(i=1;i<g.length-1;i++){e+=g[i]+"/"}var d=window.location.protocol+"//"+window.location.host+"/"+e;a=d+a}startDragCL(b,"<img src='"+a+"'>",c,parent)}function reactOnMouseUpICON(c,a){if(checkIO()==false){return}if(c.CASA_blocked==true){return}if(c.CASA_dropmethod!=null){if(c.CASA_dropinfoprop==null){alert("DROPICON: no DROPINFOPROP for DROPMETHOD "+c.CASA_dropmethod)}else{if(parent.m_dragId=="ICON"+c.CASA_id){transferModelICON(c,a)}else{if(checkIfDragProcessIsActiveCL()){var b=endDragCL();setPropertyValue(c.CASA_dropinfoprop,b);invokeMethodInModel(c.CASA_dropmethod)}else{if(parent.m_dragMode==true){var b=parent.m_dropInfo;parent.endDrag();setPropertyValue(c.CASA_dropinfoprop,b);invokeMethodInModel(c.CASA_dropmethod)}}}}}else{transferModelICON(c,a)}}function transferModelICON(a){if(checkIO()==false){return}if(a.CASA_blocked==true){return}if(a.CASA_indexprop!=null){setPropertyValue(a.CASA_indexprop,a.CASA_indexvalue)}if(a.CASA_repeatindex!=null){setPropertyValue("repeatIndex",a.CASA_repeatindex)}else{setPropertyValue("repeatIndex",-1)}if(a.CASA_method!=null){invokeMethodInModel(a.CASA_method)}if(a.CASA_variant!=null){setPropertyValue("variantPage",a.CASA_variant);invokeMethodInModel("switchToVariant")}}function reactCLIPBOARDICON(b,a){if(a.type=="mouseup"){transferModelCLIPBOARDICON(b,a)}else{reactICON(b,a)}}function transferModelCLIPBOARDICON(b){if(checkIO()==false){return}if(b.CASA_blocked==true){return}if(b.CASA_method!=null&&b.CASA_valueprop!=null){if(b.CASA_type=="import"){var a=parent.window.clipboardData.getData("Text");setPropertyValue(b.CASA_valueprop,a);invokeMethodInModel(b.CASA_method)}else{var a=getPropertyValue(b.CASA_valueprop);parent.window.clipboardData.setData("Text",a)}}}function addVersionInfoHELPICONCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("HELPICONCONTROLS")}function transferModelHELPICON(a){if(checkIO()==false){return}if(a.CASA_indexprop!=null){setPropertyValue(a.CASA_indexprop,a.CASA_indexvalue)}if(a.CASA_repeatindex!=null){setPropertyValue("repeatIndex",a.CASA_repeatindex)}else{setPropertyValue("repeatIndex",-1)}setPropertyValue("param2",a.CASA_helpid);invokeMethodInModel("reactOnHelpRequestForHelpId")}function reactOnModelUpdateHELPICON(b){if(b.CASA_referenceprop!=null){var a=getPropertyValue(b.CASA_referenceprop);if(a!=b.CASA_memreferencevalue){b.CASA_memreferencevalue=a;if(a==null){b.innerHTML=""}else{b.innerHTML="<a onclick='transferModel"+b.CASA_id+"();'><img border='0' src='"+b.CASA_image+"'></a>&nbsp;"}}}if(b.CASA_visibleprop!=null){var a=getPropertyValue(b.CASA_visibleprop);if(a!=b.CASA_memvisiblevalue){b.CASA_memvisiblevalue=a;if(a==null||a=="false"){b.style.display="none"}else{b.style.display=""}}}}function addVersionInfoBUTTONCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("BUTTONCONTROLS")}function flexCreateControlBUTTON(d){var c=d.width;var m=d.CONTROLID;var j=parent.createElement("TD");j.style.width=0;var k=parent.createElement("BUTTON");k.name="CC";k.id="B_"+m;k.style.width=C_adjustUnits(c);k.className="BUTTONInput";if(d.image==null){k.innerHTML=d.name}else{var g=parent.createElement("TABLE");var h=parent.createElement("TBODY");g.cellSpacing=0;g.cellPadding=0;g.border=0;var e=parent.createElement("TR");var n=parent.createElement("TD");n.className="BUTTONText";var f=parent.createElement("IMG");f.src=d.image;f.border=0;var l=parent.createElement("TD");l.className="BUTTONText";if(d.name!=null){l.innerHTML="&nbsp;"+d.name}else{l.innerHTML="&nbsp;"}l.align="center";n.appendChild(f);e.appendChild(n);e.appendChild(l);h.appendChild(e);g.appendChild(h);k.appendChild(g)}j.appendChild(k);parent["CB_"+m]=k;if(d.namepropp!=null){k.CASA_textCell=k}var a=parent.createFunction("romuB_"+m,"model","C.romuBUTTON(CB_"+m+");");var b=parent.createFunction("rohkB_"+m,"param","C.transferModelBUTTON(CB_"+m+");");iccBUTTON(parent["CB_"+m],a,b,this["reactBUTTON"],d.statuspropp,d.visiblepropp,d.variant,d.methodd,d.repeatindex,d.isfileuploadbutton,d.cfilepropp,d.sfilepropp,d.invisiblemode,d.stylevariant,d.namepropp,d.textcellid,null,d.tabindex,null,null,d.titlepropp,null,d.switchvisibleproponuserinput,d.imagepropp,null,d.focusedpropp);var p=new Object();p.cell=j;p.control=k;return p}function flexRemoveBUTTON(a){parent["romu"+a]=undefined;parent["rohk"+a]=undefined;removeListener("CB_"+a);removeHotKeys(a);parent["C"+a].CASA_td=undefined;parent["C"+a]=undefined}function iccBUTTON(t,r,h,j,k,d,l,f,x,A,n,g,q,u,b,y,a,C,s,p,B,m,c,w,e,z){if(!CL().isEditorPreview()){t.onmouseup=j;t.onmouseover=j;t.onmouseout=j;t.onkeypress=j}addFocusable(t);startFocusCell(t);if(r!=null){registerListener(r)}t.CASA_kc13Handler=true;if(k!=null){t.CASA_statusprop=k}if(z!=null){t.CASA_focusedprop=z}if(d!=null){t.CASA_visibleprop=d}if(l!=null){t.CASA_variant=l}if(f!=null){t.CASA_method=f}if(x!=null){t.CASA_repeatindex=x}if(A!=null){t.CASA_isfileuploadbutton=A}if(n!=null){t.CASA_cfileprop=n}if(g!=null){t.CASA_sfileprop=g}if(q!=null){t.CASA_invisiblemode=q}t.CASA_stylevariant="";if(u!=null){t.CASA_stylevariant=u}if(b!=null){t.CASA_nameprop=b}if(y!=null){t.CASA_textCell=parent.gebid(y)}if(a!=null){t.CASA_cti=a}if(C!=null){t.CASA_tabindex=C}if(s!=null){t.CASA_image=s}if(p!=null){t.CASA_imagedisabled=p}if(B!=null){t.CASA_titleprop=B}if(m!=null){t.CASA_resetvalerrors=m}if(c!=null){t.CASA_switchvisibleproponuserinput=c}if(w!=null){t.CASA_imageprop=w}if(e!=null){t.CASA_imagedisabledprop=e}t.CASA_td=t.parentNode;addMLButton(t,h);t.CASA_memvalue=undefined;hotKeyCode=findHotkeyKeycode(t.innerHTML);if(hotKeyCode!=null){addControlBasedHotKey(t.id,hotKeyCode,h);t.innerHTML=convertDoubleTildeToUTag(t.innerHTML)}applyCasaTabIndex(t,"BUTTON")}function romuBUTTON(f){if(f==null){return}applyCasaTabIndex(f,"BUTTON");if(f.CASA_switchvisibleproponuserinput=="true"){CL().C_addSVPButton(self,f,f.CASA_visibleprop)}if(f.CASA_focusedprop!=null){var a=getPropertyValue(f.CASA_focusedprop);if(a=="true"){addFocusRequestor(f)}}if(f.CASA_statusprop!=null){var a=getPropertyValue(f.CASA_statusprop);if(a=="DISABLED"){disableBUTTON(f)}else{enableBUTTON(f)}}if(f.CASA_nameprop!=null){var a=getPropertyValue(f.CASA_nameprop);if(a==null){a=""}if(f.CASA_memName==undefined||(convertDoubleTildeToUTag(a)!=f.CASA_memName)){removeHotKeys(f.id);var b=findHotkeyKeycode(a);if(b!=null){addControlBasedHotKey(f.id,b,parent.createFunction("rohk"+f.id,"param","C.transferModelBUTTON(C"+f.id+");"))}a=convertDoubleTildeToUTag(a);f.CASA_memName=a;f.CASA_textCell.innerHTML="&nbsp;"+a}}if(f.CASA_titleprop!=null){var e=getPropertyValue(f.CASA_titleprop);if(e!=f.CASA_lastTitle){f.title=e;f.CASA_lastTitle=e}}if(f.CASA_visibleprop==null&&f.CASA_imageprop!=null){var d=parent.gebid(f.CASA_imgid);var a=getPropertyValue(f.CASA_imageprop);if(a==null||a==""){a="../HTMLBasedGUI/general/nothing.gif"}d.src=a}if(f.CASA_visibleprop!=null){var a=findVisibleValue(getPropertyValue(f.CASA_visibleprop));if(f.CASA_memvalue!=undefined&&a==f.CASA_memvalue){if(f.CASA_imageprop!=null){a=convertStatusToVisible(f.CASA_memvalue);var d=parent.gebid(f.CASA_imgid);var c=null;if(a!=null&&a!="false"&&f.CASA_invisiblemode!="cleared"){c=getPropertyValue(f.CASA_imageprop)}if(c!=null&&c!=""){d.src=c}}}else{f.CASA_memvalue=a;a=convertStatusToVisible(a);if(a==null||a=="false"){if(f.CASA_invisiblemode==null||f.CASA_invisiblemode=="invisible"){f.style.display="none";if(f.CASA_td!=null){if(f.CASA_repeatindex==undefined||f.CASA_repeatindex==null||parseInt(f.CASA_repeatindex)<0){f.CASA_td.style.display="none"}}}if(f.CASA_invisiblemode=="cleared"){if(f.CASA_td!=null){if(f.CASA_repeatindex==undefined||f.CASA_repeatindex==null||parseInt(f.CASA_repeatindex)<0){f.CASA_td.style.visibility="collapse"}}f.style.visibility="hidden"}else{disableBUTTON(f);if((f.CASA_image!=null||f.CASA_imageprop!=null)&&(f.CASA_imagedisabled!=null||f.CASA_imagedisabledprop!=null)){var d=parent.gebid(f.CASA_imgid);var a=f.CASA_imagedisabled;if(f.CASA_imagedisabledprop!=null){a=getPropertyValue(f.CASA_imagedisabledprop);if(a==null||a==""){a="../HTMLBasedGUI/general/nothing.gif"}}d.src=a}}f.style.cursor="default"}else{if(f.CASA_invisiblemode==null||f.CASA_invisiblemode=="invisible"){f.style.display="";if(f.CASA_td!=null){f.CASA_td.style.display=""}}if(f.CASA_invisiblemode=="cleared"){if(f.CASA_td!=null){f.CASA_td.style.visibility="visible"}f.style.visibility="visible";f.style.cursor=""}else{enableBUTTON(f);if((f.CASA_image!=null&&(f.CASA_imagedisabled!=null||f.CASA_imagedisabledprop!=null))||(f.CASA_imageprop!=null)){var d=parent.gebid(f.CASA_imgid);var a=f.CASA_image;if(f.CASA_imageprop!=null){a=getPropertyValue(f.CASA_imageprop);if(a==null||a==""){a="../HTMLBasedGUI/general/nothing.gif"}}d.src=a}}f.style.cursor="pointer"}}}}function disableBUTTON(a){a.disabled=true;a.className="BUTTON"+a.CASA_stylevariant+"Input";setColorBUTTON(a,"#6C7478")}function setColorBUTTON(d,a){if(d==null){return}try{d.style.color=a}catch(c){}for(var b=0;b<d.childNodes.length;b++){setColorBUTTON(d.childNodes[b],a)}}function enableBUTTON(a){a.disabled=false;setColorBUTTON(a,"");a.style.cursor="pointer"}function reactBUTTON(a){return reactBUTTONInternal(a)}function reactBUTTONInternal(a){if(CL()==null||CL().isEditorPreview()){return}addLogMessage("BUTTONControls.reactBUTTON(): Button was pressed");addLogMessage("reactButton() called with "+a.type);if(a.type=="mouseup"){return transferModelBUTTON(a.currentTarget,a)}else{if(a.type=="keypress"){if(a.keyCode==32||a.keyCode==13){return transferModelBUTTON(a.currentTarget,a)}}else{if(a.type=="mouseover"){return CL().C_rinButtonROLLOVER(this,a.currentTarget,a.currentTarget.CASA_stylevariant)}else{if(a.type=="mouseout"){return CL().C_routButtonROLLOVER(this,a.currentTarget,a.currentTarget.CASA_stylevariant)}}}}}function transferModelBUTTON(cc,evt){if(checkIO()==false){addLogMessage("BUTTONControls.transferModelBUTTON(): checkIO is blocked");addLogMessage("transferModelBUTTON() - communication just blocked");return}if(cc.disabled||(cc.style.visibility=="hidden")){return}if(cc.CASA_resetvalerrors=="true"){m_resetValiddationErrorsAndFlush=true}if(cc.CASA_repeatindex!=null){setPropertyValue("repeatIndex",cc.CASA_repeatindex)}else{setPropertyValue("repeatIndex",-1)}if(cc.type=="submit"){for(var i=0;i<m_focusables.length;i++){if(m_focusables[i].type=="password"){transferChangeFIELD(m_focusables[i],false)}}}if(cc.CASA_isfileuploadbutton!="true"){if(cc.CASA_method==null){if(cc.CASA_variant==null){submitModel("submit")}else{setPropertyValue("variantPage",cc.CASA_variant);invokeMethodInModel("switchToVariant")}}else{if(cc.CASA_method.substr(0,11)=="javascript:"){addLogMessage("transferModelBUTTON() - calling javascript-method");eval(cc.CASA_method.substring(11))}else{addLogMessage("transferModelBUTTON() - calling invokeMethodInModel");invokeMethodInModel(cc.CASA_method)}}}else{var rValue=null;var vParameters=[];vParameters[0]=m_sessionId;vParameters[1]=parent.parent.CasaSTYLESHEET;vParameters[2]=m_direction;casaPopupParameters=vParameters;var vPopupPage="fileuploadpage_"+m_language+".html";m_buffcfileprop=cc.CASA_cfileprop;m_buffsfileprop=cc.CASA_sfileprop;m_buffpostuploadmethod=cc.CASA_method;parent.open("../HTMLBasedGUI/general/"+vPopupPage,"_blank","modal=1,width=400px,height=150px,left=200px,top=200px,scrollbars=no,status=no")}}var m_buffcfileprop;var m_buffsfileprop;var m_buffpostuploadmethod;function reactOnFileUploadClosedBUTTON(b,a){setPropertyValue(m_buffcfileprop,b);setPropertyValue(m_buffsfileprop,a);if(m_buffpostuploadmethod!=null){invokeMethodInModel(m_buffpostuploadmethod)}else{submitModel("submit")}}function reactOnModelUpdateMENUBUTTON(b){var a=findVisibleValue(getPropertyValue(b.CASA_visibleprop));a=convertStatusToVisible(a);if(a==null||a=="false"){b.style.display="none";if(b.CASA_td!=null){b.CASA_td.style.display="none"}}else{b.style.display="";if(b.CASA_td!=null){b.CASA_td.style.display=""}}}function addVersionInfoTEXTOUTCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("TEXTOUTCONTROLS")}function flexCreateControlTEXTOUT(f){var j=f.CONTROLID;var e=f.width;var h=parent.createElement("TD");var k=h;h.className="TEXTOUTColumn";if(e!=undefined){h.style.width=C_adjustUnits(e)}var d=f.nowrap;if(d!=undefined){h.noWrap=f.nowrap}if(d=="true"){var b=parent.createElement("DIV");b.noWrap="true";b.style.width="100%";b.style.overflow="hidden";h.appendChild(b);k=b}var g=parent.createElement("SPAN");g.id=j;var a="TEXTOUTSpan";if(f.stylevariant!=null){a="LABELCell"+f.stylevariant}g.className=a;k.appendChild(g);parent["S_"+j]=g;var c=parent.createFunction("romu"+j,"model","C.romuTEXTOUT(S_"+j+");");iccTEXTOUT(g,h,f.valuepropp,f.datatype,f.straighttext,f.bgcolorpropp,f.fgcolorpropp,f.visiblepropp,f.invisiblemode,f.titlepropp,f.decimaldigits);registerListener(c);var l=new Object();l.cell=h;l.control=g;return l}function flexRemoveTEXTOUT(a){parent["S_"+a]=undefined;parent["romu"+a]=undefined;removeListener("S_"+a)}function iccTEXTOUT(c,d,e,h,l,f,g,k,a,j,b){if(d!=null){c.CASA_td=d}c.CASA_memvalue="inittini";c.CASA_valueprop=e;c.CASA_bgcolorprop=f;c.CASA_fgcolorprop=g;if(h==null){c.CASA_datatype=undefined}else{c.CASA_datatype=h}if(l==null){c.CASA_straighttext=undefined}else{c.CASA_straighttext=l}if(k!=null){c.CASA_visibleprop=k}if(a!=null){c.CASA_invisiblemode=a}if(j!=null){c.CASA_titleprop=j}if(b!=null){c.CASA_decimaldigits=b}}function romuTEXTOUT(c){var g=getPropertyValue(c.CASA_valueprop);var l=getPropertyValue(c.CASA_visibleprop);var j=getPropertyValue(c.CASA_titleprop);var f=-1;if(c.CASA_decimaldigits!=null){f=c.CASA_decimaldigits}if(j==null){j=""}if(g==null){l=null}var b=null;if(c.CASA_bgcolorprop!=null){b=getPropertyValue(c.CASA_bgcolorprop)}var e=null;if(c.CASA_fgcolorprop!=null){e=getPropertyValue(c.CASA_fgcolorprop)}var a=g+"/"+l+"/"+b+"/"+e+"/"+j;if(c.CASA_memvalue==a){return}c.CASA_memvalue=a;if(c.CASA_datatype!=null){if(c.CASA_datatype=="date"){g=convertYYYYMMDDIntoDisplayString(g)}else{if(c.CASA_datatype=="time"){g=convertHHMMSSIntoDisplayString(g)}else{if(c.CASA_datatype=="timestamp"){g=convertYYYYMMDDHHMMSSMMMIntoDisplayString(g)}else{if(c.CASA_datatype=="float"){g=convertFLOATIntoDisplayString(g,f)}else{if(c.CASA_datatype=="int"||c.CASA_datatype=="long"){g=convertINTIntoDisplayString(g)}}}}}}if(c.CASA_straighttext!="true"){if(g==null||g==""){g="&nbsp;"}}else{if(g==null||g==""){g=" "}}if(c.CASA_straighttext!="true"){c.innerHTML=g}else{c.textContent=g}c.title=j;if(c.CASA_td!=null){l=convertStatusToVisible(l);if(l=="false"){var d=c.CASA_invisiblemode;if(d==undefined||d=="invisible"){c.CASA_td.style.display="none"}else{if(d=="cleared"){c.style.display="none";c.CASA_td.style.display=""}else{if(d=="disabled"){c.style.display="";c.CASA_td.style.display=""}}}}else{c.style.display="";c.CASA_td.style.display=""}}if(b!=null&&e!=null){if(b!=c.style.backgroundColor){try{c.style.backgroundColor=b;c.parentNode.style.backgroundColor=b}catch(h){}}if(e!=c.style.color){try{c.style.color=e}catch(h){}}}else{if(b!=null){if(b!=c.style.backgroundColor){try{c.style.backgroundColor=b;c.parentNode.style.backgroundColor=b;if(checkIfColorIsDarkCOLORSELECTION(b)==true){c.style.color="#FFFFFF"}else{c.style.color="#000000"}}catch(h){}}}else{if(e!=null){if(e!=c.style.backgroundColor){try{c.style.color=e;var k="";if(checkIfColorIsDarkCOLORSELECTION(e)==false){k="#000000"}if(k!=c.style.backgroundColor){c.style.backgroundColor=k;c.parentNode.style.backgroundColor=k}}catch(h){}}}}}}function addVersionInfoTEXTGRIDCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("TEXTGRIDCONTROLS")}var CT_COLUMN=0;var CT_CSVCOLUMN=1;var CT_SSCOLUMN=2;var m_dragIdTEXTGRID;var m_dragColIndexTEXTGRID;function initCasaControlTEXTGRID(a,c,b){a.CASA_bufferedchangeindex=undefined;a.CASA_keybMaxCSS=null;a.CASA_keybMaxSSS=null;a.CASA_keybCursor=null;a.CASA_keybCursorReset=null;a.m_lastDir=null;a.m_dirStyleExt="";a.CASA_previousheight=undefined;c.onmouseup=b}function getScrollBarInstance(a){return a.CASA_vscrollbar}function reactOnModelUpdateTEXTGRID(ap){var bF=new Date();var r=true;var aJ=false;if(ap.CASA_suppressModelUpdate==true){ap.CASA_suppressModelUpdate=false;return}if(ap.CASA_previousheight==null){ap.CASA_bufferedchangeindex=null}if(ap.CASA_stylevariantprop!=null){ap.CASA_stylevariant=getPropertyValue(ap.CASA_stylevariantprop)}if(ap.CASA_stylevariant==undefined){ap.CASA_stylevariant=""}if(ap.CASA_fieldparam1==null){ap.CASA_fieldparam1=getPropertyValue("cISAddons.fieldParam1")}if(ap.CASA_singleselectprop!=null){var bb=getPropertyValue(ap.CASA_singleselectprop);if(ap.CASA_memSingleSelect!=bb){if(ap.CASA_memSingleSelect!=null){alert('TEXTGRID ERROR: value of SINGLESELECTPROP "'+ap.CASA_singleselectprop+'" must no change!');return}ap.CASA_memSingleSelect=bb;if(bb=="true"){ap.CASA_singleselect=true;setPropertyValue(ap.CASA_griddataprop+".singleSelectProp",ap.CASA_selectprop);setPropertyValue(ap.CASA_griddataprop+".multiSelectProp",null)}else{ap.CASA_singleselect=false;setPropertyValue(ap.CASA_griddataprop+".singleSelectProp",null);setPropertyValue(ap.CASA_griddataprop+".multiSelectProp",ap.CASA_selectprop)}}}CL().C_stopSortTimerTEXTGRID();var aT=false;var bp=getScrollBarInstance(ap);if(bp!=null){aT=bp.CASA_bypasschangeindex}if(aT!=true&&ap.CASA_changeindexprop!=null&&ap.CASA_inrepeattag!=true){var I=getPropertyValue(ap.CASA_changeindexprop);if(ap.CASA_bufferedchangeindex!=null&&ap.CASA_bufferedchangeindex==I&&ap.m_lastDir==m_direction){return}ap.CASA_bufferedchangeindex=I}m_TEXTGRIDbypasschangeindex=false;ap.m_lastDir=m_direction;var X="";var ad="style='table-layout: fixed;height: 100%;'";var l="right";if(m_direction=="rtl"){ap.m_dirStyleExt="RTL";X=' STYLE="background-position: left center;" ';ad="style='table-layout: fixed;height: 100%;background-position: left center;'";l="left"}else{ap.m_dirStyleExt="";X=""}if(ap.CASA_personalizable=="true"){if(ap.CASA_columnsequenceprop==null){ap.CASA_columnsequenceprop="casabacPM.TEXTGRIDSEQUENCE"+ap.CASA_displayitemsprop}var a6=getPropertyValue(ap.CASA_columnsequenceprop);if(a6!=null&&a6!=""){if(ap.CASA_colinfosorigin==null){ap.CASA_colinfosorigin=ap.CASA_colinfos}var ae=decodeCSVString(a6);var C=[];var bP=0;for(var bi=0;bi<ae.length;bi++){if(ae[bi]!=null&&ae[bi]!=""){var E=ap.CASA_colinfosorigin[ae[bi]];if(E!=null){C[bP]=E;bP++}}}ap.CASA_colinfos=C}if(ap.CASA_griddataprop!=null){var aV=getPropertyValue(ap.CASA_griddataprop+".columnWidthsAsCSVString");if(aV!=null&&aV.length!=0){aV=decodeCSVString(aV);for(var bi=0;bi<aV.length;bi++){ap.CASA_colinfos[bi].width=aV[bi]}}}if(ap.CASA_sortprop!=null){if(ap.CASA_sortsequenceprop!=null&&ap.CASA_sortsequenceprop!=""){var a1=getPropertyValue(ap.CASA_sortsequenceprop);if(a1!=null){var W=decodeCSVString(a1);var aI=[];var Z=new Array;for(var an=0;an<W.length;an++){if(an%2==0){aI.push(W[an])}else{Z.push(W[an])}}for(var am=0;am<ap.CASA_colinfos.length;am++){ap.CASA_colinfos[am].sortascending="";ap.CASA_colinfos[am].sortorder=-1;for(var al=0;al<aI.length;al++){if(ap.CASA_colinfos[am].property==ap.CASA_colinfosorigin[aI[al]].property){ap.CASA_colinfos[am].sortascending=Z[al];ap.CASA_colinfos[am].sortorder=al;break}}}}}else{var F=getPropertyValue(ap.CASA_sortprop+".sortProperty");var Y=getPropertyValue(ap.CASA_sortprop+".ascending");for(var am=0;am<ap.CASA_colinfos.length;am++){ap.CASA_colinfos[am].sortascending="";ap.CASA_colinfos[am].sortorder=-1;if(ap.CASA_colinfos[am].property==F||ap.CASA_colinfos[am].imageprop==F){ap.CASA_colinfos[am].sortascending=Y;ap.CASA_colinfos[am].sortorder=0-0}}}}}ap.CASA_keybMaxSSS=-1;ap.CASA_colHeaders=[];var bI=true;if(ap.CASA_withtitlerow=="false"){bI=false}var bB="";if(bI){bB+="<tr>"}var bi=0;var ba="15";if(CL().isWM(this)){ba="27"}if(ap.CASA_selectprop!=null&&ap.CASA_withselectioncolumn!=false&&bI==true){var g="class='TEXTGRID"+ap.CASA_stylevariant+"CellHeader'";var bz="";if(ap.CASA_selectalllinesprop!=null||ap.CASA_rowcount==null||ap.CASA_rowcount<=0){if(ap.CASA_selectalllinespropertyvalue==null){ap.CASA_selectalllinespropertyvalue=false}var aa;if(ap.CASA_selectalllinesprop!=null){aa=getPropertyValue(ap.CASA_selectalllinesprop)}else{aa=ap.CASA_selectalllinespropertyvalue}if(aa==true||aa=="true"){g="class='TEXTGRID"+ap.CASA_stylevariant+"CellHeaderDeselectAllLines'"}else{g="class='TEXTGRID"+ap.CASA_stylevariant+"CellHeaderSelectAllLines'"}bz=" "+getTesttoolidHtml()+"='"+ap.CASA_testtoolid+"_selectAll' onclick='selectAllLines"+ap.CASA_id+"();' ondblclick='selectAllLines"+ap.CASA_id+"();'"}if(ap.CASA_withselectioncolumnicon==false){g="class='TEXTGRID"+ap.CASA_stylevariant+"CellHeader'";bz=" "+getTesttoolidHtml()+"='"+ap.CASA_testtoolid+"_selectAll' "}ba=presetDefaultWidthTEXTGRID(ba);bB+="<td id='TG"+ap.CASA_id+"TITLECELLSELECT' width='"+C_adjustUnits(ba)+"' "+g+" "+bz+" ><table width='"+C_adjustUnits(ba)+"'></table></td>"}var bJ="";bJ="onmouseup='reactOnMouseUp"+ap.CASA_id+"(event);' onmousedown='reactOnMouseDown"+ap.CASA_id+"(event);' ondblclick='reactOnDblClickHeader"+ap.CASA_id+"(event);' ";bJ+="oncontextmenu='event.stopPropagation(); return false;'";var aj=0;var n=ap.CASA_colinfos.length;var by=true;for(bi=0;bi<n;bi++){var N=ap.CASA_colinfos[bi];if(N.columntype==null||N.columntype==CT_COLUMN){var ax=ap.CASA_colinfos[bi].name;if(ax==null){ax=""}var L=ax.replace(/&apos;/g,"'");var aH="";if(ap.CASA_colinfos[bi].sorttitle!=null){aH=ap.CASA_colinfos[bi].sorttitle}var aB=L;if(ap.CASA_colinfos[bi].title!=null){aB=ap.CASA_colinfos[bi].title}var a3='class="TEXTGRID'+ap.CASA_stylevariant+'CellHeader"';if(ap.CASA_sortprop!=null&&ap.CASA_personalizable=="true"&&ap.CASA_colinfos[bi].withsorticon!="false"){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderUnsorted"+ap.m_dirStyleExt+'"'}if(N.sortorder!="-1"&&N.sortascending=="true"){if(N.sortorder==0){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderAscending"+ap.m_dirStyleExt+'"'}else{if(N.sortorder==1){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderAscending1"+ap.m_dirStyleExt+'"'}else{a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderAscending2"+ap.m_dirStyleExt+'"'}}}if(N.sortorder!="-1"&&N.sortascending=="false"){if(N.sortorder==0){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderDescending"+ap.m_dirStyleExt+'"'}else{if(N.sortorder==1){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderDescending1"+ap.m_dirStyleExt+'"'}else{a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderDescending2"+ap.m_dirStyleExt+'"'}}}var bT="";if(a3!=null){bT=a3.substr(0,a3.length-1)+'PADDING"'}if(N.width!=null&&N.width!=""){by=false}if(r==true&&N.width!=null&&N.width.search("%")>=0){r=false}N.CASA_align="";N.CASA_nbsp="";if(N.align!=null){N.CASA_align="align='"+N.align+"'"}else{if(ap.CASA_fieldparam1=="true"&&(N.datatype=="int"||N.datatype=="long"||N.datatype=="float")){N.CASA_align="align='"+l+"'"}}if(!CL().isAMN(this)){if(N.CASA_align.indexOf("right")>0){N.CASA_nbsp="&nbsp;"}}if(bI){ap.CASA_colinfos[bi].width=presetDefaultWidthTEXTGRID(ap.CASA_colinfos[bi].width);var V="";if(ap.CASA_colinfos[bi].headerimage!=null){V="<img src='"+ap.CASA_colinfos[bi].headerimage+"'>&nbsp;"}if(ap.CASA_colinfos[bi].width!=null&&ap.CASA_colinfos[bi].width.search("%")>=0&&ap.CASA_fixedcolumnsizes!=true&&ap.m_dirStyleExt!="RTL"){ad="style='height: 100%;'"}var bk=N.property;if(bk==null){bk=N.imageprop}var bt="";if(N.headernowrap==null||N.headernowrap.toLowerCase()!="false"){bt=" nowrap='true' "}else{aJ=true}bB+="<td id='TG"+ap.CASA_id+"COL"+aj+"' "+bJ+' width="'+C_adjustUnits(ap.CASA_colinfos[bi].width)+'" '+a3+" "+X+"><div id='TGDIV"+ap.CASA_id+"COL"+aj+'\' nowrap="true" style="width: '+C_adjustUnits(determineDivWidthTEXTGRID(N.width))+"; overflow-x: hidden;\"><table width='100%' cellpadding=0 cellspacing=0 "+a3+" "+ad+"><tr><td "+bt+" width='100%' "+N.CASA_align+" "+bT+" title='"+convertApos(aB)+"'>"+V+L+N.CASA_nbsp+"</td>";if(ap.CASA_sortprop!=null&&ap.CASA_colinfos[bi].withsorticon!="false"){bB+="<td width='"+C_adjustUnits(ba)+"' title='"+convertApos(aH)+"' style='cursor:pointer'><img style='display:block' src='../HTMLBasedGUI/general/nothing.gif' width="+C_adjustUnits(ba)+"></td>"}if(ap.CASA_griddataprop!=null&&ap.CASA_disablecolumnresizing!=true){bB+="<td id='TG"+ap.CASA_id+"RES"+aj+"' width='3px' height='100%'><div class='VSPLITLine' style='height: 100%;'>&nbsp;</div></td>"}bB+="</tr></table></div></td>";aj++;ap.CASA_colinfos[bi].type="COLUMN";ap.CASA_colHeaders.push(ap.CASA_colinfos[bi])}}else{if(ap.CASA_colinfos[bi].columntype==CT_CSVCOLUMN||ap.CASA_colinfos[bi].columntype==CT_SSCOLUMN){var bO=getPropertyValue(N.titlesprop);if(bO==null){continue}var af=decodeCSVStringUsingBuffer(bO);var aV=getPropertyValue(N.widthsprop);if(aV==null){alert("No widths are passed in CSVCOLUMN - TEXTGRID will not be properly rendered");return}var aG=decodeCSVStringUsingBuffer(aV);if(aG.length!=af.length){alert("Number of width elements in CSVCOLUMN does not match number of title elements");return}for(var R=0;R<aG.length;R++){if(aG[bi]!=null&&aG[bi]!=""){by=false;break}}var U=null;var aZ=N.proprefsprop;if(aZ!=null){var aF=getPropertyValue(aZ);if(aF!=null){U=decodeCSVStringUsingBuffer(aF);if(U.length!=af.length){alert("Number of property references is not equal to number of titles");continue}}}var bQ=N.alignsprop;if(bQ!=null){var x=getPropertyValue(bQ);if(x!=null){var aX=decodeCSVStringUsingBuffer(x);if(aX.length!=af.length){alert("Number of aligns is not equal to number of titles");continue}N.alignArray=aX}}var K=N.sorttitlesprop;if(K!=null){var av=getPropertyValue(K);if(av!=null){var ak=decodeCSVStringUsingBuffer(av);if(ak.length!=af.length){alert("Number of sort titles is not equal to number of titles");continue}N.sorttitlesArray=ak}}N.tooltiptitlesArray=af;var bS=N.tooltiptitlesprop;if(bS!=null){var bv=getPropertyValue(bS);if(bv!=null){var y=decodeCSVStringUsingBuffer(bv);if(y.length!=af.length){alert("Number of tooltip titles is not equal to number of titles");continue}N.tooltiptitlesArray=y}}var h=N.linkmethodsprop;if(h!=null){var bE=getPropertyValue(h);if(bE!=null){bE=decodeCSVStringUsingBuffer(bE);if(af.length==1&&bE.length==0){bE.push("")}if(bE.length!=af.length){alert("Number of link methods "+bE.length+" is not equal to number of titles "+af.length);continue}N.linkmethodsArray=bE}}var u=N.headerimageprop;if(u!=null){var T=getPropertyValue(u);if(T!=null){T=decodeCSVStringUsingBuffer(T);if(T.length!=af.length){alert("Number of link header images is not equal to number of titles");continue}N.headerImageArray=T}}var bD=N.straighttextprop;if(bD!=null){var bn=getPropertyValue(bD);if(bn!=null){bn=decodeCSVStringUsingBuffer(bn);if(bn.length!=af.length){alert("Number of straighttextprop values is not equal to number of titles");continue}N.straighttextArray=bn}}for(bh=0;bh<af.length;bh++){var a2=null;if(U!=null&&bh<U.length){a2=U[bh]}var a3='class="TEXTGRID'+ap.CASA_stylevariant+'CellHeader"';var bH=false;if(a2!=null){bH=checkIfStringEndsWith(a2,"NOSORT")}if(a2!=null&&!bH&&ap.CASA_sortprop!=null){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderUnsorted"+ap.m_dirStyleExt+'"';var bU=getPropertyValue(ap.CASA_sortprop+".sortProperty");var k=getPropertyValue(ap.CASA_sortprop+".ascending");if(a2==bU){if(k=="true"){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderAscending"+ap.m_dirStyleExt+'"'}if(k=="false"){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderDescending"+ap.m_dirStyleExt+'"'}}}if(N.sortorder!="-1"&&N.sortascending=="false"){if(N.sortorder==0){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderDescending"+ap.m_dirStyleExt+'"'}else{if(N.sortorder==1){a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderDescending1"+ap.m_dirStyleExt+'"'}else{a3='class="TEXTGRID'+ap.CASA_stylevariant+"CellHeaderDescending2"+ap.m_dirStyleExt+'"'}}}var bT="";if(a3!=null){bT=a3.substr(0,a3.length-1)+'PADDING"'}var az="";if(N.alignArray!=null&&N.alignArray[bh]!=null){az="align='"+N.alignArray[bh]+"'"}if(bI){var V="";if(N.headerImageArray!=null){V="<img src='"+N.headerImageArray[bh]+"'>&nbsp;"}var q="";if(N.sorttitlesArray!=null){q=N.sorttitlesArray[bh]}var B=af[bh];if(N.tooltiptitlesArray[bh]!=null){B=N.tooltiptitlesArray[bh]}if(B==null){B=""}aG[bh]=presetDefaultWidthTEXTGRID(aG[bh]);if(aG[bh]!=null&&aG[bh].search("%")>=0&&ap.CASA_fixedcolumnsizes!=true){ad="style='height: 100%;'"}var bt="";if(N.headernowrap==null||N.headernowrap.toLowerCase()!="false"){bt=" nowrap='true' "}else{aJ=true}bB+="<td id='TG"+ap.CASA_id+"COL"+aj+"' "+bJ+' width="'+aG[bh]+'" '+a3+" "+X+"><div id='TGDIV"+ap.CASA_id+"COL"+aj+'\' nowrap="true" style="width:\''+determineDivWidthTEXTGRID(aG[bh])+"'; overflow-x: hidden\"><table width='100%' cellpadding=0 cellspacing=0 "+a3+" "+ad+"><tr><td "+bt+" width='100%' "+az+" "+bT+" title='"+convertApos(B)+"'>"+V+af[bh]+"</td>";if(ap.CASA_sortprop!=null&&a2!=null&&bH!=true){bB+="<td width='22px' title='"+convertApos(q)+"' style='cursor:pointer'><img style='display:block' src='../HTMLBasedGUI/general/nothing.gif' width="+ba+"></td>"}else{bB+="<td width='1px'></td>"}if(ap.CASA_griddataprop!=null&&N.withgridcolheaders=="true"&&ap.CASA_disablecolumnresizing!=true){bB+="<td id='TG"+ap.CASA_id+"RES"+aj+"' width='3px' height='100%'><div class='VSPLITLine' style='width:100%;height: 100%;'>&nbsp;</div></td>"}bB+="</tr></table></div></td>";aj++;var bK=new Object();bK.property=a2;if(a2==null){bK.property="csv"+bh}bK.width=aG[bh];bK.name=af[bh];bK.type="CSVCOLUMN";ap.CASA_colHeaders.push(bK)}if(r==true&&aG[bh].search("%")>=0){r=false}}N.widthArray=aG}}}if(bI){bB+="</tr>"}if(m_doLog){addLogMessage("reactOnModelUpdateTEXTGRID - starting line processing")}var bf=0;var ah=-1;var ar=[];var f=0;if(ap.CASA_onloadbehaviour=="collection"||(ap.CASA_onloadbehaviour=="collectionorblock"&&getPropertyValue(ap.CASA_param1prop)=="true")){f=(1*getPropertyValue(ap.CASA_topindexprop))}while(true){if(ap.CASA_rowcount>0&&bf>=ap.CASA_rowcount){break}var bs="";var e=[];var bG=bf+f;var d=ap.CASA_displayitemsprop+"["+bG+"].";var a4=getSelectableTEXTGRID(ap,d);var aO="cursor: pointer;";if(ap.CASA_selectprop==null||ap.CASA_withselectioncolumn==false||a4=="false"){aO="cursor:default;"}var aE=null;if(ap.CASA_selectprop!=null){aE=getPropertyValue(d+ap.CASA_selectprop)}if(ap.CASA_focusedprop!=null&&ah==-1){var aU=getPropertyValue(d+ap.CASA_focusedprop);if(aU=="true"){ah=bf}}var bd=true;var bi=0;for(bi=0;bi<ap.CASA_colinfos.length;bi++){var N=ap.CASA_colinfos[bi];if(N.columntype==null||N.columntype==CT_COLUMN){var H=getPropertyValue(d+N.property);if(H!=null&&N.straighttext==true){H=convertSpecialHTMLCharacters(H);if(N.cuttextline==false&&H.indexOf("\n")>=0){H=H.replace(/\n/g,"<br>")}}var aL=null;if(N.imageprop!=null){aL=getPropertyValue(d+N.imageprop);if(aL!=null&&aL!=""){var t="";var bC=N.linkmethod;if(N.celllinkmethodprop!=null){bC=getPropertyValue(d+N.celllinkmethodprop)}if(bC!=null&&bC!=""){t="onclick='C.invokeMethodInModelTEXTGRID(\""+ap.CASA_arrayprop+"["+bG+"]."+bC+"\");' style='cursor:pointer'"}aL="<img class='TEXTGRIDImgCellContent' src='"+aL+"' "+t+"/>&nbsp;&nbsp;"}}var ag="";if(N.celltitleprop!=null){ag=getPropertyValue(d+N.celltitleprop);if(ag!=null&&ag!=""){ag=" title='"+convertApos(ag)+"'"}}var br="";if(N.textstyleprop!=null){br=getStylePropertyValue(d+N.textstyleprop)}if(ap.CASA_fgselect==true&&aE=="true"){br+=";background-image:url(../HTMLBasedGUI/images/shadedbackground.gif)"}var D="";if(N.textclassprop!=null){D="class='"+getPropertyValue(d+N.textclassprop)+"'"}else{if(bf%2==1){D="class='TEXTGRID"+ap.CASA_stylevariant+"CellContentDarkPADDING'"}else{D="class='TEXTGRID"+ap.CASA_stylevariant+"CellContentPADDING'"}}var b="overflow-x:hidden;overflow-y:hidden;text-overflow:clip;white-space:nowrap;";if(N.cuttextline==false){b=""}if(N.datatype!=null){if(N.datatype=="date"){H=convertYYYYMMDDIntoDisplayString(H)}if(N.datatype=="time"){H=convertHHMMSSIntoDisplayString(H)}if(N.datatype=="timestamp"){H=convertYYYYMMDDHHMMSSMMMIntoDisplayString(H)}if(N.datatype=="float"){if(N.decimaldigits>=0){H=convertFLOATIntoDisplayString(H,N.decimaldigits)}else{H=convertFLOATIntoDisplayString(H)}}if(N.datatype=="int"||N.datatype=="long"){H=convertINTIntoDisplayString(H)}}if(H==null&&aL==null&&bf>=ap.CASA_rowcount&&(ap.CASA_minapparentrows==undefined||bf>=ap.CASA_minapparentrows)){break}if(H!=null||aL!=null){bd=false}if(H==null&&aL==null&&(bf<ap.CASA_rowcount||bf<ap.CASA_minapparentrows)){H="&nbsp;"}if(H==null){H=""}if(aL==null){aL=""}e.push("<td ");var bu=N.property;if(bu==null){bu=""}var bq=" CASA_cell='"+bu+"' ";e.push(bq);e.push(' style="');e.push(br);e.push('" width="');N.width=presetDefaultWidthTEXTGRID(N.width);e.push(C_adjustUnits(N.width));e.push('"');e.push(ag);e.push(">");e.push("<div ");e.push(N.CASA_align);e.push(" ");e.push(D);e.push(" ");e.push(' style="overflow: hidden;');e.push(b);e.push(" width:");var aS=determineDivWidthTEXTGRID(N.width);e.push(C_adjustUnits(aS));e.push(";");e.push(br);e.push('">');if(N.convertspaces==true){H=H.replace(/ /g,"&nbsp;")}e.push(aL);var bC=N.linkmethod;if(N.celllinkmethodprop!=null){bC=getPropertyValue(d+N.celllinkmethodprop)}if(bC!=null&&bC!=""&&H!="&nbsp;"){e.push("<a href='javascript:C.invokeMethodInModelTEXTGRID(\""+ap.CASA_arrayprop+"["+bG+"]."+bC+"\");' onclick='event.stopPropagation();' class='TEXTGRID"+ap.CASA_stylevariant+"Link'>")}e.push(H);e.push(N.CASA_nbsp);if(N.linkmethod!=null&&H!="&nbsp;"){e.push("</a>")}e.push("</div></td>")}else{if(N.columntype==CT_CSVCOLUMN){var bO=getPropertyValue(N.titlesprop);var af=decodeCSVStringUsingBuffer(bO);var bl=getPropertyValue(d+N.valuesprop);if(bl==null&&bf>=ap.CASA_rowcount&&(ap.CASA_minapparentrows==undefined||bf>=ap.CASA_minapparentrows)){break}var s=null;if(N.backgroundsprop!=null){var aq=getPropertyValue(d+N.backgroundsprop);if(aq!=null){s=decodeCSVStringUsingBuffer(aq)}}var ab=null;if(N.imageprop!=null){var be=getPropertyValue(d+N.imageprop);if(be!=null){ab=decodeCSVStringUsingBuffer(be)}}var a9=null;if(N.celltooltiptitleprop!=null){var aK=getPropertyValue(d+N.celltooltiptitleprop);if(aK!=null){a9=decodeCSVStringUsingBuffer(aK)}}var bA=null;if(N.celllinkmethodsprop!=null){var ac=getPropertyValue(d+N.celllinkmethodsprop);if(ac!=null){bA=decodeCSVStringUsingBuffer(ac)}}var S=true;if(bl!=null&&bl!=""){S=false}if(S==false){bd=false}if(bl==null&&bf<ap.CASA_rowcount&&(bf<ap.CASA_rowcount||bf<ap.CASA_minapparentrows)){bl=""}var ay=decodeCSVStringEMPTY(bl);if(S==false){var bN=N.widthArray.length-ay.length;if(bN!=0){alert("CSVCOLUMN: Number of value elements does not match number of width elements");break}}var ao=null;var br="";if(N.textstyleprop!=null){try{br=getStylePropertyValue(d+N.textstyleprop);if(br!=null&&br!=""){ao=decodeCSVStringUsingBuffer(br);if(af.length>0){if(ao.length>af.length){var at=ao.length%af.length;if(at==0){var aP=ao.length/af.length;var O=[];for(var bL=0;bL<ao.length;bL+=aP){var G="";for(var aR=0;aR<aP;aR++){G+=ao[bL+aR]+";"}O.push(G)}ao=O}else{alert("CSVCOLUMN: number of style elements doesn't correspond to number of titles");break}}}else{alert("CSVCOLUMN: title array has no elements");break}}}catch(aM){}}if(ap.CASA_fgselect==true&&aE=="true"){br+=";background-image:url(../HTMLBasedGUI/images/shadedbackground.gif)"}var D="";if(bf%2==1){D="class='TEXTGRID"+ap.CASA_stylevariant+"CellContentDarkPADDING'"}else{D="class='TEXTGRID"+ap.CASA_stylevariant+"CellContentPADDING'"}if(N.textclassprop!=null){D="class='"+getPropertyValue(d+N.textclassprop)+"'"}var b="overflow-x:hidden;overflow-y:hidden;text-overflow:clip;white-space:nowrap;";if(N.cuttextline==false){b=""}var bh=0;e.push(" ");var a8='<td  style="';var a7="'><div "+D+" ";var P=N.widthArray;if(P==null){return}for(bh=0;bh<P.length;bh++){var au="";if(N.alignArray!=null){au="align='"+N.alignArray[bh]+"'"}var A=br;if(ao!=null&&ao.length>bh){A=ao[bh]}if(s!=null&&s.length>bh){baj=s[bh];if(baj!=""){A="color:"+determineContrastColorCOLORSELECTION(baj)+";background-color:"+baj+";"+A}}var ag="";if(a9!=""&&a9!=null&&a9.length>bh){var bm=a9[bh];if(bm!=""&&bm!=null){ag=" title='"+convertApos(bm)+"'"}}var c="";var aY="";var bM="";var bC="";if(N.linkmethodsArray!=null&&N.linkmethodsArray[bh]!=null&&N.linkmethodsArray[bh]!=""){bC=N.linkmethodsArray[bh]}if(bA!=null&&bA[bh]!=null&&bA[bh]!=""){bC=bA[bh]}if(bC!=""){bM="onclick='C.invokeMethodInModelTEXTGRID(\""+ap.CASA_arrayprop+"["+bG+"]."+bC+"\");'";c="<a href='javascript:C.invokeMethodInModelTEXTGRID(\""+ap.CASA_arrayprop+"["+bG+"]."+bC+"\");' onclick='event.stopPropagation();' class='TEXTGRID"+ap.CASA_stylevariant+"Link'>";aY="</a>"}e.push(a8);e.push(A);var bq='" ';if(U!=""&&U!=null&&U.length>bh){bq+=" CASA_cell='"+U[bh]+"' "}e.push(bq);P[bh]=presetDefaultWidthTEXTGRID(P[bh]);e.push(" width='");e.push(C_adjustUnits(P[bh]));e.push(a7);e.push(au);e.push(ag);e.push(' style="overflow-x:hidden;');e.push(b);e.push(" width:");e.push(C_adjustUnits(determineDivWidthTEXTGRID(P[bh])));e.push('">');if(S==false){var M=ay[bh];var aw=N.straighttext;if(N.straighttextArray!=null&&N.straighttextArray[bh]!=null){aw=N.straighttextArray[bh]=="true"}if(M!=null&&aw==true){M=convertSpecialHTMLCharacters(M);if(N.cuttextline==false&&M.indexOf("\n")>=0){M=M.replace(/\n/g,"<br>")}}if(N.cuttextline==true){M=M.replace(/ /g,"&nbsp;")}if(ab!=""&&ab!=null&&ab.length>bh){var p=ab[bh];if(p!=null&&p!=""){p="<img class='TEXTGRIDImgCellContent' src='"+ab[bh]+"' "+bM+"/>&nbsp;&nbsp;";e.push(p)}}e.push(c);e.push(M);e.push(aY)}else{e.push("&nbsp;")}e.push("</div></td>")}}else{if(N.columntype==CT_SSCOLUMN){var J=getPropertyValue(d+N.valuesprop);if(J!=null){bd=false}if(J==null&&bf>=ap.CASA_rowcount){break}if(J==null){e.push("<td colspan=100></td>")}else{e.push(J)}by=false}}}}bs=e.join("");if(bs==""){if(ap.CASA_minapparentrows==undefined||bf>=ap.CASA_minapparentrows){break}}if(bd==true&&ap.CASA_showemptylines==false){if(ap.CASA_minapparentrows==null||bf>=ap.CASA_minapparentrows){break}}var bg=[];bg[2]=bs;aW="TGROW"+ap.CASA_id+"_"+bf;var aA;if(bf%2==1){aA="TEXTGRID"+ap.CASA_stylevariant+"CellContentDark"}else{aA="TEXTGRID"+ap.CASA_stylevariant+"CellContent"}if(aE=="true"||aE==true){aA="TEXTGRID"+ap.CASA_stylevariant+"CellSelectedContent"}var bo="";if(bf%2==0&&ap.CASA_evenrowstyle!=null){bo=ap.CASA_evenrowstyle}if(bf%2==1&&ap.CASA_oddrowstyle!=null){bo=ap.CASA_oddrowstyle}if(ap.CASA_selectprop!=null&&ap.CASA_withselectioncolumn!=false){var ai="";if(a4=="false"){ai="Disabled"}var m="";if(bd==false){m="class='TEXTGRID"+ap.CASA_stylevariant+ai+"CellUnselectColumn'"}if(aE=="true"||aE==true){m="class='TEXTGRID"+ap.CASA_stylevariant+ai+"CellSelectColumn"+ap.m_dirStyleExt+"'"}ba=presetDefaultWidthTEXTGRID(ba);bg[1]="<td "+m+" width='0' id='"+aW+"FC'><table cellpadding=0 cellspacing=0 border=0 width="+C_adjustUnits(ba)+"><tr><td width='100%'></td></tr></table></td>"}else{bg[1]=""}if(bd==false){bg[0]="<tr tabindex='"+ap.tabIndex+"' id=\""+aW+'" style="'+aO+bo+'" class="'+aA+'">';bg[3]="</tr>"}else{var bj='onmouseup="event.stopPropagation();"';vEmptyRowId="TGEMPTYROW"+ap.CASA_id+"_"+bf;bg[0]="<tr id='"+vEmptyRowId+"' class='TEXTGRID"+ap.CASA_stylevariant+"RowEmpty' "+bj+">";bg[3]="</tr>";if(ap.CASA_keybMaxSSS==-1){ap.CASA_keybMaxSSS=bf}}ar.push(bg.join(""));bf++}if(m_doLog){addLogMessage("reactOnModelUpdateTEXTGRID - lines processed: "+bf)}var bx="";if(r==false){bx="width='100%'"}if(by==true){bx="width='100%'"}var z="";if(ap.CASA_fixedcolumnsizes==true){z="table-layout:fixed;";if(bx==""){bx="width='1px'"}}var bc=ar.join("");var aC="event.ctrlKey";var bw="event.shiftKey";var bR=" return false;";if(ap.CASA_enabledefaultcontextmenu=="true"){bR=""}var aN="";var a5="";if(ap.CASA_withrollover!=false){aN="onmouseover='C.enterRowTEXTGRID(C.getEventRowTEXTGRID(event),\""+ap.CASA_stylevariant+"\");' ";var a=ap.CASA_displayitemsprop+'["+('+f+'+C.getEventRowNumberTEXTGRID(event))+"].'+ap.CASA_selectprop;a5="onmouseout='C.leaveRowTEXTGRID(C.getEventRowTEXTGRID(event),\""+a+'",C.getEventRowNumberTEXTGRID(event),"'+ap.CASA_stylevariant+"\");'"}var Q="";Q="onfocus='C.reactonfocusTEXTGRID("+ap.CASA_id+", C.getEventRowNumberTEXTGRID(event));'";var bj='onmouseup="event.stopPropagation();"';var aD="";if(ap.CASA_draginfoprop!=null||ap.CASA_draginfoprop!=undefined){aD="onmousedown ='reactOnMouseDownOnRowTEXTGRID"+ap.CASA_id+"(event,C.getEventRowIdTEXTGRID(event));'"}var a0="<table "+bx+" "+getTesttoolidHtml()+"='"+ap.CASA_testtoolid+"_table' cellspacing=1 cellpadding=0 class='TEXTGRID"+ap.CASA_stylevariant+"Table'";if(ap.CASA_onclickmethod==null){if(ap.CASA_ondblclickmethod==null){a0+=" "+bj+' onclick="selectRow'+ap.CASA_id+"(C.getEventRowNumberTEXTGRID(event), "+aC+", "+bw+');"'}else{a0+=' onmouseup="selectRow'+ap.CASA_id+"(C.getEventRowNumberTEXTGRID(event), "+aC+", "+bw+');event.stopPropagation();"'}}else{a0+=" "+bj+" onclick='var evn = C.getEventRowNumberTEXTGRID(event);selectRow"+ap.CASA_id+"(evn, "+aC+", "+bw+", true); reactOnClick"+ap.CASA_id+"(evn);'"}if(ap.CASA_ondblclickmethod!=null){a0+=' ondblclick="C.dsc(); reactOnDblClick'+ap.CASA_id+'(C.getEventRowNumberTEXTGRID(event));"'}a0+=aN+" "+a5+" "+Q+" "+aD+" oncontextmenu='CASA_event = event; onContextMenuRequest"+ap.CASA_id+"(C.getEventRowNumberTEXTGRID(event));"+bR+"'  style='"+z+ap.CASA_backgroundstyle+"'>"+bB+bc+"</table>";if(m_doLog){addLogMessage("reactOnModelUpdateTEXTGRID - Before innerHTML")}ap.innerHTML=a0;if(m_doLog){addLogMessage("reactOnModelUpdateTEXTGRID - After innerHTML")}window.setTimeout(function(){doResizeTEXTGRID(ap,aJ)},30);if(ah!=-1){ap.CASA_keybCursor=ah;var aW="TGROW"+ap.CASA_id+"_"+ah;var aQ=parent.gebid(aW);addFocusRequestor(aQ)}if(!isSuppressFocus()){setTimeout(function(){setKeyboardFocusTEXTGRID(ap,ap.CASA_keybCursor)},300)}ap.CASA_keybMaxCSS=bf-1}function doResizeTEXTGRID(d,g){var c=parent.document.getElementById("TEXTGRIDDIV"+d.CASA_id);if(c!=null){if(g==true){for(var a=0;a<d.CASA_colinfos.length;a++){var f=parent.document.getElementById("TGDIV"+d.CASA_id+"COL"+a);if(f==null){continue}var e=f.parentNode;var h=e.style;var b=e.scrollHeight;if(parent.m_roi_firstusage==true){b=e.offsetHeight}if(b>0){b=C_adjustUnits((b-calculatePixelValue(h.paddingTop)-calculatePixelValue(h.paddingBottom)))}f.style.height=b}}reactOnResizeTEXTGRIDExecute(d,c,true)}}function getEventRowTEXTGRID(a){var b=findSrcElement(a);if(b==null){return null}var c=b;while(c.nodeName!="tr"&&c.nodeName!="TR"){c=c.parentNode}if(!getIdFromEventRowTEXTGRID(c)){return null}if(isEmptyRowTEXTGRID(c)){return null}return c}function getIdFromEventRowTEXTGRID(a){if(!a||!a.id){return null}return a.id}function getEventRowIdTEXTGRID(a){return getIdFromEventRowTEXTGRID(getEventRowTEXTGRID(a))}function getEventRowNumberTEXTGRID(a){var b=getEventRowIdTEXTGRID(a);if(!b){return -1}return b.split("_")[1]*1}function isEmptyRowTEXTGRID(a){if(!a||!a.id){return true}return(a.id.search(/EMPTY/)!=-1)}function enterRowTEXTGRID(b,a){if(checkIO()==false){return false}else{if(isEmptyRowTEXTGRID(b)){return true}}b.className="TEXTGRID"+a+"CellRolloverContent";return true}function leaveRowTEXTGRID(d,c,e,a){if(isEmptyRowTEXTGRID(d)){return}var b=getPropertyValue(c);if(b==true||b=="true"){d.className="TEXTGRID"+a+"CellSelectedContent"}else{if(e%2==0){d.className="TEXTGRID"+a+"CellContent"}else{d.className="TEXTGRID"+a+"CellContentDark"}}}var mm_selectRowTEXTGRID=null;function selectRowTEXTGRID(a,e,d,b,c){if(e==-1){return}if(a!=null&&getSelectableTEXTGRID(a,a.CASA_displayitemsprop+"["+e+"].")=="false"){return}if(mm_selectRowTEXTGRID==null){mm_selectRowTEXTGRID=CL().C_selectRowTEXTGRID}return mm_selectRowTEXTGRID.call(this,a,e,d,b,c)}function reactOnFillTextIdsTEXTGRID(a){for(i=0;i<a.CASA_colinfos.length;i++){var b=a.CASA_colinfos[i];if(b.textid!=null){b.name=getPropertyValue("$"+b.textid);if(b.name==null){b.name="$"+b.textid}}if(b.sorttitletextid!=null){b.sorttitle=getPropertyValue("$"+b.sorttitletextid);if(b.sorttitle==null){b.sorttitle="$"+b.sorttitletextid}}if(b.titletextid!=null){b.title=getPropertyValue("$"+b.titletextid);if(b.title==null){b.title="$"+b.titletextid}}}}var s_bufferWidthTEXTGRID=[];function determineDivWidthTEXTGRID(c){var a=s_bufferWidthTEXTGRID[c];if(a!=null){return a}if(c==null||c.length==0){a="100%"}else{var b=c.charAt(c.length-1);if(b=="%"){a="100%"}else{a=c}}s_bufferWidthTEXTGRID[c]=a;return a}function reactOnMouseDownOnRowTEXTGRID(d,b,m){if(b==null){return}CL().cancelEvent(m);var e=null;var l=b.split("_");var j=l[1];if(d.CASA_selectprop!=null){e=getPropertyValue(d.CASA_displayitemsprop+"["+j+"]."+d.CASA_selectprop)}if("false"==e){return}var k=d.CASA_displayitemsprop+"["+j+"]."+d.CASA_draginfoprop;var c=getPropertyValue(k);var h=parent.gebid(b);var a=[];a.push("<td height='"+C_adjustUnits(h.clientHeight)+"' width='"+C_adjustUnits(h.clientWidth)+"'><table style =\"border:1px solid #CDCDCD;\" height='"+C_adjustUnits(h.clientHeight)+"' width='"+C_adjustUnits(h.clientWidth)+"'><tr style =\"border:1px solid #CDCDCD;\" height='100%' width='100%'class='"+h.className+"'>");for(var g=0;g<h.childNodes.length;g++){var f=h.childNodes[g];a.push('<td style ="border:1px solid #CDCDCD;" height=\''+C_adjustUnits(f.clientHeight)+"' width='"+C_adjustUnits(f.clientWidth)+"'></td>")}a.push("</tr></table></td>");startDragCL(c,a.join(""),m,parent)}function reactOnMouseDownTEXTGRID(b,j){if(checkIO()==false){return false}if(b.CASA_personalizable=="false"){return false}if(b.CASA_griddataprop==null){return false}if(j.button=="2"){if(j.stopPropagation){j.stopPropagation()}return false}for(d=0;true;d++){var f=b.CASA_colinfos[d];if(f==null){break}if(f.columntype==CT_CSVCOLUMN&&f.withgridcolheaders!="true"){return}}try{var g=findSrcElement(j);if(g.className=="VSPLITLine"){startResizeTEXTGRID(b,j)}else{var c=true;if(b.CASA_disablecolumnmoving==true){c=false}if(b.CASA_colHeaders==null||b.CASA_colHeaders.length==0){c=false}var a=b.CASA_colHeaders[0].type;for(var d=0;d<b.CASA_colHeaders.length;d++){if(b.CASA_colHeaders[d].type!=a){c=false;break}}if(c==true){startDragTEXTGRID(b,j)}else{var h=this.findColumnIndex(b,j);var l=b.CASA_colHeaders[h];var e=l.property;if(e==null){e=l.imageprop}CL().C_startSortTimerTEXTGRID(this,b,e)}}}catch(k){}}function convertRelativeWidthsIntoPixelValuesTEXTGRID(c){for(var b=0;b<c.CASA_colHeaders.length;b++){if(!checkIfStringEndsWith(c.CASA_colHeaders[b].width,"%")){continue}var a=findColumnTEXTGRID(c,b);a.width=a.offsetWidth;c.CASA_colHeaders[b].width=a.width}}function startResizeTEXTGRID(d,a){calculatePageOffset(d);d.CASA_posY=d.CASA_pageoffsettop;d.CASA_posX1=d.CASA_pageoffsetleft;d.CASA_posX2=d.CASA_posX1+d.offsetWidth;d.CASA_posXEvent=a.clientX;parent.m_dragId=d.CASA_id;parent.m_dragType="RESIZABLE";parent.m_dragRsizable=d;m_dragColIndexTEXTGRID=findColumnIndex(d,a);if(m_dragColIndexTEXTGRID==null){return}convertRelativeWidthsIntoPixelValuesTEXTGRID(d);var c="onmouseup='reactOnMouseUp"+d.CASA_id+"(event);'";var b=[];b.push("<table cellspacing=0 cellpadding=0 class='VSPLITLineDragTable' style='position: absolute; top: 0; left: -150px; z-index: 1000;' "+c+"> ");b.push("<tr>");b.push("<td>");b.push("<div style='margin:0 150px 0 150px; height: "+C_adjustUnits(d.parentNode.offsetHeight)+"' class='VSPLITLineDrag'>");b.push("</div>");b.push("</td>");b.push("</tr>");b.push("</table>");parent.startDrag(b.join(""),a)}var m_finishResizeTimeoutIdTEXTGRID;var m_finishResizeCCTEXTGRID;var m_finishResizeWidthTEXTGRID;function finishResizeTEXTGRID(j,b){if(parent.m_dragMode!=true){return true}if(parent.m_dragId!=j.CASA_id){return true}parent.endDrag();var c=findColumnTEXTGRID(j,m_dragColIndexTEXTGRID);if(c==null){alert("No column for index "+m_dragColIndexTEXTGRID);return}var d;if(m_direction=="rtl"){d=j.CASA_posXEvent-b.clientX+c.offsetWidth}else{calculatePageOffset(c);d=b.clientX-c.CASA_pageoffsetleft}var f=300;try{if(c.offsetWidth-d>8){f=0}}catch(g){}if(d<=20){d=20}c.width=d;var h=c.firstChild;h.style.width=C_adjustUnits(d);var a=CL().findInnerWidth(c);if(a>c.width){c.width=a}m_finishResizeCCTEXTGRID=j;m_finishResizeWidthTEXTGRID=c.width;m_finishResizeTimeoutIdTEXTGRID=window.setTimeout("finishResizeExecuteTEXTGRID()",f)}function finishResizeExecuteTEXTGRID(){if(m_finishResizeTimeoutIdTEXTGRID==null){return}var a=m_finishResizeCCTEXTGRID;if(a==null){return}if(a.CASA_colHeaders==null){return}a.CASA_colHeaders[m_dragColIndexTEXTGRID].width=m_finishResizeWidthTEXTGRID;CL().flushColumnInfos(self,a,"reactOnGridColHeaderResize")}function startDragTEXTGRID(e,n){if(e.CASA_colHeaders==null||e.CASA_colHeaders.length==0){return}var b=e.CASA_colHeaders[0].type;for(var g=0;g<e.CASA_colHeaders.length;g++){if(e.CASA_colHeaders[g].type!=b){return}}var m=findColumnIndex(e,n);m_dragIdTEXTGRID=e.CASA_id;m_dragColIndexTEXTGRID=m;convertRelativeWidthsIntoPixelValuesTEXTGRID(e);calculatePageOffset(e);var d=parent.gebid("TG"+e.CASA_id+"COL"+m);d.CASA_posY=e.CASA_pageoffsettop;d.CASA_posX1=e.CASA_pageoffsetleft;d.CASA_posX2=e.CASA_pageoffsetleft+e.offsetWidth;d.CASA_posXEvent=n.clientX;d.CASA_colIndex=m;parent.m_dragRsizable=d;parent.m_dragId=d.CASA_id;parent.m_dragType="COLMOVE";var j="onmouseup='reactOnMouseUp"+e.CASA_id+"(event);'";var c=[];c.push("<table style='cursor: move;position: absolute; top: -50px; left: -50px; z-index: 1000;' "+j+"> ");c.push("<tr>");c.push("<td>");c.push("<div style='margin:65px 0 50px 50px;'>");var f=d.offsetWidth;c.push("<table border='1' width='"+C_adjustUnits(f)+"' bordercolor='#C0C0C0' cellspacing=0 style='border-collapse:collapse;background-color:#FFFFFF'>");if(e.CASA_withtitlerow!="false"){c.push("<tr>");c.push("<td class='TEXTGRIDCellHeader' valign='middle'>");c.push(e.CASA_colHeaders[m].name);c.push("</td>");c.push("</tr>")}var a=getPropertyValue(e.CASA_rowcountprop);for(var k=0;k<a;k++){var l;if(k%2==1){l="TEXTGRID"+e.CASA_stylevariant+"CellContentDark"}else{l="TEXTGRID"+e.CASA_stylevariant+"CellContent"}var h="";if(k%2==0&&e.CASA_evenrowstyle!=null){h=e.CASA_evenrowstyle}if(k%2==1&&e.CASA_oddrowstyle!=null){h=e.CASA_oddrowstyle}c.push('<tr style="'+h+'" class="'+l+'"><td>');c.push("&nbsp;");c.push("</td></tr>")}c.push("</table>");c.push("</div>");c.push("</td>");c.push("</tr>");c.push("</table>");parent.m_dragType="COLMOVE";parent.startDrag(c.join(""),n)}function findColumnIndex(f,a){var d=0;var b;while(true){var e=parent.gebid("TG"+f.CASA_id+"COL"+d);if(e==null){break}calculatePageOffset(e);var c=e.CASA_pageoffsetleft;if(c<a.clientX&&((c+e.offsetWidth)>=a.clientX)){b=d;break}d++}return b}function findColumnTEXTGRID(c,a){var b=parent.gebid("TG"+c.CASA_id+"COL"+a);return b}var mm_reactOnMouseUpTEXTGRID=null;function reactOnMouseUpTEXTGRID(g,a){try{if(a.currentTarget.id.substr(0,11)=="TEXTGRIDDIV"){return false}}catch(e){}if(a.button=="2"){a.returnValue=false;a.stopPropagation();var c=findSrcElement(a);if(c!=null&&c.tagName=="DIV"){return}parent.CASA_event=a;parent.CASA_supressXYContextMenu=true;calculateContextMenuRequestPositionTEXTGRID(g);flushColumnInfoTEXTGRID(g,a,"reactOnGridColHeaderContextMenuRequest")}else{if(parent.m_dragType=="RESIZABLE"){finishResizeTEXTGRID(g,a)}else{if(parent.m_dragMode==true){if(mm_reactOnMouseUpTEXTGRID==null){mm_reactOnMouseUpTEXTGRID=CL().C_reactOnMouseUpTEXTGRID}return mm_reactOnMouseUpTEXTGRID.call(this,g,a)}else{if(g.CASA_personalizable=="false"){return true}if(g.CASA_disablecolumnresizing==true){return true}if(g.CASA_disablecolumnmoving==true){return true}var b=this.findColumnIndex(g,a);var f=g.CASA_colHeaders[b];if(f.withsorticon=="false"){return true}var d=f.property;if(d==null){d=f.imageprop}if(d==null){return}if(d.indexOf("NOSORT")>0){return}CL().C_startSortTimerTEXTGRID(this,g,d)}}}}function invokeSortTEXTGRID(c,b){if(c.CASA_personalizable!="true"){return}if(b==null){return}var a=b.length;if(a>6&&b.substring(a-6,a)=="NOSORT"){return}for(var d=0;d<c.CASA_colinfos.length;d++){if((c.CASA_colinfos[d].property==b||c.CASA_colinfos[d].imageprop==b)&&c.CASA_colinfos[d].withsorticon=="false"){addLogMessage('TEXTGID - suppress sorting for column "'+b+'"! Flag withsorticon is set to false.');return}}setPropertyValue(c.CASA_sortprop+".sortProperty",b);invokeMethodInModel(c.CASA_sortprop+".onSort")}function reactOnResizeMozTEXTGRID(b,c){if(b!=null){b.CASA_bufferedchangeindex=null}var a=c.parentNode.offsetHeight;if(a!=0){c.style.height=C_adjustUnits(a);reactOnResizeTEXTGRID(b,c)}else{c.style.height="100%"}}function reactOnResizeTEXTGRID(a,b){return reactOnResizeTEXTGRIDExecute(a,b,false)}function reactOnResizeTEXTGRIDExecute(c,q,j){try{if(c.CASA_rowcount==null||c.CASA_rowcount<=0){return}if(c.CASA_height==null){return}if(q.clientHeight==0){return}if(checkIfPageIsDeactivated()==true){return}var p=c.CASA_rowcount;c.CASA_bufferedchangeindex=null;c.style.display="none";c.style.display="";c.CASA_previousheight=q.clientHeight;var m;var b=0;var n=0;for(m=0;m<c.CASA_rowcount;m++){vRowId="TGROW"+c.CASA_id+"_"+m;var l=parent.document.getElementById(vRowId);if(l==null){vEmptyRowId="TGEMPTYROW"+c.CASA_id+"_"+m;l=parent.document.getElementById(vEmptyRowId)}if(l==null){var r=determineRowHeightTEXTGRID(c);if(r>0){for(var h=0;h<c.CASA_rowcount-m;h++){n+=r;if(n>q.clientHeight){p=h+m;break}}}break}b+=l.offsetTop;n=l.offsetTop+l.offsetHeight;if(n>q.clientHeight){p=m;break}}if(b==0){return}var k=getPropertyValue(c.CASA_rowcountprop);if(k==null){return}var k=k*(-1)*(-1);if(k!=p&&p>0){setPropertyValue(c.CASA_rowcountprop,p);try{var a=10000+c.CASA_id*(-1)*(-1);if(parent.gebid("VSCROLL_"+a)==null||j==false){updateTopIndexTEXTGRID(c.CASA_vscrollbar,p,j);reactOnModelUpdateVSCROLLBAR(c.CASA_vscrollbar,null)}if(c.CASA_pageDownIconId!=null){var g=getPropertyValue(c.CASA_griddataprop+".onPageDownVis");var f=getPropertyValue(c.CASA_griddataprop+".size");setPropertyValue(c.CASA_griddataprop+".onPageDownVis",f>p,true);var e="romu"+c.CASA_pageDownIconId;parent[e]();e="romu"+c.CASA_lastPageIconId;parent[e]();setPropertyValue(c.CASA_griddataprop+".onPageDownVis",g,true)}}catch(d){}if(k<p){resetCheckIO();submitModel()}}}catch(d){}}function updateTopIndexTEXTGRID(f,b,d){if(d==true){return}if(f==null){return}if(f.CASA_vscroll=="hidden"){return}var c=getPropertyValue(f.CASA_topindexprop)*(-1)*(-1);var a=getPropertyValue(f.CASA_maxindexprop)*(-1)*(-1);if(c+b>a){var e=a-b;if(e<0){e=0}if(e!=c){setPropertyValue(f.CASA_topindexprop,e)}}}function onContextMenuRequestROLLOVER(e,d){var c=getCCell_TEXTGRID(e);setPropertyValue(e.CASA_griddataprop+".contextMenuColName",c);calculateContextMenuRequestPositionTEXTGRID(e,d);if((d!=null)&&(d!=-1)){if(e.CASA_singleselectcontextmenu==false){var b=false;if(e.CASA_selectprop!=null){b=getPropertyValue(e.CASA_displayitemsprop+"["+d+"]."+e.CASA_selectprop)}if(!(b==true||b=="true")){selectRowTEXTGRID(e,d)}}else{if(e.CASA_singleselectcontextmenu=="noselection"){deselectAllTEXTGRID(e)}else{if(e.CASA_collectionshiftselectprop==null){var a=getPropertyValue(e.CASA_displayitemsprop+"["+d+"]."+e.CASA_selectprop,false);if(a!=null&&(a==false||a=="false")){selectRowTEXTGRID(e,d)}}else{if(e.CASA_singleselect!=true&&!(e.CASA_rowcount==null||e.CASA_rowcount<=0)){if(e.CASA_selectalllinesprop!=null){this.setPropertyValue(e.CASA_selectalllinesprop+"$FIRSTPRIO$",false)}}deselectAllTEXTGRID(e);selectRowTEXTGRID(e,d)}}}invokeMethodInModel(e.CASA_arrayprop+"["+d+"].reactOnContextMenuRequest")}else{if(e.CASA_oncontextmenumethod!=null){invokeMethodInModel(e.CASA_oncontextmenumethod)}}}function getCCell_TEXTGRID(b){var a=null;if(parent.CASA_event!=null){a=parent.CASA_event.target}while(a!=null&&a.id!="TEXTGRIDDIV"+b.CASA_id){if(a.getAttribute("CASA_cell")!=null){return a.getAttribute("CASA_cell")}a=a.parentNode}return""}function calculateContextMenuRequestPositionTEXTGRID(c,b){if(parent.CASA_event!=null){var a=findTHISCONTEXTMENU();a.style.display="none";setContextMenuXYPAGE(parent.CASA_event.clientX,parent.CASA_event.clientY);parent.CASA_event=null}}function deselectItemTEXTGRID(e,d){if(e.CASA_selectprop==null){return}if(getSelectableTEXTGRID(e,e.CASA_displayitemsprop+"["+d+"].")=="false"){return}setPropertyValue(e.CASA_arrayprop+"["+d+"]."+e.CASA_selectprop,false);setPropertyValue(e.CASA_displayitemsprop+"["+d+"]."+e.CASA_selectprop,false);var a="TGROW"+e.CASA_id+"_"+d;var c=parent.document.getElementById(a);var b=parent.document.getElementById(a+"FC");if(c!=null){if(d%2==0){c.className="TEXTGRID"+e.CASA_stylevariant+"CellContent"}else{c.className="TEXTGRID"+e.CASA_stylevariant+"CellContentDark"}if(b!=null){b.className="TEXTGRID"+e.CASA_stylevariant+"CellUnselectColumn"}markRowControlsTEXTGRID(e,c,false)}}function getSelectableTEXTGRID(b,c){var a="true";if(b.CASA_selectableprop!=null&&getPropertyValue(c+b.CASA_selectableprop)=="false"){a="false"}return a}function selectItemsTEXTGRID(d,g,f){if(d.CASA_selectprop==null){return}var a;var c;var b;for(var e=g;e<=f;e++){if(getSelectableTEXTGRID(d,d.CASA_displayitemsprop+"["+e+"].")=="false"){continue}setPropertyValue(d.CASA_arrayprop+"["+e+"]."+d.CASA_selectprop,true);setPropertyValue(d.CASA_displayitemsprop+"["+e+"]."+d.CASA_selectprop,true);a="TGROW"+d.CASA_id+"_"+e;c=parent.document.getElementById(a);b=parent.document.getElementById(a+"FC");if(c!=null){c.className="TEXTGRID"+d.CASA_stylevariant+"CellSelectedContent";if(b!=null){b.className="TEXTGRID"+d.CASA_stylevariant+"CellSelectColumn"+d.m_dirStyleExt}markRowControlsTEXTGRID(d,c,true)}}}function markRowControlsTEXTGRID(e,d,c){if(e.CASA_fgselect!=true){return}var b=[];findAllChildNodesTEXTGRID(d,b);for(var a=0;a<b.length;a++){if(b[a].style!=null&&b[a].style.backgroundColor!=null&&b[a].style.backgroundColor!=""){if(c==true){b[a].style.backgroundImage="url(../HTMLBasedGUI/images/shadedbackground.gif)"}else{b[a].style.backgroundImage=""}}}}function findAllChildNodesTEXTGRID(b,a){var d=b.childNodes;for(var c=0;c<d.length;c++){a.push(d[c]);findAllChildNodesTEXTGRID(d[c],a)}}function selectAllTEXTGRID(c){if(c.CASA_selectprop==null){return}var d;var f=0;while(true){d=getPropertyValue(c.CASA_displayitemsprop+"["+f+"]."+c.CASA_selectprop);if(d==null){break}if(getSelectableTEXTGRID(c,c.CASA_displayitemsprop+"["+f+"].")=="false"){f++;continue}if(d==false||d=="false"){setPropertyValue(c.CASA_arrayprop+"["+f+"]."+c.CASA_selectprop,"true");setPropertyValue(c.CASA_displayitemsprop+"["+f+"]."+c.CASA_selectprop,"true");var e="TGROW"+c.CASA_id+"_"+f;var b=parent.document.getElementById(e);var a=parent.document.getElementById(e+"FC");if(b!=null){b.className="TEXTGRID"+c.CASA_stylevariant+"CellSelectedContent";if(a!=null){a.className="TEXTGRID"+c.CASA_stylevariant+"CellSelectColumn"+c.m_dirStyleExt}markRowControlsTEXTGRID(c,b,true)}}f++}c.CASA_lsi=f-1}function deselectAllTEXTGRID(c){if(c.CASA_selectprop==null){return}var d;var f=0;while(true){d=getPropertyValue(c.CASA_displayitemsprop+"["+f+"]."+c.CASA_selectprop);if(d==null){break}if(getSelectableTEXTGRID(c,c.CASA_displayitemsprop+"["+f+"].")=="false"){f++;continue}if(d==true||d=="true"){setPropertyValue(c.CASA_arrayprop+"["+f+"]."+c.CASA_selectprop,"false");setPropertyValue(c.CASA_displayitemsprop+"["+f+"]."+c.CASA_selectprop,"false");var e="TGROW"+c.CASA_id+"_"+f;var b=parent.document.getElementById(e);var a=parent.document.getElementById(e+"FC");if(b!=null){if(f%2==0){b.className="TEXTGRID"+c.CASA_stylevariant+"CellContent"}else{b.className="TEXTGRID"+c.CASA_stylevariant+"CellContentDark"}if(a!=null){a.className="TEXTGRID"+c.CASA_stylevariant+"CellUnselectColumn"}markRowControlsTEXTGRID(c,b,false)}}f++}if(c.CASA_collectionselectprop!=null){setPropertyValue(c.CASA_collectionselectprop,-1)}}var mm_deprecatedMultiSelectionTEXTGRID=null;function deprecatedMultiSelectionTEXTGRID(a,b){if(mm_deprecatedMultiSelectionTEXTGRID==null){mm_deprecatedMultiSelectionTEXTGRID=CL().C_deprecatedMultiSelectionTEXTGRID}return mm_deprecatedMultiSelectionTEXTGRID.call(this,a,b)}var mm_selectAllLinesTEXTGRID=null;function selectAllLinesTEXTGRID(a){if(mm_selectAllLinesTEXTGRID==null){mm_selectAllLinesTEXTGRID=CL().C_selectAllLinesTEXTGRID}return mm_selectAllLinesTEXTGRID.call(this,this,a)}function onkey40TEXTGRID(a,b,c){if(checkIOForNoSubmits()==false){return false}if(a.CASA_keybCursor==null){setKeyboardFocusTEXTGRID(a,0);return}c.returnValue=false;if(a.CASA_topindexprop!=null){if(a.CASA_keybMaxSSS>=0&&a.CASA_keybCursor>=a.CASA_keybMaxSSS-1){return}var d=getPropertyValue(a.CASA_rowcountprop)-0;if(a.CASA_keybCursor<d-1){var f=a.CASA_keybCursor+1;setKeyboardFocusTEXTGRID(a,f)}else{a.CASA_keybCursorReset=false;var e=new Function("parent.scrollDown"+(a.CASA_id-0+10000-0)+"(1);");e();if(b.setActive){b.setActive()}else{b.focus()}}}else{if(c.preventDefault){c.preventDefault()}if(a.CASA_keybCursor>=a.CASA_keybMaxCSS){return}var g=determineVisibleRowsTEXTGRID(a);var j=determineRowHeightTEXTGRID(a);var h=Math.round(b.scrollTop/j);if(a.CASA_keybCursor>=g-2+h-0){b.scrollTop+=j}var f=a.CASA_keybCursor+1;setKeyboardFocusTEXTGRID(a,f)}}function onkey38TEXTGRID(e,g,c){if(checkIOForNoSubmits()==false){return false}if(e.CASA_keybCursor==null){setKeyboardFocusTEXTGRID(e,0);return}c.returnValue=false;if(e.CASA_topindexprop!=null){if(e.CASA_keybCursor>0){var h=e.CASA_keybCursor-1;setKeyboardFocusTEXTGRID(e,h)}else{var d=getPropertyValue(e.CASA_topindexprop)-0;if(d==0){return}e.CASA_keybCursorReset=false;var f=new Function("parent.scrollUp"+(e.CASA_id-0+10000-0)+"(1);");f();if(g.setActive){g.setActive()}else{g.focus()}}}else{if(c.preventDefault){c.preventDefault()}if(e.CASA_keybCursor==0&&g.scrollTop!=0){g.scrollTop=0}if(e.CASA_keybCursor==0){return}var b=determineRowHeightTEXTGRID(e);var a=Math.round(g.scrollTop/b);if(e.CASA_keybCursor<=a){g.scrollTop-=b}var h=e.CASA_keybCursor-1;setKeyboardFocusTEXTGRID(e,h)}}function onkey32TEXTGRID(c,a){if(checkIOForNoSubmits()==false){return false}if(c.CASA_keybCursor==null){return}a.returnValue=false;if(a.keyCode==13&&c.CASA_ondblclickmethod!=null&&c.CASA_dblclickonreturn==true){c.CASA_keybCursorReset=false;reactOnDblClickTEXTGRID(c,c.CASA_keybCursor);return}c.CASA_keybCursorReset=true;var b=getPropertyValue(c.CASA_displayitemsprop+"["+c.CASA_keybCursor+"]."+c.CASA_selectprop);selectRowTEXTGRID(c,c.CASA_keybCursor,a.ctrlKey,a.shiftKey);if(c.CASA_topindexprop==null){if(a.preventDefault){a.preventDefault()}}if(c.CASA_ondblclickmethod!=null&&(b==true||b=="true")){c.CASA_keybCursorReset=false}if(c.CASA_onclickmethod!=null){c.CASA_keybCursorReset=false;invokeMethodInModel(c.CASA_onclickmethod)}}function onkey33TEXTGRID(d,f,b){if(checkIOForNoSubmits()==false){return false}var c=determineVisibleRowsTEXTGRID(d);if(d.CASA_keybCursor==null){setKeyboardFocusTEXTGRID(d,0)}b.returnValue=false;if(d.CASA_topindexprop!=null){d.CASA_keybCursorReset=false;var e=new Function("parent.scrollPageUp"+(d.CASA_id-0+10000-0)+"();");e();if(f.setActive){f.setActive()}else{f.focus()}}else{if(b.preventDefault){b.preventDefault()}var a=determineRowHeightTEXTGRID(d);f.scrollTop-=a*c;var g=d.CASA_keybCursor-c;if(g<0){g=0}setKeyboardFocusTEXTGRID(d,g)}}function onkey34TEXTGRID(b,c,d){if(checkIOForNoSubmits()==false){return false}var h=determineVisibleRowsTEXTGRID(b);if(b.CASA_keybCursor==null){setKeyboardFocusTEXTGRID(b,0)}d.returnValue=false;if(b.CASA_topindexprop!=null){b.CASA_keybCursorReset=false;var f=new Function("parent.scrollPageDown"+(b.CASA_id-0+10000-0)+"();");f();if(c.setActive){c.setActive()}else{c.focus()}}else{if(d.preventDefault){d.preventDefault()}var a=b.CASA_displayitemsprop+"["+b.CASA_keybCursor+"]."+b.CASA_selectprop;var e="TGROW"+b.CASA_id+"_"+b.CASA_keybCursor;var k=parent.gebid(e);leaveRowTEXTGRID(k,a,b.CASA_keybCursor,b.CASA_stylevariant);var j=determineRowHeightTEXTGRID(b);c.scrollTop+=j*h;var g=b.CASA_keybCursor+h;if(g>b.CASA_keybMaxCSS){g=b.CASA_keybMaxCSS}setKeyboardFocusTEXTGRID(b,g)}}function determineVisibleRowsTEXTGRID(b){var a=parent.document.getElementById("TEXTGRIDDIV"+b.CASA_id);var d=0;while(true){vRowId="TGROW"+b.CASA_id+"_"+d;var c=parent.document.getElementById(vRowId);if(c==null){vEmptyRowId="TGEMPTYROW"+b.CASA_id+"_"+d;c=parent.document.getElementById(vEmptyRowId)}if(c==null){break}if(c.offsetTop>a.clientHeight){break}d++}return d-1}function determineRowHeightTEXTGRID(a){var b=parent.document.getElementById("TGROW"+a.CASA_id+"_0");if(b==null){vEmptyRowId="TGEMPTYROW"+a.CASA_id+"_0";b=parent.document.getElementById(vEmptyRowId)}if(b==null){return -1}return b.clientHeight-0+1-0}function setKeyboardFocusTEXTGRID(b,g){if(b.CASA_keybCursor!=null){var e=b.CASA_keybCursor;b.CASA_keybCursor=null;var a=b.CASA_displayitemsprop+"["+e+"]."+b.CASA_selectprop;var c="TGROW"+b.CASA_id+"_"+e;var k=parent.gebid(c);leaveRowTEXTGRID(k,a,e,b.CASA_stylevariant)}b.CASA_keybCursor=g;if(b.CASA_keybCursor!=null){var c="TGROW"+b.CASA_id+"_"+b.CASA_keybCursor;var d=parent.gebid(c);if(enterRowTEXTGRID(d,"")==false){try{d.focus()}catch(j){}setTimeout(function(){enterRowTEXTGRID(d,"")},10)}if(parent.document.querySelector){var f=parent.document.querySelector(":focus");if(f==null){try{if(b.parentNode.setActive){b.parentNode.setActive()}else{b.parentNode.focus()}}catch(h){}}}}else{var f=parent.document.activeElement;if(!f||f==parent.document.body){f=null}else{if(parent.document.querySelector){f=parent.document.querySelector(":focus")}}if(f==null&&b.parentNode.setActive){try{b.parentNode.setActive()}catch(h){}}}}function reactonfocusTEXTGRID(a,e){var d=parent.gebid("TEXTGRID"+a);if(e!=d.CASA_keybCursor){return}var c=findSrcElement(parent.event);var b=getPropertyValue(d.CASA_displayitemsprop+"["+e+"]."+d.CASA_selectprop);if(b==false||b=="false"){c.className="TEXTGRID"+d.CASA_stylevariant+"CellRolloverContent"}}function invokeMethodInModelTEXTGRID(a){parent.m_blockIOByFlush=true;invokeMethodInModel(a)}var m_timeoutIdTEXTGRID=null;function reactOnClickTEXTGRID(b,a){if(a==-1){return}if(b.CASA_ondblclickmethod!=null){m_timeoutIdTEXTGRID=window.setTimeout("reactOnClickExecuteTEXTGRID('"+b.CASA_onclickmethod+"')",300)}else{invokeMethodInModel(b.CASA_onclickmethod)}}function reactOnClickExecuteTEXTGRID(a){if(m_timeoutIdTEXTGRID==null){return}invokeMethodInModel(a)}function reactOnDblClickTEXTGRID(b,a){if(a==-1){return}m_timeoutIdTEXTGRID=null;deselectAllTEXTGRID(b);selectRowTEXTGRID(b,a);invokeMethodInModel(b.CASA_ondblclickmethod)}function checkIfStringEndsWith(a,c){if(a==null||c==null){return false}var b=a.indexOf(c);if(b==-1){return false}return(b-0+c.length)==a.length}function reactOnDoubleClickHeaderTEXTGRID(b,a){flushColumnInfoTEXTGRID(b,a,"reactOnGridColHeaderDoubleClick")}function flushColumnInfoTEXTGRID(f,b,d){m_finishResizeTimeoutIdTEXTGRID=null;CL().C_stopSortTimerTEXTGRID();if(f.CASA_colHeaders==null){return}var c=findColumnIndex(f,b);var e=f.CASA_colHeaders[c];if(e==null){return}var a=e.property;if(a==null){a=e.imageprop}if(a==null){return}setPropertyValue(f.CASA_griddataprop+".param1",a);convertRelativeWidthsIntoPixelValuesTEXTGRID(f);CL().flushColumnInfos(this,f,d)}function presetDefaultWidthTEXTGRID(a){if(a==null){a="0%"}return a}function addVersionInfoCOLORSELECTIONCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("COLORSELECTIONCONTROLS")}var s_bufferCOLORSELECTION=[];function checkIfColorIsDarkCOLORSELECTION(a){if(a==null){return false}if(a.length!=7){return false}var b=a.charAt(3);if((b=="A")||(b=="B")||(b=="C")||(b=="D")||(b=="E")||(b=="F")||(b=="a")||(b=="b")||(b=="c")||(b=="d")||(b=="e")||(b=="f")){return false}var c=a.charAt(1);if((c=="F")||(c=="f")){return false}return true}function determineContrastColorCOLORSELECTION(b){var a=s_bufferCOLORSELECTION[b];if(a!=null){return a}if(checkIfColorIsDarkCOLORSELECTION(b)==true){a="#FFFFFF"}else{a="#000000"}s_bufferCOLORSELECTION[b]=a;return a}function addVersionInfoSCROLLCONTROLS(){if(this.m_jsversions==undefined){m_jsversions=[]}if(this.m_jsfiles==undefined){m_jsfiles=[]}m_jsversions.push("CIS_V910_20180812_2005_NJX");m_jsfiles.push("SCROLLCONTROLS")}function iccVSCROLLBAR(d,f,h,b,c,a,j,g,k,e){d.CASA_bufferedtopindex=undefined;d.CASA_bufferedmaxindex=undefined;d.CASA_bufferedindexchange=undefined;d.CASA_lastscrolltop=undefined;d.CASA_keepquiet=undefined;d.CASA_id=b;if(d.id==""){d.id="VSCROLLDIV_"+b}d.CASA_topindexprop=c;d.CASA_maxindexprop=a;d.CASA_rowcountprop=j;d.CASA_param1prop=e;d.CASA_indexchange=g;d.CASA_vscroll=k;d.CASA_scrollFactor=0;d.CASA_buffItemsOcc=0;d.CASA_romuMethod=h;registerListenerforSCROLLBAR(h);if(d.parentNode.id==""){d.parentNode.id="VSCROLLTD_"+b}d.parentNode.CASA_SCROLL_VID="VSCROLL_"+b;d.parentNode.CASA_SCROLL_OUTERDIV="IDO_"+b;addMozDiv(d.parentNode)}function initCasaControlHSCROLLBAR(a,b){a.CASA_bufferedtopindex=undefined;a.CASA_bufferedmaxindex=undefined;a.CASA_bufferedindexchange=undefined;a.CASA_lastscrolltop=undefined;a.CASA_keepquiet=undefined}function reactOnModelUpdateVSCROLLBAR(a,b){reactOnModelUpdateSCROLLBAR(a,b,true)}function reactOnModelUpdateHSCROLLBAR(a,b){reactOnModelUpdateSCROLLBAR(a,b,false)}var m_mozDragCCSCROLL=null;var m_mozDragCTSCROLL=null;var m_mozDragTimerSCROLL=null;var m_infoSCROLL=null;function clearTimoutMozDragSCROLL(){if(m_mozDragTimerSCROLL!=null){window.clearTimeout(m_mozDragTimerSCROLL);m_mozDragCCSCROLL=null;m_mozDragCTSCROLL=null;m_mozDragTimerSCROLL=null}}function mozDragReactVSCROLLBAR(c,b,a){if(a.type=="scroll"){clearTimoutMozDragSCROLL();m_mozDragCCSCROLL=c;m_mozDragCTSCROLL=a.currentTarget;m_mozDragTimerSCROLL=window.setTimeout("mozROSVSCROLLBARTimer()",50);return}}function mozROSVSCROLLBARTimer(){var a=m_mozDragCCSCROLL;var b=m_mozDragCTSCROLL;clearTimoutMozDragSCROLL();mozReactOnScrollVSCROLLBAR(a,b)}function mozReactOnScrollVSCROLLBAR(d,j){if(d.CASA_scrollFactor==0){calculateFactorforSCROLLBAR(d)}var g=d.CASA_scrollFactor;if(0==g){return}var b=getPropertyValue(d.CASA_topindexprop);var a=j;var f=a.scrollTop;var e=getPropertyValue(d.CASA_maxindexprop);var h=getPropertyValue(d.CASA_rowcountprop);var c=Math.round(f/a.scrollHeight*e);if(isNaN(c)){c=0}var k=c*(-1)*(-1)+h*(-1)*(-1);if(d.CASA_buffItemsOcc==e&&k==d.CASA_buffItemsOcc){return}d.CASA_buffItemsOcc=k;if(c<=0){c=0}else{if(c>=e-h){c=e-h}}if(c==b){return}setPropertyValue(d.CASA_topindexprop,c);submitTEXTGRID(d)}function calculateFactorforSCROLLBAR(e){var a=e.CASA_id;var f=null;var d=0;try{if(a<10000){f=parent.document.getElementById("DIV"+a);if(f!=null&&f.childNodes[1]!=null&&f.childNodes[1].rows[1]!=null){for(var c=1;c<f.childNodes[1].rows.length;c++){d=f.childNodes[1].rows[c].clientHeight;if(d>0){break}}presetRR_TABLEAREA(f);if(f.CASA_repeatedRows>1){for(var c=1;c<f.CASA_repeatedRows;c++){if(f.childNodes[1].rows[1+c]!=null){d+=f.childNodes[1].rows[1+c].clientHeight}}}}else{if(f!=null&&f.childNodes[1]!=null){d=f.childNodes[1].clientHeight;presetRR_TABLEAREA(f);if(f.CASA_repeatedRows>1){for(var c=1;c<f.CASA_repeatedRows;c++){if(f.childNodes[1]!=null){d+=f.childNodes[1].clientHeight}}}}}}else{f=parent.document.getElementById("TEXTGRID"+(a-10000));if(f!=null&&f.firstChild!=null&&f.firstChild.rows[1]!=null){d=f.firstChild.rows[1].clientHeight}}}catch(b){}e.CASA_scrollFactor=d}function reactOnModelUpdateSCROLLBAR(k,p,c){var g=getPropertyValue(k.CASA_topindexprop)*(-1)*(-1);var d=getPropertyValue(k.CASA_maxindexprop)*(-1)*(-1);var q=getPropertyValue(k.CASA_rowcountprop)*(-1)*(-1);if(q==null||q==0){q=getPropertyValue(k.CASA_indexchange)*(-1)*(-1)}else{k.CASA_indexchange=q}if(c){if(k.CASA_scrollFactor==0){calculateFactorforSCROLLBAR(k)}}if(c&&k.CASA_vscroll=="hidden"){return}initScrollInfo();if(p!=null){p.style.display="none"}var t=k.CASA_id;var l="";var n="";var m="";var b="";if(c){var u=Math.round(d/q*100);if(isNaN(u)){u=0}if(!isFinite(u)){u=100}if(u<0){u=0}var h=u+"%";l="height: "+h+"; width: 1px;";n="width: "+C_adjustUnits((m_infoSCROLL.scrlSize+1))+"; height:100%;";b="VSCROLL_IMG_"+t;m="VSCROLL_"+t}else{var j=Math.round(d*100);if(j<0){j=0}l="width: "+C_adjustUnits(j)+"; height: 1px;";n="height: "+C_adjustUnits((m_infoSCROLL.scrlSize+1))+"; width:100%;";b="HSCROLL_IMG_"+t;m="HSCROLL_"+t}var f=parent.document.getElementById(m);if((f==null&&(q<d))||!c){if(c){k.style.width=C_adjustUnits((m_infoSCROLL.scrlSize+1))}else{k.style.height=C_adjustUnits((m_infoSCROLL.scrlSize+1))}var r=[];r.push("<div id='"+m+"' style='overflow-y: "+k.CASA_vscroll+"; left: auto; "+n+" outline-color: invert; outline-style: none; outline-width: medium; right: -1px;' tabindex='-1'  onscroll='mozDragReact"+t+"(event);'>");r.push("	<img id='"+b+"' style='"+l+"; visibility: hidden; display: block; outline-color: invert; outline-style: none; outline-width: thin;' tabindex='-1' src='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=='>");r.push("</div>");k.innerHTML=r.join("");k.style.height="100%";f=parent.document.getElementById(m)}if(f!=null&&c){var s=k.scrollHeight;if(s>1){k.style.height=C_adjustUnits(s)}var e=parent.document.getElementById(b);e.style.height=C_adjustUnits(h);var a=0;if(d!=0){a=Math.round(g/d*f.scrollHeight)}if(f!=null&&k.lastChild.scrollTop!=a){k.lastChild.scrollTop=a;k.CASA_scrollTop=k.lastChild.scrollTop}}else{k.lastChild.scrollTop=(g*k.CASA_scrollFactor)}if((f!=null&&d<=q)){if(c){k.style.width=""}else{k.style.height=""}var r=[];r.push("<div id='ID_"+m+"' style='width:1px;height:10%'>");r.push("<a name='PC'>");r.push("</a>");r.push("</div>");k.innerHTML=r.join("");k.style.height="100%";f=parent.document.getElementById(m)}if(p!=null&&p.style.height!="50%"){p.style.height="50%"}return}function initScrollInfo(){if(m_infoSCROLL!=null&&m_infoSCROLL.scrlSize>0){return}var b=0,a=0;try{var f=parent.document.createElement("div");var e=parent.document.createElement("p");e.style.height="200px";e.style.width="100%";f.style.position="absolute";f.style.visibility="hidden";f.style.top="0";f.style.left="0";f.style.height="150px";f.style.width="200px";f.style.overflow="hidden";f.appendChild(e);parent.document.body.appendChild(f);b=e.offsetWidth;f.style.overflow="scroll";a=e.offsetWidth;if(b==a){a=f.clientWidth}parent.document.body.removeChild(f)}catch(c){}m_infoSCROLL=new Object();m_infoSCROLL.scrlSize=b-a}function setScrollTopSCROLL(c,a,b){var e=parent.document.getElementById(b);if(e==null){return}var d=Math.round(c/(a-1)*e.scrollHeight);if(d!=e.scrollTop){e.scrollTop=d}e.CASA_lastscrolltop=e.scrollTop}function setScrollLeftSCROLL(b,a){var c=parent.document.getElementById(a);if(c==null){return}c.scrollLeft=b}var m_scrollCounterVSCROLLBAR=0;var m_casacontrolVSCROLLBAR;var m_innerdivVSCROLLBAR;function reactOnScrollVSCROLLBAR(a,b){return}function reactOnScrollHSCROLLBAR(a,b){return}function reactOnScrollSCROLLBAR(a,b){m_scrollCounterVSCROLLBAR++;m_casacontrolVSCROLLBAR=a;m_innerdivVSCROLLBAR=b}function reactOnMouseUpVSCROLLBAR(a,b){reactOnScrollVSCROLLBARReal(a,b)}function reactOnMouseUpHSCROLLBAR(a,b){reactOnScrollHSCROLLBARReal(a,b)}function reactOnScrollVSCROLLBARTimeOut(a){if(a==m_scrollCounterVSCROLLBAR){reactOnScrollVSCROLLBARReal(m_casacontrolVSCROLLBAR,m_innerdivVSCROLLBAR);m_scrollCounterVSCROLLBAR=0}}function reactOnScrollHSCROLLBARTimeOut(a){if(a==m_scrollCounterVSCROLLBAR){reactOnScrollHSCROLLBARReal(m_casacontrolVSCROLLBAR,m_innerdivVSCROLLBAR);m_scrollCounterVSCROLLBAR=0}}function reactOnScrollVSCROLLBARReal(a,b){reactOnScrollSCROLLBARReal(a,b,true)}function reactOnScrollHSCROLLBARReal(a,b){reactOnScrollSCROLLBARReal(a,b,false,false)}function reactOnScrollSCROLLBARReal(d,e,c){if(d.CASA_keepquiet==true){d.CASA_keepquiet=false;return}if(c==true&&d.CASA_lastscrolltop!=null&&d.CASA_lastscrolltop==d.scrollTop){if(d.CASA_lastscrolltop!=0){return true}}if(c==false&&d.CASA_lastscrollleft!=null&&d.CASA_lastscrollleft==d.scrollLeft){return true}d.CASA_lastscrollpixeldif=d.scrollTop-d.CASA_lastscrolltop;d.CASA_lastscrolltop=d.scrollTop;d.CASA_lastscrollleft=d.scrollLeft;var a=getPropertyValue(d.CASA_maxindexprop);var b;if(c==true){b=Math.round(d.scrollTop/d.scrollHeight*a)}else{b=Math.round(d.scrollLeft/d.scrollWidth*a)}if(b==d.CASA_bufferedtopindex){if(d.CASA_lastscrollpixeldif>10){b++;if(b>=(a-1)){b=a-1}}else{if(d.CASA_lastscrollpixeldif<-10){b--;if(b<0){b=0}}}}if(b==d.CASA_bufferedtopindex){return true}if(d.CASA_withsliderfreeze==true){d.CASA_withsliderfreezePosition=d.scrollTop}setPropertyValue(d.CASA_topindexprop,b);d.CASA_bufferedtopindex=b;submitTEXTGRID(d)}function submitTEXTGRID(b){var a=true;if(b.CASA_onloadbehaviour=="collection"){a=false}if(b.CASA_onloadbehaviour=="collectionorblock"&&getPropertyValue(b.CASA_param1prop)=="true"){a=false}if(a==false){b.CASA_bypasschangeindex=true;setPropertyValue("cISContextMenuItems[0].text",null);updateModelListeners(null);updateModelListenersScroll(null);return}submitModel("submit")}function reactOnKeyDownSCROLLBAR(b,c,a){if(a!=null&&(!(a>=33)&&(a.keyCode<=40))){a.stopPropagation()}}function reactOnScrollPageDownVSCROLLBAR(b,c){var a=getPropertyValue(b.CASA_rowcountprop)*(-1)*(-1);if(a==null||a==0){a=b.CASA_indexchange*1}reactOnScrollDownVSCROLLBAR(b,c,a)}function reactOnScrollKeyEndVSCROLLBAR(b,d){if(checkIO()==false){return}parent.m_blockIOByFlush=true;var c=getPropertyValue(b.CASA_rowcountprop);var a=getPropertyValue(b.CASA_maxindexprop);setPropertyValue(b.CASA_topindexprop,a-c);submitTEXTGRID(b)}function reactOnScrollKeyHomeVSCROLLBAR(a,b){if(checkIO()==false){return}parent.m_blockIOByFlush=true;setPropertyValue(a.CASA_topindexprop,0);submitTEXTGRID(a)}function reactOnScrollPageDownHSCROLLBAR(b,c){var a=getPropertyValue(b.CASA_rowcountprop)*(-1)*(-1);if(a==null||a==0){a=b.CASA_indexchange*1}reactOnScrollDownHSCROLLBAR(b,c,a)}function reactOnScrollDownHSCROLLBAR(a,b,c){reactOnScrollDownVSCROLLBAR(a,b,c)}function reactOnScrollDownVSCROLLBAR(f,g,h){var d=true;parent.m_blockIOByFlush=true;if(checkIO()==false){return false}h=h*1;var c=getPropertyValue(f.CASA_topindexprop)*(-1)*(-1);var a=getPropertyValue(f.CASA_maxindexprop)*(-1)*(-1);var e=getPropertyValue(f.CASA_rowcountprop);if(e!=null&&e!=0){e=e*1}else{e=f.CASA_indexchange*1}if(c<=a-e-1-h){setPropertyValue(f.CASA_topindexprop,c+h);submitTEXTGRID(f)}else{var b=a-e;if(b<0){b=0}setPropertyValue(f.CASA_topindexprop,b);submitTEXTGRID(f);d=false}return d}function reactOnScrollPageUpHSCROLLBAR(a,b){reactOnScrollPageUpVSCROLLBAR(a,b)}function reactOnScrollPageUpVSCROLLBAR(b,c){var a=getPropertyValue(b.CASA_rowcountprop)*(-1)*(-1);if(a==null||a==0){a=b.CASA_indexchange*1}reactOnScrollUpVSCROLLBAR(b,c,a)}function reactOnScrollUpHSCROLLBAR(a,b,c){reactOnScrollUpVSCROLLBAR(a,b,c)}function reactOnScrollUpVSCROLLBAR(c,d,e){var b=true;parent.m_blockIOByFlush=true;if(checkIO()==false){return false}var a=getPropertyValue(c.CASA_topindexprop)*(-1)*(-1);if(a>e){setPropertyValue(c.CASA_topindexprop,a-e);submitTEXTGRID(c)}else{setPropertyValue(c.CASA_topindexprop,0);submitTEXTGRID(c);b=false}return b}function reactOnModelUpdateSCROLLTOUCH(a){}function scrollFirstSCROLLTOUCH(a){setPropertyValue(a.CASA_topindexprop,"0");submitModel("submit")}function scrollLastSCROLLTOUCH(a){navigateToTopIndexSCROLLTOUCH(a,1000000)}function scrollUpSCROLLTOUCH(a,b){}function scrollDownSCROLLTOUCH(a,b){}function scrollPageUpSCROLLTOUCH(a){var c=getPropertyValue(a.CASA_rowcountprop)*1;var b=getPropertyValue(a.CASA_topindexprop)*1;b=b-c;navigateToTopIndexSCROLLTOUCH(a,b)}function scrollPageDownSCROLLTOUCH(a){var c=getPropertyValue(a.CASA_rowcountprop)*1;var b=getPropertyValue(a.CASA_topindexprop)*1;b=b+c;navigateToTopIndexSCROLLTOUCH(a,b)}function navigateToTopIndexSCROLLTOUCH(a,b){var c=getPropertyValue(a.CASA_rowcountprop)*1;var d=getPropertyValue(a.CASA_sizeprop)*1;if(b>(d-c)){b=d-c}if(b<0){b=0}setPropertyValue(a.CASA_topindexprop,b);submitModel("submit")};