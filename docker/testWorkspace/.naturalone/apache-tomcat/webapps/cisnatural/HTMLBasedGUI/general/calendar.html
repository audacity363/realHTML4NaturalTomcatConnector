<!DOCTYPE html>
<html>

<head>
<script>
	var m_year = 2001;
	var m_month = 6;
	var m_day = 11;

	var m_monthLengths = [];
	m_monthLengths[0] = 31;
	m_monthLengths[1] = 28;
	m_monthLengths[2] = 31;
	m_monthLengths[3] = 30;
	m_monthLengths[4] = 31;
	m_monthLengths[5] = 30;
	m_monthLengths[6] = 31;
	m_monthLengths[7] = 31;
	m_monthLengths[8] = 30;
	m_monthLengths[9] = 31;
	m_monthLengths[10] = 30;
	m_monthLengths[11] = 31;

	var m_daySpans;

	var m_americanStyle;
</script>

	<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
	<meta name="ProgId" content="FrontPage.Editor.Document">
	<title>New Page 1</title>
	<base target="_self">
    <link id="casabacstylesheet" rel="stylesheet" type="text/css" href="../../cis/styles/CIS_DEFAULT.css">

<script>
function switchToStyle(pStyle)
{
	try
	{
		if (pStyle == null || pStyle == "") return;
	    var vStyleSheet = document.getElementById('casabacstylesheet');
	    if (vStyleSheet.href != pStyle)
	    	vStyleSheet.href = "../"+pStyle;
	}
	catch (exc)
	{
	}
}
function switchToDirection(pDir)
{
	if (pDir == "rtl")
	{
		document.dir = "rtl";
		img = document.getElementById('imggotoPreviousMonth');
		img.src = "smallarrowright.gif";
		img = document.getElementById('imggotoNextMonth');
		img.src = "smallarrowleft.gif";
		img = document.getElementById('imggotoPreviousYear');
		img.src = "smallarrowright.gif";
		img = document.getElementById('imggotoNextYear');
		img.src = "smallarrowleft.gif";
	}
}
</script>
<style>
html {height:100%;padding:0;margin:0}
body {height:100%;padding:0;margin:0}
</style>
</head>

<body class="WORKPLACEBelowTitle" style="height: 100%;margin:0" topmargin="0" leftmargin="0" onkeyup="if (event.keyCode==27) parent.close();" onunload="closePopup();">

<table cellspacing=0 cellpadding=5 width='100%'><tr><td height=5px></td></tr></table>
<table cellspacing=0 cellpadding=5 width="100%" height="100%"><tr><td width="100%">
<table border="0" cellspacing="1" height="100%" width="100%">
  <tr>
    <td width="14%" valign="middle" align="center" class="DATEINPUTHeaderBackground" ><a ondblclick="gotoPreviousMonth();" onclick="gotoPreviousMonth();"><img id='imggotoPreviousMonth' border="0" src="smallarrowleft.gif" width="10px" height="16px"></a></td>
    <td width="70%" valign="middle" align="center" colspan="5" class="DATEINPUTHeaderBackground"  style="font-size:12px;"><span id="MONTH"></span></td>
    <td width="14%" valign="middle" align="center" class="DATEINPUTHeaderBackground"><a ondblclick="gotoNextMonth();" onclick="gotoNextMonth();"><img id='imggotoNextMonth' border="0" src="smallarrowright.gif" width="10px" height="16px"></a></td>
  </tr>
  <tr>
    <td id='TDN0' width="14%" valign="middle" align="center" class="DATEINPUTNameOfDay" style="font-size: 12px"><span id="DN0"/></td>
    <td id='TDN1' width="14%" valign="middle" align="center" class="DATEINPUTNameOfDay" style="font-size: 12px"><span id="DN1"/></td>
    <td id='TDN2' width="14%" valign="middle" align="center" class="DATEINPUTNameOfDay" style="font-size: 12px"><span id="DN2"/></td>
    <td id='TDN3' width="14%" valign="middle" align="center" class="DATEINPUTNameOfDay" style="font-size: 12px"><span id="DN3"/></td>
    <td id='TDN4' width="14%" valign="middle" align="center" class="DATEINPUTNameOfDay" style="font-size: 12px"><span id="DN4"/></td>
    <td id='TDN5' width="14%" valign="middle" align="center" class="DATEINPUTNameOfDay" style="font-size: 12px"><span id="DN5"/></td>
    <td id='TDN6' width="14%" valign="middle" align="center" class="DATEINPUTNameOfDay" style="font-size: 12px"><span id="DN6"/></td>
  </tr>
  <tr>
    <td id='TD0' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY0"/></td>
    <td id='TD1' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY1"/></td>
    <td id='TD2' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY2"/></td>
    <td id='TD3' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY3"/></td>
    <td id='TD4' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY4"/></td>
    <td id='TD5' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY5"/></td>
    <td id='TD6' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY6"/></td>
  </tr>
  <tr>
    <td id='TD7' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY7"/></td>
    <td id='TD8' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY8"/></td>
    <td id='TD9' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY9"/></td>
    <td id='TD10' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY10"/></td>
    <td id='TD11' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY11"/></td>
    <td id='TD12' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY12"/></td>
    <td id='TD13' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY13"/></td>
  </tr>
  <tr>
    <td id='TD14' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY14"/></td>
    <td id='TD15' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY15"/></td>
    <td id='TD16' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY16"/></td>
    <td id='TD17' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY17"/></td>
    <td id='TD18' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY18"/></td>
    <td id='TD19' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY19"/></td>
    <td id='TD20' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY20"/></td>
  </tr>
  <tr>
    <td id='TD21' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY21"/></td>
    <td id='TD22' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY22"/></td>
    <td id='TD23' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY23"/></td>
    <td id='TD24' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY24"/></td>
    <td id='TD25' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY25"/></td>
    <td id='TD26' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY26"/></td>
    <td id='TD27' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY27"/></td>
  </tr>
  <tr>
    <td id='TD28' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY28"/></td>
    <td id='TD29' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY29"/></td>
    <td id='TD30' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY30"/></td>
    <td id='TD31' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY31"/></td>
    <td id='TD32' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY32"/></td>
    <td id='TD33' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY33"/></td>
    <td id='TD34' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY34"/></td>
  </tr>
  <tr>
    <td id='TD35' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY35"/></td>
    <td id='TD36' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY36"/></td>
    <td id='TD37' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY37"/></td>
    <td id='TD38' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY38"/></td>
    <td id='TD39' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY39"/></td>
    <td id='TD40' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY40"/></td>
    <td id='TD41' width="14%" valign="middle" align="center" class="DATEINPUTDay" style="font-size: 12px"><span id="DAY41"/></td>
  </tr>
  <tr>
    <td width="14%" valign="middle" align="center" class="DATEINPUTFooterBackground" style="font-size: 12px; "><a ondblclick="gotoPreviousYear();" onclick="gotoPreviousYear();"><img id='imggotoPreviousYear' border="0" src="smallarrowleft.gif" width="10px" height="16px"></a></td>
    <td width="70%" valign="middle" align="center" colspan="5" class="DATEINPUTFooterBackground" style="font-size: 12px; ">
    	<input id="YEAR" size="5" class='FIELDInputEdit' style='text-align:center' pattern="[0-9]+" maxlength="4" onkeyup="if (event.keyCode==13) gotoYear(this.value);" ></input>
     </td>
    <td width="14%" valign="middle" align="center" class="DATEINPUTFooterBackground" style="font-size: 12px; "><a ondblclick="gotoNextYear();" onclick="gotoNextYear();"><img id='imggotoNextYear' border="0" src="smallarrowright.gif" width="10px" height="16px"></a></td>
  </tr>
</table>
</td></tr>
<tr><td><div style='height:15px;font-size:1px'></div></td></tr>
</table>


<script>
	function checkIfSpecialFebruary(pYear)
	{
		var isLeap = pYear%4 == 0 && (pYear % 100 != 0 || pYear % 400 == 0);
		return isLeap;
	}
	function calculateFirstDayOfYear(pYear)
	{
		var vDate = new Date(pYear,0,1,6,0,0,0);
		var vJSDay = vDate.getDay();
		var vResult = vJSDay - 1;
		if (vResult < 0) vResult = 6;
		return vResult;
	}
	
	function init()
	{
	    if (parent.opener != null)
	    {
		    parent.opener.csciframe.registerStandardDlgPopupPAGE(parent);
		}
	}
	function gotoYear()
	{
		var year = document.getElementById("YEAR").value;
		var vRegEx  = new RegExp("[0-9][0-9][0-9][0-9]");
		var vMatch  = vRegEx.exec(year);
		if (vMatch != null)	m_year = vMatch;
		visualizeCurrentDate();		
	}
	function visualizeCurrentDate()
	{
	    // depennds on "american or non-american" style
		highlightWeekendDays();

		// month
		document.getElementById("MONTH").innerHTML = parent.m_monthNames[m_month-1];
		// year
		document.getElementById("YEAR").value = m_year;
		// days
		var vSpecialFeb = false;
		var vStartDay = 0;

		// find info about year
		vSpecialFeb = checkIfSpecialFebruary(m_year);
		vStartDay = calculateFirstDayOfYear(m_year);

		// First day of week is either sunday or monday
		// if week starts already on sunday: vStartDay must be shifted by one
		if (m_americanStyle == true)
			vStartDay = vStartDay-0+1-0;

		// calculate days for beginning
		for (i=1; i<m_month; i++)
		{
			vStartDay = vStartDay + m_monthLengths[i-1];
			if ((vSpecialFeb == true) && (i == 2))
			{
				vStartDay++;
			}
		}

		// check which week day
		vStartDay = vStartDay%7;
		for (i=0; i<(vStartDay); i++)
			getDaySpan(i).innerHTML = "&nbsp;";
		var dayInMonth = m_monthLengths[m_month-1];
		if (m_month == 2 && vSpecialFeb == true)
			dayInMonth++;
		for (i=0; i<dayInMonth; i++)
		{
			if ( (i+1) != m_day)
				getDaySpan(i+vStartDay).innerHTML = '<a class="links" onclick="setDayAndVisualize('+(i+1)+')">' + (i+1) + '</a>';
			else
				getDaySpan(i+vStartDay).innerHTML = '<a class="links" onclick="setDayAndVisualize('+(i+1)+')"><b>' + (i+1) + '</b></a>';
		}
		for (i=dayInMonth+vStartDay; i<42; i++)
			getDaySpan(i).innerHTML = "&nbsp;";
	}
	function getDaySpan(index)
	{
		if (m_daySpans == null)
		{
			m_daySpans = [];
			m_daySpans[0] = document.getElementById("DAY0");
			m_daySpans[1] = document.getElementById("DAY1");
			m_daySpans[2] = document.getElementById("DAY2");
			m_daySpans[3] = document.getElementById("DAY3");
			m_daySpans[4] = document.getElementById("DAY4");
			m_daySpans[5] = document.getElementById("DAY5");
			m_daySpans[6] = document.getElementById("DAY6");
			m_daySpans[7] = document.getElementById("DAY7");
			m_daySpans[8] = document.getElementById("DAY8");
			m_daySpans[9] = document.getElementById("DAY9");
			m_daySpans[10] = document.getElementById("DAY10");
			m_daySpans[11] = document.getElementById("DAY11");
			m_daySpans[12] = document.getElementById("DAY12");
			m_daySpans[13] = document.getElementById("DAY13");
			m_daySpans[14] = document.getElementById("DAY14");
			m_daySpans[15] = document.getElementById("DAY15");
			m_daySpans[16] = document.getElementById("DAY16");
			m_daySpans[17] = document.getElementById("DAY17");
			m_daySpans[18] = document.getElementById("DAY18");
			m_daySpans[19] = document.getElementById("DAY19");
			m_daySpans[20] = document.getElementById("DAY20");
			m_daySpans[21] = document.getElementById("DAY21");
			m_daySpans[22] = document.getElementById("DAY22");
			m_daySpans[23] = document.getElementById("DAY23");
			m_daySpans[24] = document.getElementById("DAY24");
			m_daySpans[25] = document.getElementById("DAY25");
			m_daySpans[26] = document.getElementById("DAY26");
			m_daySpans[27] = document.getElementById("DAY27");
			m_daySpans[28] = document.getElementById("DAY28");
			m_daySpans[29] = document.getElementById("DAY29");
			m_daySpans[30] = document.getElementById("DAY30");
			m_daySpans[31] = document.getElementById("DAY31");
			m_daySpans[32] = document.getElementById("DAY32");
			m_daySpans[33] = document.getElementById("DAY33");
			m_daySpans[34] = document.getElementById("DAY34");
			m_daySpans[35] = document.getElementById("DAY35");
			m_daySpans[36] = document.getElementById("DAY36");
			m_daySpans[37] = document.getElementById("DAY37");
			m_daySpans[38] = document.getElementById("DAY38");
			m_daySpans[39] = document.getElementById("DAY39");
			m_daySpans[40] = document.getElementById("DAY40");
			m_daySpans[41] = document.getElementById("DAY41");
		}
		return m_daySpans[index];
	}
	function gotoPreviousMonth()
	{
		m_month--;
		if (m_month == 0)
		{
			m_month = 12;
			m_year--;
		}
		visualizeCurrentDate();
	}
	function gotoNextMonth()
	{
		m_month++;
		if (m_month == 13)
		{
			m_month = 1;
			m_year++;
		}
		visualizeCurrentDate();
	}
	function gotoPreviousYear()
	{
		m_year--;
		visualizeCurrentDate();
	}
	function gotoNextYear()
	{
		m_year++;
		visualizeCurrentDate();
	}
	function setDayAndVisualize(day)
	{
		m_day = day;
		visualizeCurrentDate();
		rValue = [];
		rValue[0] = m_year;
		rValue[1] = m_month;
		rValue[2] = m_day;
		if (parent.opener != null) // MOZILLA
		{
			parent.opener.csciframe.transferDatePopupRetValFIELD(rValue);
		}
		else // INTERNET EXPLORER
		{
			window.returnValue = rValue;
		}
		closePopup();
	}
	function closePopup()
	{
	    if (parent.opener != null)
		    parent.opener.csciframe.closeStandardDlgPopupPAGE(); 
		else 
		    parent.close();
	}	
	function highlightWeekendDays()
	{
		// set texts for days
		for (var i=0; i<7; i++)
		{
			var vc = document.getElementById("DN"+i);
			if (m_americanStyle == false)
				vc.innerHTML = parent.m_dayNames[i];
			else
				vc.innerHTML = parent.m_dayNames[(i+6)%7];
		}
		// highlight
		for (var i=0; i<42; i++)
		{
		    var td = document.getElementById("TD"+i);
		    if (m_americanStyle == false && i%7 == 5)
		    	td.className = "DATEINPUTSaturday";
		    if (m_americanStyle == false && i%7 == 6)
		    	td.className = "DATEINPUTSunday";
		    if (m_americanStyle == true && i%7 == 0)
		    	td.className = "DATEINPUTSunday";
		    if (m_americanStyle == true && i%7 == 6)
		    	td.className = "DATEINPUTSaturday";
		}
	}
	function setYear(value) { m_year = value; }
	function setMonth(value) { m_month = value; }
	function setDay(value) { m_day = value; }
	function setAmericanStyle(value) { m_americanStyle = value; }
	visualizeCurrentDate();
	focus();
</script>
</body>

</html>
